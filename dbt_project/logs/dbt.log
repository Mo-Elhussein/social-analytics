[0m14:16:45.540380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a82df4d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a82df40d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a82df4290>]}


============================== 14:16:45.552687 | 9879a4ba-1b9f-4f5a-8c6d-968c060343ce ==============================
[0m14:16:45.552687 [info ] [MainThread]: Running with dbt=1.10.9
[0m14:16:45.554766 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'debug': 'False', 'quiet': 'False', 'log_cache_events': 'False', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'profiles_dir': '/app', 'printer_width': '80', 'cache_selected_only': 'False', 'version_check': 'True', 'use_experimental_parser': 'False', 'write_json': 'True', 'no_print': 'None', 'introspect': 'True', 'log_format': 'default', 'warn_error': 'None', 'invocation_command': 'dbt debug', 'partial_parse': 'True', 'use_colors': 'True', 'static_parser': 'True', 'empty': 'None', 'fail_fast': 'False', 'log_path': 'logs', 'target_path': 'None'}
[0m14:16:45.587432 [info ] [MainThread]: dbt version: 1.10.9
[0m14:16:45.588976 [info ] [MainThread]: python version: 3.11.13
[0m14:16:45.590662 [info ] [MainThread]: python path: /usr/local/bin/python3.11
[0m14:16:45.591912 [info ] [MainThread]: os info: Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.41
[0m14:16:45.726768 [info ] [MainThread]: Using profiles dir at /app
[0m14:16:45.728632 [info ] [MainThread]: Using profiles.yml file at /app/profiles.yml
[0m14:16:45.729949 [info ] [MainThread]: Using dbt_project.yml file at /app/dbt_project/dbt_project.yml
[0m14:16:45.731785 [info ] [MainThread]: adapter type: postgres
[0m14:16:45.732995 [info ] [MainThread]: adapter version: 1.9.0
[0m14:16:45.734834 [info ] [MainThread]: Configuration:
[0m14:16:45.736513 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m14:16:45.737972 [info ] [MainThread]:   dbt_project.yml file [[31mERROR not found[0m]
[0m14:16:45.740090 [info ] [MainThread]: Required dependencies:
[0m14:16:45.742100 [debug] [MainThread]: Executing "git --help"
[0m14:16:45.747098 [info ] [MainThread]:  - git [[31mERROR[0m]

[0m14:16:45.748705 [info ] [MainThread]: Connection:
[0m14:16:45.750312 [info ] [MainThread]:   host: postgres
[0m14:16:45.751777 [info ] [MainThread]:   port: 5432
[0m14:16:45.753401 [info ] [MainThread]:   user: postgres
[0m14:16:45.755082 [info ] [MainThread]:   database: social_analytics
[0m14:16:45.756619 [info ] [MainThread]:   schema: analytics
[0m14:16:45.757914 [info ] [MainThread]:   connect_timeout: 10
[0m14:16:45.759550 [info ] [MainThread]:   role: None
[0m14:16:45.761132 [info ] [MainThread]:   search_path: None
[0m14:16:45.762769 [info ] [MainThread]:   keepalives_idle: 0
[0m14:16:45.764676 [info ] [MainThread]:   sslmode: None
[0m14:16:45.770073 [info ] [MainThread]:   sslcert: None
[0m14:16:45.773198 [info ] [MainThread]:   sslkey: None
[0m14:16:45.775263 [info ] [MainThread]:   sslrootcert: None
[0m14:16:45.777512 [info ] [MainThread]:   application_name: dbt
[0m14:16:45.779170 [info ] [MainThread]:   retries: 1
[0m14:16:45.782892 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:16:45.887147 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m14:16:45.975387 [debug] [MainThread]: Using postgres connection "debug"
[0m14:16:45.977026 [debug] [MainThread]: On debug: select 1 as id
[0m14:16:45.978300 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:16:46.043229 [debug] [MainThread]: SQL status: SELECT 1 in 0.065 seconds
[0m14:16:46.045923 [debug] [MainThread]: On debug: Close
[0m14:16:46.047402 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m14:16:46.049105 [info ] [MainThread]: [31m2 checks failed:[0m
[0m14:16:46.050713 [info ] [MainThread]: Project loading failed for the following reason:
 project path </app/dbt_project/dbt_project.yml> not found

[0m14:16:46.052642 [info ] [MainThread]: Error from git --help: Could not find command, ensure it is in the user's PATH: "git"

[0m14:16:46.055724 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.629218, "process_in_blocks": "79704", "process_kernel_time": 1.890282, "process_mem_max_rss": "114276", "process_out_blocks": "8", "process_user_time": 2.218595}
[0m14:16:46.057880 [debug] [MainThread]: Command `dbt debug` failed at 14:16:46.057643 after 0.63 seconds
[0m14:16:46.059858 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m14:16:46.061363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a82dcab90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a82ded5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a82102010>]}
[0m14:16:46.062670 [debug] [MainThread]: Flushing usage events
[0m14:16:47.081556 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:20:59.013816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a54a7bad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a54a7b5d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a54a7ac10>]}


============================== 14:20:59.021421 | 819d4c84-2a33-448c-b35d-c16903065eb7 ==============================
[0m14:20:59.021421 [info ] [MainThread]: Running with dbt=1.10.9
[0m14:20:59.023607 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'log_cache_events': 'False', 'debug': 'False', 'use_colors': 'True', 'no_print': 'None', 'partial_parse': 'True', 'invocation_command': 'dbt debug', 'log_path': '/app/dbt_project/logs', 'write_json': 'True', 'quiet': 'False', 'cache_selected_only': 'False', 'version_check': 'True', 'static_parser': 'True', 'profiles_dir': '/app', 'introspect': 'True', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'use_experimental_parser': 'False', 'empty': 'None', 'indirect_selection': 'eager', 'printer_width': '80'}
[0m14:20:59.049717 [info ] [MainThread]: dbt version: 1.10.9
[0m14:20:59.051167 [info ] [MainThread]: python version: 3.11.13
[0m14:20:59.052755 [info ] [MainThread]: python path: /usr/local/bin/python3.11
[0m14:20:59.054179 [info ] [MainThread]: os info: Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.41
[0m14:20:59.156810 [info ] [MainThread]: Using profiles dir at /app
[0m14:20:59.158447 [info ] [MainThread]: Using profiles.yml file at /app/profiles.yml
[0m14:20:59.159753 [info ] [MainThread]: Using dbt_project.yml file at /app/dbt_project/dbt_project.yml
[0m14:20:59.161650 [info ] [MainThread]: adapter type: postgres
[0m14:20:59.162874 [info ] [MainThread]: adapter version: 1.9.0
[0m14:20:59.272337 [info ] [MainThread]: Configuration:
[0m14:20:59.274239 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m14:20:59.275705 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m14:20:59.277057 [info ] [MainThread]: Required dependencies:
[0m14:20:59.278445 [debug] [MainThread]: Executing "git --help"
[0m14:20:59.280603 [info ] [MainThread]:  - git [[31mERROR[0m]

[0m14:20:59.281905 [info ] [MainThread]: Connection:
[0m14:20:59.283345 [info ] [MainThread]:   host: postgres
[0m14:20:59.285304 [info ] [MainThread]:   port: 5432
[0m14:20:59.286935 [info ] [MainThread]:   user: postgres
[0m14:20:59.288423 [info ] [MainThread]:   database: social_analytics
[0m14:20:59.289900 [info ] [MainThread]:   schema: analytics
[0m14:20:59.291728 [info ] [MainThread]:   connect_timeout: 10
[0m14:20:59.293390 [info ] [MainThread]:   role: None
[0m14:20:59.294625 [info ] [MainThread]:   search_path: None
[0m14:20:59.295993 [info ] [MainThread]:   keepalives_idle: 0
[0m14:20:59.297210 [info ] [MainThread]:   sslmode: None
[0m14:20:59.298310 [info ] [MainThread]:   sslcert: None
[0m14:20:59.299654 [info ] [MainThread]:   sslkey: None
[0m14:20:59.301095 [info ] [MainThread]:   sslrootcert: None
[0m14:20:59.303051 [info ] [MainThread]:   application_name: dbt
[0m14:20:59.304832 [info ] [MainThread]:   retries: 1
[0m14:20:59.306348 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:20:59.384731 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m14:20:59.437772 [debug] [MainThread]: Using postgres connection "debug"
[0m14:20:59.439309 [debug] [MainThread]: On debug: select 1 as id
[0m14:20:59.440541 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:20:59.468665 [debug] [MainThread]: SQL status: SELECT 1 in 0.028 seconds
[0m14:20:59.470979 [debug] [MainThread]: On debug: Close
[0m14:20:59.472413 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m14:20:59.473704 [info ] [MainThread]: [31m1 check failed:[0m
[0m14:20:59.475319 [info ] [MainThread]: Error from git --help: Could not find command, ensure it is in the user's PATH: "git"

[0m14:20:59.477863 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.5591502, "process_in_blocks": "92616", "process_kernel_time": 0.724179, "process_mem_max_rss": "115492", "process_out_blocks": "8", "process_user_time": 2.122246}
[0m14:20:59.479332 [debug] [MainThread]: Command `dbt debug` failed at 14:20:59.479204 after 0.56 seconds
[0m14:20:59.480458 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m14:20:59.481679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a54ad6190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a54ad7f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7a53d82010>]}
[0m14:20:59.482909 [debug] [MainThread]: Flushing usage events
[0m14:21:00.520180 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:21:14.821666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2eae42990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2eae42910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2eafddf10>]}


============================== 14:21:14.827317 | 4726ea48-1ed5-4a74-bf5d-10a8a662fc3a ==============================
[0m14:21:14.827317 [info ] [MainThread]: Running with dbt=1.10.9
[0m14:21:14.829025 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'fail_fast': 'False', 'warn_error': 'None', 'debug': 'False', 'partial_parse': 'True', 'profiles_dir': '/app', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_experimental_parser': 'False', 'invocation_command': 'dbt debug', 'target_path': 'None', 'log_path': '/app/dbt_project/logs', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'introspect': 'True', 'version_check': 'True', 'static_parser': 'True', 'cache_selected_only': 'False', 'quiet': 'False', 'printer_width': '80', 'write_json': 'True', 'empty': 'None', 'no_print': 'None'}
[0m14:21:14.841426 [info ] [MainThread]: dbt version: 1.10.9
[0m14:21:14.843239 [info ] [MainThread]: python version: 3.11.13
[0m14:21:14.844436 [info ] [MainThread]: python path: /usr/local/bin/python3.11
[0m14:21:14.845529 [info ] [MainThread]: os info: Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.41
[0m14:21:14.900314 [info ] [MainThread]: Using profiles dir at /app
[0m14:21:14.902025 [info ] [MainThread]: Using profiles.yml file at /app/profiles.yml
[0m14:21:14.903586 [info ] [MainThread]: Using dbt_project.yml file at /app/dbt_project/dbt_project.yml
[0m14:21:14.904883 [info ] [MainThread]: adapter type: postgres
[0m14:21:14.905992 [info ] [MainThread]: adapter version: 1.9.0
[0m14:21:15.006532 [info ] [MainThread]: Configuration:
[0m14:21:15.008484 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m14:21:15.009960 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m14:21:15.011204 [info ] [MainThread]: Required dependencies:
[0m14:21:15.012259 [debug] [MainThread]: Executing "git --help"
[0m14:21:15.014179 [info ] [MainThread]:  - git [[31mERROR[0m]

[0m14:21:15.015558 [info ] [MainThread]: Connection:
[0m14:21:15.016860 [info ] [MainThread]:   host: postgres
[0m14:21:15.018284 [info ] [MainThread]:   port: 5432
[0m14:21:15.019610 [info ] [MainThread]:   user: postgres
[0m14:21:15.020724 [info ] [MainThread]:   database: social_analytics
[0m14:21:15.022094 [info ] [MainThread]:   schema: analytics
[0m14:21:15.023309 [info ] [MainThread]:   connect_timeout: 10
[0m14:21:15.024439 [info ] [MainThread]:   role: None
[0m14:21:15.025536 [info ] [MainThread]:   search_path: None
[0m14:21:15.026841 [info ] [MainThread]:   keepalives_idle: 0
[0m14:21:15.028490 [info ] [MainThread]:   sslmode: None
[0m14:21:15.029763 [info ] [MainThread]:   sslcert: None
[0m14:21:15.030890 [info ] [MainThread]:   sslkey: None
[0m14:21:15.031894 [info ] [MainThread]:   sslrootcert: None
[0m14:21:15.033017 [info ] [MainThread]:   application_name: dbt
[0m14:21:15.034042 [info ] [MainThread]:   retries: 1
[0m14:21:15.035277 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:21:15.100654 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m14:21:15.141657 [debug] [MainThread]: Using postgres connection "debug"
[0m14:21:15.143297 [debug] [MainThread]: On debug: select 1 as id
[0m14:21:15.144683 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:21:15.154654 [debug] [MainThread]: SQL status: SELECT 1 in 0.010 seconds
[0m14:21:15.156963 [debug] [MainThread]: On debug: Close
[0m14:21:15.158350 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m14:21:15.160024 [info ] [MainThread]: [31m1 check failed:[0m
[0m14:21:15.161640 [info ] [MainThread]: Error from git --help: Could not find command, ensure it is in the user's PATH: "git"

[0m14:21:15.163673 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.40310013, "process_in_blocks": "0", "process_kernel_time": 0.301948, "process_mem_max_rss": "116024", "process_out_blocks": "8", "process_user_time": 1.841884}
[0m14:21:15.165131 [debug] [MainThread]: Command `dbt debug` failed at 14:21:15.164992 after 0.40 seconds
[0m14:21:15.166364 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m14:21:15.167425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2eae65490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2ea189250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2e9128850>]}
[0m14:21:15.168541 [debug] [MainThread]: Flushing usage events
[0m14:21:15.982997 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:21:36.310830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a86214490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a8616c050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a86639e90>]}


============================== 14:21:36.316858 | efe8470c-48c7-4c67-be81-cb52673907a4 ==============================
[0m14:21:36.316858 [info ] [MainThread]: Running with dbt=1.10.9
[0m14:21:36.318361 [debug] [MainThread]: running dbt with arguments {'version_check': 'True', 'fail_fast': 'False', 'static_parser': 'True', 'use_colors': 'True', 'partial_parse': 'True', 'quiet': 'False', 'printer_width': '80', 'profiles_dir': '/app', 'log_format': 'default', 'warn_error': 'None', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'log_path': '/app/dbt_project/logs', 'debug': 'False', 'use_experimental_parser': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'empty': 'False', 'introspect': 'True', 'log_cache_events': 'False', 'invocation_command': 'dbt run', 'no_print': 'None', 'write_json': 'True'}
[0m14:21:36.488003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'efe8470c-48c7-4c67-be81-cb52673907a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a855bfc10>]}
[0m14:21:36.546559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'efe8470c-48c7-4c67-be81-cb52673907a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a88d38c50>]}
[0m14:21:36.548404 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:21:36.629172 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m14:21:36.632678 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:21:36.634138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'efe8470c-48c7-4c67-be81-cb52673907a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a861bebd0>]}
[0m14:21:37.649129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'efe8470c-48c7-4c67-be81-cb52673907a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a871665d0>]}
[0m14:21:37.721289 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt_project/target/manifest.json
[0m14:21:37.729164 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt_project/target/semantic_manifest.json
[0m14:21:37.758098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'efe8470c-48c7-4c67-be81-cb52673907a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a84505b10>]}
[0m14:21:37.759599 [info ] [MainThread]: Found 1 model, 434 macros
[0m14:21:37.761165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'efe8470c-48c7-4c67-be81-cb52673907a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a84521a10>]}
[0m14:21:37.763785 [info ] [MainThread]: 
[0m14:21:37.765456 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:21:37.767004 [info ] [MainThread]: 
[0m14:21:37.769137 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:21:37.771700 [debug] [ThreadPool]: Acquiring new postgres connection 'list_social_analytics'
[0m14:21:37.823521 [debug] [ThreadPool]: Using postgres connection "list_social_analytics"
[0m14:21:37.824809 [debug] [ThreadPool]: On list_social_analytics: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "connection_name": "list_social_analytics"} */

    select distinct nspname from pg_namespace
  
[0m14:21:37.825771 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:21:37.842999 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.017 seconds
[0m14:21:37.845099 [debug] [ThreadPool]: On list_social_analytics: Close
[0m14:21:37.847405 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_social_analytics, now list_social_analytics_analytics)
[0m14:21:37.854176 [debug] [ThreadPool]: Using postgres connection "list_social_analytics_analytics"
[0m14:21:37.855328 [debug] [ThreadPool]: On list_social_analytics_analytics: BEGIN
[0m14:21:37.856264 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:21:37.865043 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m14:21:37.866552 [debug] [ThreadPool]: Using postgres connection "list_social_analytics_analytics"
[0m14:21:37.867716 [debug] [ThreadPool]: On list_social_analytics_analytics: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "connection_name": "list_social_analytics_analytics"} */
select
      'social_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'social_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'social_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m14:21:37.882186 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.013 seconds
[0m14:21:37.884192 [debug] [ThreadPool]: On list_social_analytics_analytics: ROLLBACK
[0m14:21:37.885346 [debug] [ThreadPool]: On list_social_analytics_analytics: Close
[0m14:21:37.890722 [debug] [MainThread]: Using postgres connection "master"
[0m14:21:37.891822 [debug] [MainThread]: On master: BEGIN
[0m14:21:37.892849 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:21:37.899424 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m14:21:37.900589 [debug] [MainThread]: Using postgres connection "master"
[0m14:21:37.901583 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:21:37.912894 [debug] [MainThread]: SQL status: SELECT 0 in 0.010 seconds
[0m14:21:37.914941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'efe8470c-48c7-4c67-be81-cb52673907a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a81c4de10>]}
[0m14:21:37.916142 [debug] [MainThread]: On master: ROLLBACK
[0m14:21:37.917303 [debug] [MainThread]: Using postgres connection "master"
[0m14:21:37.918173 [debug] [MainThread]: On master: BEGIN
[0m14:21:37.919317 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:21:37.920357 [debug] [MainThread]: On master: COMMIT
[0m14:21:37.921374 [debug] [MainThread]: Using postgres connection "master"
[0m14:21:37.922220 [debug] [MainThread]: On master: COMMIT
[0m14:21:37.923185 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:21:37.924002 [debug] [MainThread]: On master: Close
[0m14:21:37.929662 [debug] [Thread-1 (]: Began running node model.social_analytics.stg_posts
[0m14:21:37.930927 [info ] [Thread-1 (]: 1 of 1 START sql view model analytics.stg_posts ................................ [RUN]
[0m14:21:37.932317 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_social_analytics_analytics, now model.social_analytics.stg_posts)
[0m14:21:37.933404 [debug] [Thread-1 (]: Began compiling node model.social_analytics.stg_posts
[0m14:21:37.941343 [debug] [Thread-1 (]: Writing injected SQL for node "model.social_analytics.stg_posts"
[0m14:21:37.956463 [debug] [Thread-1 (]: Began executing node model.social_analytics.stg_posts
[0m14:21:37.994029 [debug] [Thread-1 (]: Writing runtime sql for node "model.social_analytics.stg_posts"
[0m14:21:38.010696 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.stg_posts"
[0m14:21:38.012025 [debug] [Thread-1 (]: On model.social_analytics.stg_posts: BEGIN
[0m14:21:38.013113 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:21:38.020796 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m14:21:38.022643 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.stg_posts"
[0m14:21:38.023719 [debug] [Thread-1 (]: On model.social_analytics.stg_posts: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.stg_posts"} */

  create view "social_analytics"."analytics"."stg_posts__dbt_tmp"
    
    
  as (
    

SELECT
    id,
    platform,
    author_name,
    content_text,
    like_count,
    comment_count,
    share_count,
    engagement_score,
    posted_at_utc,
    collected_at_utc
FROM public.posts;
  );
[0m14:21:38.026164 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 20: FROM public.posts;
                          ^

[0m14:21:38.027289 [debug] [Thread-1 (]: On model.social_analytics.stg_posts: ROLLBACK
[0m14:21:38.028707 [debug] [Thread-1 (]: On model.social_analytics.stg_posts: Close
[0m14:21:38.037379 [debug] [Thread-1 (]: Database Error in model stg_posts (models/stg_posts.sql)
  syntax error at or near ";"
  LINE 20: FROM public.posts;
                            ^
  compiled code at target/run/social_analytics/models/stg_posts.sql
[0m14:21:38.040347 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'efe8470c-48c7-4c67-be81-cb52673907a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a855824d0>]}
[0m14:21:38.041855 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model analytics.stg_posts ....................... [[31mERROR[0m in 0.11s]
[0m14:21:38.043392 [debug] [Thread-1 (]: Finished running node model.social_analytics.stg_posts
[0m14:21:38.044619 [debug] [Thread-4 (]: Marking all children of 'model.social_analytics.stg_posts' to be skipped because of status 'error'.  Reason: Database Error in model stg_posts (models/stg_posts.sql)
  syntax error at or near ";"
  LINE 20: FROM public.posts;
                            ^
  compiled code at target/run/social_analytics/models/stg_posts.sql.
[0m14:21:38.047349 [debug] [MainThread]: Using postgres connection "master"
[0m14:21:38.048410 [debug] [MainThread]: On master: BEGIN
[0m14:21:38.049389 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:21:38.057043 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m14:21:38.058753 [debug] [MainThread]: On master: COMMIT
[0m14:21:38.059999 [debug] [MainThread]: Using postgres connection "master"
[0m14:21:38.060871 [debug] [MainThread]: On master: COMMIT
[0m14:21:38.061915 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:21:38.062839 [debug] [MainThread]: On master: Close
[0m14:21:38.063846 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:21:38.064814 [debug] [MainThread]: Connection 'model.social_analytics.stg_posts' was properly closed.
[0m14:21:38.065823 [info ] [MainThread]: 
[0m14:21:38.066973 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.30 seconds (0.30s).
[0m14:21:38.068523 [debug] [MainThread]: Command end result
[0m14:21:38.103969 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt_project/target/manifest.json
[0m14:21:38.110908 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt_project/target/semantic_manifest.json
[0m14:21:38.122306 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt_project/target/run_results.json
[0m14:21:38.123598 [info ] [MainThread]: 
[0m14:21:38.124960 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:21:38.126299 [info ] [MainThread]: 
[0m14:21:38.127441 [error] [MainThread]: [31mFailure in model stg_posts (models/stg_posts.sql)[0m
[0m14:21:38.128570 [error] [MainThread]:   Database Error in model stg_posts (models/stg_posts.sql)
  syntax error at or near ";"
  LINE 20: FROM public.posts;
                            ^
  compiled code at target/run/social_analytics/models/stg_posts.sql
[0m14:21:38.129748 [info ] [MainThread]: 
[0m14:21:38.131024 [info ] [MainThread]:   compiled code at target/compiled/social_analytics/models/stg_posts.sql
[0m14:21:38.132285 [info ] [MainThread]: 
[0m14:21:38.133730 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m14:21:38.135974 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.887906, "process_in_blocks": "3328", "process_kernel_time": 0.361915, "process_mem_max_rss": "126864", "process_out_blocks": "8", "process_user_time": 3.076285}
[0m14:21:38.137538 [debug] [MainThread]: Command `dbt run` failed at 14:21:38.137318 after 1.89 seconds
[0m14:21:38.139232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a86216b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a8620d410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9a87215410>]}
[0m14:21:38.140725 [debug] [MainThread]: Flushing usage events
[0m14:21:39.023021 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:22:30.700690 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b08117b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b08a03790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b08114790>]}


============================== 14:22:30.708446 | 644d9f9a-4122-461d-ab8b-d0d971b8ab60 ==============================
[0m14:22:30.708446 [info ] [MainThread]: Running with dbt=1.10.9
[0m14:22:30.710588 [debug] [MainThread]: running dbt with arguments {'introspect': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'log_path': '/app/dbt_project/logs', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'cache_selected_only': 'False', 'empty': 'False', 'log_format': 'default', 'quiet': 'False', 'fail_fast': 'False', 'printer_width': '80', 'log_cache_events': 'False', 'use_colors': 'True', 'version_check': 'True', 'indirect_selection': 'eager', 'write_json': 'True', 'debug': 'False', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': '/app', 'partial_parse': 'True', 'warn_error': 'None'}
[0m14:22:30.931654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '644d9f9a-4122-461d-ab8b-d0d971b8ab60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b080b1950>]}
[0m14:22:30.994638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '644d9f9a-4122-461d-ab8b-d0d971b8ab60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b0ac2d750>]}
[0m14:22:31.011626 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:22:31.094840 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m14:22:31.253858 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:22:31.255441 [debug] [MainThread]: Partial parsing: updated file: social_analytics://models/stg_posts.sql
[0m14:22:31.512704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '644d9f9a-4122-461d-ab8b-d0d971b8ab60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b077d1890>]}
[0m14:22:31.592523 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt_project/target/manifest.json
[0m14:22:31.618565 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt_project/target/semantic_manifest.json
[0m14:22:31.671396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '644d9f9a-4122-461d-ab8b-d0d971b8ab60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b06fec550>]}
[0m14:22:31.675167 [info ] [MainThread]: Found 1 model, 434 macros
[0m14:22:31.678567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '644d9f9a-4122-461d-ab8b-d0d971b8ab60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b0631fe10>]}
[0m14:22:31.684905 [info ] [MainThread]: 
[0m14:22:31.688448 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:22:31.690312 [info ] [MainThread]: 
[0m14:22:31.695557 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:22:31.702535 [debug] [ThreadPool]: Acquiring new postgres connection 'list_social_analytics'
[0m14:22:31.872427 [debug] [ThreadPool]: Using postgres connection "list_social_analytics"
[0m14:22:31.873859 [debug] [ThreadPool]: On list_social_analytics: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "connection_name": "list_social_analytics"} */

    select distinct nspname from pg_namespace
  
[0m14:22:31.875179 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:22:31.898859 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.024 seconds
[0m14:22:31.901955 [debug] [ThreadPool]: On list_social_analytics: Close
[0m14:22:31.904367 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_social_analytics, now list_social_analytics_analytics)
[0m14:22:31.911902 [debug] [ThreadPool]: Using postgres connection "list_social_analytics_analytics"
[0m14:22:31.913375 [debug] [ThreadPool]: On list_social_analytics_analytics: BEGIN
[0m14:22:31.914791 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:22:31.921837 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m14:22:31.923400 [debug] [ThreadPool]: Using postgres connection "list_social_analytics_analytics"
[0m14:22:31.924607 [debug] [ThreadPool]: On list_social_analytics_analytics: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "connection_name": "list_social_analytics_analytics"} */
select
      'social_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'social_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'social_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m14:22:31.930079 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.004 seconds
[0m14:22:31.932548 [debug] [ThreadPool]: On list_social_analytics_analytics: ROLLBACK
[0m14:22:31.933950 [debug] [ThreadPool]: On list_social_analytics_analytics: Close
[0m14:22:31.940188 [debug] [MainThread]: Using postgres connection "master"
[0m14:22:31.941658 [debug] [MainThread]: On master: BEGIN
[0m14:22:31.942828 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:22:31.950288 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m14:22:31.951504 [debug] [MainThread]: Using postgres connection "master"
[0m14:22:31.952635 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:22:31.958624 [debug] [MainThread]: SQL status: SELECT 0 in 0.005 seconds
[0m14:22:31.960822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '644d9f9a-4122-461d-ab8b-d0d971b8ab60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b07fc9b50>]}
[0m14:22:31.962361 [debug] [MainThread]: On master: ROLLBACK
[0m14:22:31.963845 [debug] [MainThread]: Using postgres connection "master"
[0m14:22:31.964805 [debug] [MainThread]: On master: BEGIN
[0m14:22:31.966425 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:22:31.967630 [debug] [MainThread]: On master: COMMIT
[0m14:22:31.968554 [debug] [MainThread]: Using postgres connection "master"
[0m14:22:31.969767 [debug] [MainThread]: On master: COMMIT
[0m14:22:31.970972 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:22:31.971920 [debug] [MainThread]: On master: Close
[0m14:22:31.977581 [debug] [Thread-1 (]: Began running node model.social_analytics.stg_posts
[0m14:22:31.979638 [info ] [Thread-1 (]: 1 of 1 START sql view model analytics.stg_posts ................................ [RUN]
[0m14:22:31.981428 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_social_analytics_analytics, now model.social_analytics.stg_posts)
[0m14:22:31.982787 [debug] [Thread-1 (]: Began compiling node model.social_analytics.stg_posts
[0m14:22:31.991685 [debug] [Thread-1 (]: Writing injected SQL for node "model.social_analytics.stg_posts"
[0m14:22:32.000412 [debug] [Thread-1 (]: Began executing node model.social_analytics.stg_posts
[0m14:22:32.040831 [debug] [Thread-1 (]: Writing runtime sql for node "model.social_analytics.stg_posts"
[0m14:22:32.048708 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.stg_posts"
[0m14:22:32.050264 [debug] [Thread-1 (]: On model.social_analytics.stg_posts: BEGIN
[0m14:22:32.051686 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:22:32.059397 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m14:22:32.060966 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.stg_posts"
[0m14:22:32.061941 [debug] [Thread-1 (]: On model.social_analytics.stg_posts: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.stg_posts"} */

  create view "social_analytics"."analytics"."stg_posts__dbt_tmp"
    
    
  as (
    

SELECT
    id,
    platform,
    author_name,
    content_text,
    like_count,
    comment_count,
    share_count,
    engagement_score,
    posted_at_utc,
    collected_at_utc
FROM public.posts
  );
[0m14:22:32.080196 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.017 seconds
[0m14:22:32.087438 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.stg_posts"
[0m14:22:32.088686 [debug] [Thread-1 (]: On model.social_analytics.stg_posts: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.stg_posts"} */
alter table "social_analytics"."analytics"."stg_posts__dbt_tmp" rename to "stg_posts"
[0m14:22:32.090727 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:22:32.105811 [debug] [Thread-1 (]: On model.social_analytics.stg_posts: COMMIT
[0m14:22:32.107160 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.stg_posts"
[0m14:22:32.108551 [debug] [Thread-1 (]: On model.social_analytics.stg_posts: COMMIT
[0m14:22:32.112030 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m14:22:32.119167 [debug] [Thread-1 (]: Applying DROP to: "social_analytics"."analytics"."stg_posts__dbt_backup"
[0m14:22:32.125449 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.stg_posts"
[0m14:22:32.126907 [debug] [Thread-1 (]: On model.social_analytics.stg_posts: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.stg_posts"} */
drop view if exists "social_analytics"."analytics"."stg_posts__dbt_backup" cascade
[0m14:22:32.129477 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m14:22:32.133080 [debug] [Thread-1 (]: On model.social_analytics.stg_posts: Close
[0m14:22:32.136649 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '644d9f9a-4122-461d-ab8b-d0d971b8ab60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b06f2bcd0>]}
[0m14:22:32.138541 [info ] [Thread-1 (]: 1 of 1 OK created sql view model analytics.stg_posts ........................... [[32mCREATE VIEW[0m in 0.15s]
[0m14:22:32.140325 [debug] [Thread-1 (]: Finished running node model.social_analytics.stg_posts
[0m14:22:32.143294 [debug] [MainThread]: Using postgres connection "master"
[0m14:22:32.144766 [debug] [MainThread]: On master: BEGIN
[0m14:22:32.145951 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:22:32.152681 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m14:22:32.155006 [debug] [MainThread]: On master: COMMIT
[0m14:22:32.157194 [debug] [MainThread]: Using postgres connection "master"
[0m14:22:32.159112 [debug] [MainThread]: On master: COMMIT
[0m14:22:32.165827 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:22:32.168446 [debug] [MainThread]: On master: Close
[0m14:22:32.170649 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:22:32.172901 [debug] [MainThread]: Connection 'model.social_analytics.stg_posts' was properly closed.
[0m14:22:32.175022 [info ] [MainThread]: 
[0m14:22:32.177648 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.48 seconds (0.48s).
[0m14:22:32.182141 [debug] [MainThread]: Command end result
[0m14:22:32.241290 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt_project/target/manifest.json
[0m14:22:32.249086 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt_project/target/semantic_manifest.json
[0m14:22:32.261457 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt_project/target/run_results.json
[0m14:22:32.263046 [info ] [MainThread]: 
[0m14:22:32.264883 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:22:32.266383 [info ] [MainThread]: 
[0m14:22:32.268300 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=1
[0m14:22:32.271929 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.6455982, "process_in_blocks": "95712", "process_kernel_time": 0.509516, "process_mem_max_rss": "127508", "process_out_blocks": "8", "process_user_time": 3.046907}
[0m14:22:32.274010 [debug] [MainThread]: Command `dbt run` succeeded at 14:22:32.273790 after 1.65 seconds
[0m14:22:32.276180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b080b0a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b080b1610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7b0c82fb50>]}
[0m14:22:32.278568 [debug] [MainThread]: Flushing usage events
[0m14:22:33.704055 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:24:30.366696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5e315f210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5e30fca90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5e31bbe90>]}


============================== 14:24:30.378357 | d8dcd900-02e8-4056-8455-b3428dec04e7 ==============================
[0m14:24:30.378357 [info ] [MainThread]: Running with dbt=1.10.9
[0m14:24:30.380418 [debug] [MainThread]: running dbt with arguments {'log_path': '/app/dbt_project/logs', 'static_parser': 'True', 'target_path': 'None', 'no_print': 'None', 'indirect_selection': 'eager', 'fail_fast': 'False', 'partial_parse': 'True', 'introspect': 'True', 'empty': 'False', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'invocation_command': 'dbt run', 'version_check': 'True', 'printer_width': '80', 'log_format': 'default', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'write_json': 'True', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'profiles_dir': '/app', 'send_anonymous_usage_stats': 'True'}
[0m14:24:30.595140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd8dcd900-02e8-4056-8455-b3428dec04e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5e31b8610>]}
[0m14:24:30.653919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd8dcd900-02e8-4056-8455-b3428dec04e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5e5cccbd0>]}
[0m14:24:30.657379 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:24:30.751694 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m14:24:30.913059 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m14:24:30.914456 [debug] [MainThread]: Partial parsing: added file: social_analytics://models/fct_daily_metrics.sql
[0m14:24:31.152596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd8dcd900-02e8-4056-8455-b3428dec04e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5e31a44d0>]}
[0m14:24:31.226033 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt_project/target/manifest.json
[0m14:24:31.234503 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt_project/target/semantic_manifest.json
[0m14:24:31.269282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd8dcd900-02e8-4056-8455-b3428dec04e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5e17d1450>]}
[0m14:24:31.270790 [info ] [MainThread]: Found 2 models, 434 macros
[0m14:24:31.272230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd8dcd900-02e8-4056-8455-b3428dec04e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5e31b8bd0>]}
[0m14:24:31.275680 [info ] [MainThread]: 
[0m14:24:31.277193 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:24:31.278502 [info ] [MainThread]: 
[0m14:24:31.280490 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:24:31.286608 [debug] [ThreadPool]: Acquiring new postgres connection 'list_social_analytics'
[0m14:24:31.436577 [debug] [ThreadPool]: Using postgres connection "list_social_analytics"
[0m14:24:31.437884 [debug] [ThreadPool]: On list_social_analytics: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "connection_name": "list_social_analytics"} */

    select distinct nspname from pg_namespace
  
[0m14:24:31.439045 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:24:31.459330 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.020 seconds
[0m14:24:31.462081 [debug] [ThreadPool]: On list_social_analytics: Close
[0m14:24:31.464699 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_social_analytics, now list_social_analytics_analytics)
[0m14:24:31.471811 [debug] [ThreadPool]: Using postgres connection "list_social_analytics_analytics"
[0m14:24:31.473167 [debug] [ThreadPool]: On list_social_analytics_analytics: BEGIN
[0m14:24:31.474348 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:24:31.482806 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m14:24:31.484403 [debug] [ThreadPool]: Using postgres connection "list_social_analytics_analytics"
[0m14:24:31.485518 [debug] [ThreadPool]: On list_social_analytics_analytics: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "connection_name": "list_social_analytics_analytics"} */
select
      'social_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'social_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'social_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m14:24:31.491252 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.005 seconds
[0m14:24:31.493877 [debug] [ThreadPool]: On list_social_analytics_analytics: ROLLBACK
[0m14:24:31.495257 [debug] [ThreadPool]: On list_social_analytics_analytics: Close
[0m14:24:31.501149 [debug] [MainThread]: Using postgres connection "master"
[0m14:24:31.502629 [debug] [MainThread]: On master: BEGIN
[0m14:24:31.503826 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:24:31.511761 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m14:24:31.513188 [debug] [MainThread]: Using postgres connection "master"
[0m14:24:31.514464 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:24:31.520438 [debug] [MainThread]: SQL status: SELECT 1 in 0.005 seconds
[0m14:24:31.523110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd8dcd900-02e8-4056-8455-b3428dec04e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5e1bb3f90>]}
[0m14:24:31.524390 [debug] [MainThread]: On master: ROLLBACK
[0m14:24:31.525535 [debug] [MainThread]: Using postgres connection "master"
[0m14:24:31.526505 [debug] [MainThread]: On master: BEGIN
[0m14:24:31.527787 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:24:31.528913 [debug] [MainThread]: On master: COMMIT
[0m14:24:31.530141 [debug] [MainThread]: Using postgres connection "master"
[0m14:24:31.531271 [debug] [MainThread]: On master: COMMIT
[0m14:24:31.532545 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:24:31.533610 [debug] [MainThread]: On master: Close
[0m14:24:31.538934 [debug] [Thread-1 (]: Began running node model.social_analytics.stg_posts
[0m14:24:31.540597 [info ] [Thread-1 (]: 1 of 2 START sql view model analytics.stg_posts ................................ [RUN]
[0m14:24:31.542467 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_social_analytics_analytics, now model.social_analytics.stg_posts)
[0m14:24:31.543881 [debug] [Thread-1 (]: Began compiling node model.social_analytics.stg_posts
[0m14:24:31.552893 [debug] [Thread-1 (]: Writing injected SQL for node "model.social_analytics.stg_posts"
[0m14:24:31.563890 [debug] [Thread-1 (]: Began executing node model.social_analytics.stg_posts
[0m14:24:31.600869 [debug] [Thread-1 (]: Writing runtime sql for node "model.social_analytics.stg_posts"
[0m14:24:31.608935 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.stg_posts"
[0m14:24:31.610079 [debug] [Thread-1 (]: On model.social_analytics.stg_posts: BEGIN
[0m14:24:31.611007 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:24:31.618323 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m14:24:31.619492 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.stg_posts"
[0m14:24:31.620496 [debug] [Thread-1 (]: On model.social_analytics.stg_posts: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.stg_posts"} */

  create view "social_analytics"."analytics"."stg_posts__dbt_tmp"
    
    
  as (
    

SELECT
    id,
    platform,
    author_name,
    content_text,
    like_count,
    comment_count,
    share_count,
    engagement_score,
    posted_at_utc,
    collected_at_utc
FROM public.posts
  );
[0m14:24:31.625460 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m14:24:31.632530 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.stg_posts"
[0m14:24:31.633678 [debug] [Thread-1 (]: On model.social_analytics.stg_posts: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.stg_posts"} */
alter table "social_analytics"."analytics"."stg_posts" rename to "stg_posts__dbt_backup"
[0m14:24:31.635942 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:24:31.639835 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.stg_posts"
[0m14:24:31.640863 [debug] [Thread-1 (]: On model.social_analytics.stg_posts: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.stg_posts"} */
alter table "social_analytics"."analytics"."stg_posts__dbt_tmp" rename to "stg_posts"
[0m14:24:31.642430 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:24:31.658173 [debug] [Thread-1 (]: On model.social_analytics.stg_posts: COMMIT
[0m14:24:31.659626 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.stg_posts"
[0m14:24:31.660669 [debug] [Thread-1 (]: On model.social_analytics.stg_posts: COMMIT
[0m14:24:31.663705 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m14:24:31.673329 [debug] [Thread-1 (]: Applying DROP to: "social_analytics"."analytics"."stg_posts__dbt_backup"
[0m14:24:31.679471 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.stg_posts"
[0m14:24:31.680917 [debug] [Thread-1 (]: On model.social_analytics.stg_posts: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.stg_posts"} */
drop view if exists "social_analytics"."analytics"."stg_posts__dbt_backup" cascade
[0m14:24:31.690743 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.009 seconds
[0m14:24:31.695281 [debug] [Thread-1 (]: On model.social_analytics.stg_posts: Close
[0m14:24:31.699568 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd8dcd900-02e8-4056-8455-b3428dec04e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5e0188dd0>]}
[0m14:24:31.701404 [info ] [Thread-1 (]: 1 of 2 OK created sql view model analytics.stg_posts ........................... [[32mCREATE VIEW[0m in 0.16s]
[0m14:24:31.703345 [debug] [Thread-1 (]: Finished running node model.social_analytics.stg_posts
[0m14:24:31.705787 [debug] [Thread-1 (]: Began running node model.social_analytics.fct_daily_metrics
[0m14:24:31.707109 [info ] [Thread-1 (]: 2 of 2 START sql table model analytics.fct_daily_metrics ....................... [RUN]
[0m14:24:31.708599 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.social_analytics.stg_posts, now model.social_analytics.fct_daily_metrics)
[0m14:24:31.710293 [debug] [Thread-1 (]: Began compiling node model.social_analytics.fct_daily_metrics
[0m14:24:31.716519 [debug] [Thread-1 (]: Writing injected SQL for node "model.social_analytics.fct_daily_metrics"
[0m14:24:31.724692 [debug] [Thread-1 (]: Began executing node model.social_analytics.fct_daily_metrics
[0m14:24:31.756401 [debug] [Thread-1 (]: Writing runtime sql for node "model.social_analytics.fct_daily_metrics"
[0m14:24:31.763500 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.fct_daily_metrics"
[0m14:24:31.764545 [debug] [Thread-1 (]: On model.social_analytics.fct_daily_metrics: BEGIN
[0m14:24:31.765558 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:24:31.772557 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m14:24:31.773791 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.fct_daily_metrics"
[0m14:24:31.775006 [debug] [Thread-1 (]: On model.social_analytics.fct_daily_metrics: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.fct_daily_metrics"} */

  
    

  create  table "social_analytics"."analytics"."fct_daily_metrics__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    DATE(posted_at_utc) AS post_date,
    COUNT(*) AS total_posts,
    SUM(like_count) AS total_likes,
    SUM(comment_count) AS total_comments,
    SUM(share_count) AS total_shares,
    SUM(engagement_score) AS total_engagement
FROM "social_analytics"."analytics"."stg_posts"
GROUP BY DATE(posted_at_utc)
ORDER BY post_date DESC
  );
  
[0m14:24:31.792550 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.016 seconds
[0m14:24:31.799739 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.fct_daily_metrics"
[0m14:24:31.801379 [debug] [Thread-1 (]: On model.social_analytics.fct_daily_metrics: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.fct_daily_metrics"} */
alter table "social_analytics"."analytics"."fct_daily_metrics__dbt_tmp" rename to "fct_daily_metrics"
[0m14:24:31.802802 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:24:31.804660 [debug] [Thread-1 (]: On model.social_analytics.fct_daily_metrics: COMMIT
[0m14:24:31.805550 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.fct_daily_metrics"
[0m14:24:31.806364 [debug] [Thread-1 (]: On model.social_analytics.fct_daily_metrics: COMMIT
[0m14:24:31.811320 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m14:24:31.814293 [debug] [Thread-1 (]: Applying DROP to: "social_analytics"."analytics"."fct_daily_metrics__dbt_backup"
[0m14:24:31.817717 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.fct_daily_metrics"
[0m14:24:31.818664 [debug] [Thread-1 (]: On model.social_analytics.fct_daily_metrics: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.fct_daily_metrics"} */
drop table if exists "social_analytics"."analytics"."fct_daily_metrics__dbt_backup" cascade
[0m14:24:31.820294 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m14:24:31.822078 [debug] [Thread-1 (]: On model.social_analytics.fct_daily_metrics: Close
[0m14:24:31.823233 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd8dcd900-02e8-4056-8455-b3428dec04e7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5d29303d0>]}
[0m14:24:31.824382 [info ] [Thread-1 (]: 2 of 2 OK created sql table model analytics.fct_daily_metrics .................. [[32mSELECT 2[0m in 0.11s]
[0m14:24:31.825816 [debug] [Thread-1 (]: Finished running node model.social_analytics.fct_daily_metrics
[0m14:24:31.828113 [debug] [MainThread]: Using postgres connection "master"
[0m14:24:31.829146 [debug] [MainThread]: On master: BEGIN
[0m14:24:31.830071 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:24:31.837858 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m14:24:31.839277 [debug] [MainThread]: On master: COMMIT
[0m14:24:31.840144 [debug] [MainThread]: Using postgres connection "master"
[0m14:24:31.840998 [debug] [MainThread]: On master: COMMIT
[0m14:24:31.842079 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:24:31.843045 [debug] [MainThread]: On master: Close
[0m14:24:31.844090 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:24:31.844919 [debug] [MainThread]: Connection 'model.social_analytics.fct_daily_metrics' was properly closed.
[0m14:24:31.845773 [info ] [MainThread]: 
[0m14:24:31.846915 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 0.57 seconds (0.57s).
[0m14:24:31.848813 [debug] [MainThread]: Command end result
[0m14:24:31.884720 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt_project/target/manifest.json
[0m14:24:31.891608 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt_project/target/semantic_manifest.json
[0m14:24:31.902165 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt_project/target/run_results.json
[0m14:24:31.903442 [info ] [MainThread]: 
[0m14:24:31.904711 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:24:31.906066 [info ] [MainThread]: 
[0m14:24:31.907348 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m14:24:31.910199 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.6281936, "process_in_blocks": "95712", "process_kernel_time": 0.416527, "process_mem_max_rss": "129400", "process_out_blocks": "8", "process_user_time": 2.965282}
[0m14:24:31.911701 [debug] [MainThread]: Command `dbt run` succeeded at 14:24:31.911533 after 1.63 seconds
[0m14:24:31.913026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5e78cfcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5e793d190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb5e793d010>]}
[0m14:24:31.914270 [debug] [MainThread]: Flushing usage events
[0m14:24:32.896536 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:27:13.567894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15d73cc590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15d73d7b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15d81e7050>]}


============================== 14:27:13.575349 | a83a6bc3-b503-4f4f-88bd-b5a94d027f0e ==============================
[0m14:27:13.575349 [info ] [MainThread]: Running with dbt=1.10.9
[0m14:27:13.576867 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'cache_selected_only': 'False', 'invocation_command': 'dbt run', 'log_path': '/app/dbt_project/logs', 'write_json': 'True', 'empty': 'False', 'version_check': 'True', 'no_print': 'None', 'introspect': 'True', 'use_experimental_parser': 'False', 'printer_width': '80', 'warn_error': 'None', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'profiles_dir': '/app', 'target_path': 'None', 'log_cache_events': 'False', 'partial_parse': 'True', 'indirect_selection': 'eager', 'use_colors': 'True', 'log_format': 'default', 'static_parser': 'True', 'fail_fast': 'False'}
[0m14:27:13.767698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a83a6bc3-b503-4f4f-88bd-b5a94d027f0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15d67274d0>]}
[0m14:27:13.824757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a83a6bc3-b503-4f4f-88bd-b5a94d027f0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15d9eecc90>]}
[0m14:27:13.827046 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:27:13.908693 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m14:27:14.084767 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m14:27:14.086165 [debug] [MainThread]: Partial parsing: added file: social_analytics://models/top_posts.sql
[0m14:27:14.319988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a83a6bc3-b503-4f4f-88bd-b5a94d027f0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15d677ee90>]}
[0m14:27:14.393427 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt_project/target/manifest.json
[0m14:27:14.400585 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt_project/target/semantic_manifest.json
[0m14:27:14.438076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a83a6bc3-b503-4f4f-88bd-b5a94d027f0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15d5364c10>]}
[0m14:27:14.439722 [info ] [MainThread]: Found 3 models, 434 macros
[0m14:27:14.441274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a83a6bc3-b503-4f4f-88bd-b5a94d027f0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15d5301bd0>]}
[0m14:27:14.444413 [info ] [MainThread]: 
[0m14:27:14.445985 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:27:14.447345 [info ] [MainThread]: 
[0m14:27:14.449283 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:27:14.456002 [debug] [ThreadPool]: Acquiring new postgres connection 'list_social_analytics'
[0m14:27:14.587909 [debug] [ThreadPool]: Using postgres connection "list_social_analytics"
[0m14:27:14.589523 [debug] [ThreadPool]: On list_social_analytics: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "connection_name": "list_social_analytics"} */

    select distinct nspname from pg_namespace
  
[0m14:27:14.590953 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:27:14.606057 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.015 seconds
[0m14:27:14.608899 [debug] [ThreadPool]: On list_social_analytics: Close
[0m14:27:14.611918 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_social_analytics, now list_social_analytics_analytics)
[0m14:27:14.619867 [debug] [ThreadPool]: Using postgres connection "list_social_analytics_analytics"
[0m14:27:14.621304 [debug] [ThreadPool]: On list_social_analytics_analytics: BEGIN
[0m14:27:14.622364 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:27:14.629970 [debug] [ThreadPool]: SQL status: BEGIN in 0.008 seconds
[0m14:27:14.631681 [debug] [ThreadPool]: Using postgres connection "list_social_analytics_analytics"
[0m14:27:14.632870 [debug] [ThreadPool]: On list_social_analytics_analytics: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "connection_name": "list_social_analytics_analytics"} */
select
      'social_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'social_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'social_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m14:27:14.637312 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.003 seconds
[0m14:27:14.640251 [debug] [ThreadPool]: On list_social_analytics_analytics: ROLLBACK
[0m14:27:14.641977 [debug] [ThreadPool]: On list_social_analytics_analytics: Close
[0m14:27:14.650026 [debug] [MainThread]: Using postgres connection "master"
[0m14:27:14.651490 [debug] [MainThread]: On master: BEGIN
[0m14:27:14.653012 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:27:14.661446 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m14:27:14.663032 [debug] [MainThread]: Using postgres connection "master"
[0m14:27:14.664422 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:27:14.672176 [debug] [MainThread]: SQL status: SELECT 1 in 0.006 seconds
[0m14:27:14.675025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a83a6bc3-b503-4f4f-88bd-b5a94d027f0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15bec66510>]}
[0m14:27:14.676330 [debug] [MainThread]: On master: ROLLBACK
[0m14:27:14.677674 [debug] [MainThread]: Using postgres connection "master"
[0m14:27:14.678841 [debug] [MainThread]: On master: BEGIN
[0m14:27:14.680877 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m14:27:14.682144 [debug] [MainThread]: On master: COMMIT
[0m14:27:14.683376 [debug] [MainThread]: Using postgres connection "master"
[0m14:27:14.684628 [debug] [MainThread]: On master: COMMIT
[0m14:27:14.686059 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:27:14.687653 [debug] [MainThread]: On master: Close
[0m14:27:14.695237 [debug] [Thread-1 (]: Began running node model.social_analytics.stg_posts
[0m14:27:14.696968 [info ] [Thread-1 (]: 1 of 3 START sql view model analytics.stg_posts ................................ [RUN]
[0m14:27:14.699089 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_social_analytics_analytics, now model.social_analytics.stg_posts)
[0m14:27:14.700581 [debug] [Thread-1 (]: Began compiling node model.social_analytics.stg_posts
[0m14:27:14.710115 [debug] [Thread-1 (]: Writing injected SQL for node "model.social_analytics.stg_posts"
[0m14:27:14.718839 [debug] [Thread-1 (]: Began executing node model.social_analytics.stg_posts
[0m14:27:14.757449 [debug] [Thread-1 (]: Writing runtime sql for node "model.social_analytics.stg_posts"
[0m14:27:14.767371 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.stg_posts"
[0m14:27:14.768756 [debug] [Thread-1 (]: On model.social_analytics.stg_posts: BEGIN
[0m14:27:14.770069 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:27:14.777076 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m14:27:14.778798 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.stg_posts"
[0m14:27:14.780063 [debug] [Thread-1 (]: On model.social_analytics.stg_posts: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.stg_posts"} */

  create view "social_analytics"."analytics"."stg_posts__dbt_tmp"
    
    
  as (
    

SELECT
    id,
    platform,
    author_name,
    content_text,
    like_count,
    comment_count,
    share_count,
    engagement_score,
    posted_at_utc,
    collected_at_utc
FROM public.posts
  );
[0m14:27:14.794883 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.013 seconds
[0m14:27:14.802673 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.stg_posts"
[0m14:27:14.804041 [debug] [Thread-1 (]: On model.social_analytics.stg_posts: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.stg_posts"} */
alter table "social_analytics"."analytics"."stg_posts" rename to "stg_posts__dbt_backup"
[0m14:27:14.805822 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:27:14.809985 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.stg_posts"
[0m14:27:14.811272 [debug] [Thread-1 (]: On model.social_analytics.stg_posts: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.stg_posts"} */
alter table "social_analytics"."analytics"."stg_posts__dbt_tmp" rename to "stg_posts"
[0m14:27:14.813710 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:27:14.830857 [debug] [Thread-1 (]: On model.social_analytics.stg_posts: COMMIT
[0m14:27:14.832709 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.stg_posts"
[0m14:27:14.834288 [debug] [Thread-1 (]: On model.social_analytics.stg_posts: COMMIT
[0m14:27:14.837735 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m14:27:14.845304 [debug] [Thread-1 (]: Applying DROP to: "social_analytics"."analytics"."stg_posts__dbt_backup"
[0m14:27:14.852082 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.stg_posts"
[0m14:27:14.853571 [debug] [Thread-1 (]: On model.social_analytics.stg_posts: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.stg_posts"} */
drop view if exists "social_analytics"."analytics"."stg_posts__dbt_backup" cascade
[0m14:27:14.858838 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.004 seconds
[0m14:27:14.862756 [debug] [Thread-1 (]: On model.social_analytics.stg_posts: Close
[0m14:27:14.866193 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a83a6bc3-b503-4f4f-88bd-b5a94d027f0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15d5f327d0>]}
[0m14:27:14.868025 [info ] [Thread-1 (]: 1 of 3 OK created sql view model analytics.stg_posts ........................... [[32mCREATE VIEW[0m in 0.17s]
[0m14:27:14.869794 [debug] [Thread-1 (]: Finished running node model.social_analytics.stg_posts
[0m14:27:14.872001 [debug] [Thread-1 (]: Began running node model.social_analytics.fct_daily_metrics
[0m14:27:14.873310 [info ] [Thread-1 (]: 2 of 3 START sql table model analytics.fct_daily_metrics ....................... [RUN]
[0m14:27:14.874840 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.social_analytics.stg_posts, now model.social_analytics.fct_daily_metrics)
[0m14:27:14.876264 [debug] [Thread-1 (]: Began compiling node model.social_analytics.fct_daily_metrics
[0m14:27:14.881282 [debug] [Thread-1 (]: Writing injected SQL for node "model.social_analytics.fct_daily_metrics"
[0m14:27:14.892850 [debug] [Thread-1 (]: Began executing node model.social_analytics.fct_daily_metrics
[0m14:27:14.921597 [debug] [Thread-1 (]: Writing runtime sql for node "model.social_analytics.fct_daily_metrics"
[0m14:27:14.930930 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.fct_daily_metrics"
[0m14:27:14.932170 [debug] [Thread-1 (]: On model.social_analytics.fct_daily_metrics: BEGIN
[0m14:27:14.933311 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:27:14.941693 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m14:27:14.943344 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.fct_daily_metrics"
[0m14:27:14.944552 [debug] [Thread-1 (]: On model.social_analytics.fct_daily_metrics: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.fct_daily_metrics"} */

  
    

  create  table "social_analytics"."analytics"."fct_daily_metrics__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    DATE(posted_at_utc) AS post_date,
    COUNT(*) AS total_posts,
    SUM(like_count) AS total_likes,
    SUM(comment_count) AS total_comments,
    SUM(share_count) AS total_shares,
    SUM(engagement_score) AS total_engagement
FROM "social_analytics"."analytics"."stg_posts"
GROUP BY DATE(posted_at_utc)
ORDER BY post_date DESC
  );
  
[0m14:27:14.954449 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.009 seconds
[0m14:27:14.962677 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.fct_daily_metrics"
[0m14:27:14.964316 [debug] [Thread-1 (]: On model.social_analytics.fct_daily_metrics: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.fct_daily_metrics"} */
alter table "social_analytics"."analytics"."fct_daily_metrics" rename to "fct_daily_metrics__dbt_backup"
[0m14:27:14.966672 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:27:14.971339 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.fct_daily_metrics"
[0m14:27:14.972780 [debug] [Thread-1 (]: On model.social_analytics.fct_daily_metrics: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.fct_daily_metrics"} */
alter table "social_analytics"."analytics"."fct_daily_metrics__dbt_tmp" rename to "fct_daily_metrics"
[0m14:27:14.974455 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:27:14.976908 [debug] [Thread-1 (]: On model.social_analytics.fct_daily_metrics: COMMIT
[0m14:27:14.978187 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.fct_daily_metrics"
[0m14:27:14.979461 [debug] [Thread-1 (]: On model.social_analytics.fct_daily_metrics: COMMIT
[0m14:27:14.982826 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m14:27:14.986545 [debug] [Thread-1 (]: Applying DROP to: "social_analytics"."analytics"."fct_daily_metrics__dbt_backup"
[0m14:27:14.990502 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.fct_daily_metrics"
[0m14:27:14.991870 [debug] [Thread-1 (]: On model.social_analytics.fct_daily_metrics: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.fct_daily_metrics"} */
drop table if exists "social_analytics"."analytics"."fct_daily_metrics__dbt_backup" cascade
[0m14:27:14.998899 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.006 seconds
[0m14:27:15.001527 [debug] [Thread-1 (]: On model.social_analytics.fct_daily_metrics: Close
[0m14:27:15.003030 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a83a6bc3-b503-4f4f-88bd-b5a94d027f0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15beb25e90>]}
[0m14:27:15.004911 [info ] [Thread-1 (]: 2 of 3 OK created sql table model analytics.fct_daily_metrics .................. [[32mSELECT 2[0m in 0.13s]
[0m14:27:15.006836 [debug] [Thread-1 (]: Finished running node model.social_analytics.fct_daily_metrics
[0m14:27:15.008078 [debug] [Thread-1 (]: Began running node model.social_analytics.top_posts
[0m14:27:15.009497 [info ] [Thread-1 (]: 3 of 3 START sql table model analytics.top_posts ............................... [RUN]
[0m14:27:15.011214 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.social_analytics.fct_daily_metrics, now model.social_analytics.top_posts)
[0m14:27:15.012582 [debug] [Thread-1 (]: Began compiling node model.social_analytics.top_posts
[0m14:27:15.017030 [debug] [Thread-1 (]: Writing injected SQL for node "model.social_analytics.top_posts"
[0m14:27:15.026777 [debug] [Thread-1 (]: Began executing node model.social_analytics.top_posts
[0m14:27:15.032776 [debug] [Thread-1 (]: Writing runtime sql for node "model.social_analytics.top_posts"
[0m14:27:15.043791 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.top_posts"
[0m14:27:15.046332 [debug] [Thread-1 (]: On model.social_analytics.top_posts: BEGIN
[0m14:27:15.048450 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:27:15.058232 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m14:27:15.060240 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.top_posts"
[0m14:27:15.061826 [debug] [Thread-1 (]: On model.social_analytics.top_posts: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.top_posts"} */

  
    

  create  table "social_analytics"."analytics"."top_posts__dbt_tmp"
  
  
    as
  
  (
    

WITH ranked_posts AS (
    SELECT
        DATE(posted_at_utc) AS post_date,
        platform,
        author_name,
        content_text,
        content_url,
        like_count,
        comment_count,
        share_count,
        engagement_score,
        ROW_NUMBER() OVER (
            PARTITION BY DATE(posted_at_utc), platform
            ORDER BY engagement_score DESC
        ) AS rank
    FROM "social_analytics"."analytics"."stg_posts"
)
SELECT
    post_date,
    platform,
    author_name,
    content_text,
    content_url,
    like_count,
    comment_count,
    share_count,
    engagement_score,
    rank
FROM ranked_posts
WHERE rank <= 10
ORDER BY post_date DESC, platform, rank
  );
  
[0m14:27:15.066163 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "content_url" does not exist
LINE 20:         content_url,
                 ^

[0m14:27:15.067711 [debug] [Thread-1 (]: On model.social_analytics.top_posts: ROLLBACK
[0m14:27:15.069222 [debug] [Thread-1 (]: On model.social_analytics.top_posts: Close
[0m14:27:15.077980 [debug] [Thread-1 (]: Database Error in model top_posts (models/top_posts.sql)
  column "content_url" does not exist
  LINE 20:         content_url,
                   ^
  compiled code at target/run/social_analytics/models/top_posts.sql
[0m14:27:15.079753 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a83a6bc3-b503-4f4f-88bd-b5a94d027f0e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15d40ff3d0>]}
[0m14:27:15.081745 [error] [Thread-1 (]: 3 of 3 ERROR creating sql table model analytics.top_posts ...................... [[31mERROR[0m in 0.07s]
[0m14:27:15.083580 [debug] [Thread-1 (]: Finished running node model.social_analytics.top_posts
[0m14:27:15.085077 [debug] [Thread-4 (]: Marking all children of 'model.social_analytics.top_posts' to be skipped because of status 'error'.  Reason: Database Error in model top_posts (models/top_posts.sql)
  column "content_url" does not exist
  LINE 20:         content_url,
                   ^
  compiled code at target/run/social_analytics/models/top_posts.sql.
[0m14:27:15.088418 [debug] [MainThread]: Using postgres connection "master"
[0m14:27:15.089748 [debug] [MainThread]: On master: BEGIN
[0m14:27:15.090812 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:27:15.097610 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m14:27:15.099019 [debug] [MainThread]: On master: COMMIT
[0m14:27:15.100116 [debug] [MainThread]: Using postgres connection "master"
[0m14:27:15.101151 [debug] [MainThread]: On master: COMMIT
[0m14:27:15.102326 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:27:15.103507 [debug] [MainThread]: On master: Close
[0m14:27:15.105471 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:27:15.107325 [debug] [MainThread]: Connection 'model.social_analytics.top_posts' was properly closed.
[0m14:27:15.109128 [info ] [MainThread]: 
[0m14:27:15.110997 [info ] [MainThread]: Finished running 2 table models, 1 view model in 0 hours 0 minutes and 0.66 seconds (0.66s).
[0m14:27:15.113673 [debug] [MainThread]: Command end result
[0m14:27:15.157732 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt_project/target/manifest.json
[0m14:27:15.165483 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt_project/target/semantic_manifest.json
[0m14:27:15.177891 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt_project/target/run_results.json
[0m14:27:15.179353 [info ] [MainThread]: 
[0m14:27:15.181139 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:27:15.182857 [info ] [MainThread]: 
[0m14:27:15.184623 [error] [MainThread]: [31mFailure in model top_posts (models/top_posts.sql)[0m
[0m14:27:15.186181 [error] [MainThread]:   Database Error in model top_posts (models/top_posts.sql)
  column "content_url" does not exist
  LINE 20:         content_url,
                   ^
  compiled code at target/run/social_analytics/models/top_posts.sql
[0m14:27:15.187672 [info ] [MainThread]: 
[0m14:27:15.189597 [info ] [MainThread]:   compiled code at target/compiled/social_analytics/models/top_posts.sql
[0m14:27:15.191083 [info ] [MainThread]: 
[0m14:27:15.192324 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=3
[0m14:27:15.195988 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.6949477, "process_in_blocks": "95688", "process_kernel_time": 0.4401, "process_mem_max_rss": "129892", "process_out_blocks": "8", "process_user_time": 2.742952}
[0m14:27:15.197546 [debug] [MainThread]: Command `dbt run` failed at 14:27:15.197356 after 1.70 seconds
[0m14:27:15.198844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15d73c5450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15d73cf990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f15d75d8c10>]}
[0m14:27:15.200407 [debug] [MainThread]: Flushing usage events
[0m14:27:16.124312 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:30:07.337006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e2a9ac590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e2a9b7e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e2ef1c410>]}


============================== 14:30:07.344378 | 1b55b5c3-b58d-4a4f-b1a9-821f56a89ca1 ==============================
[0m14:30:07.344378 [info ] [MainThread]: Running with dbt=1.10.9
[0m14:30:07.346042 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'quiet': 'False', 'warn_error': 'None', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_experimental_parser': 'False', 'profiles_dir': '/app', 'version_check': 'True', 'empty': 'False', 'cache_selected_only': 'False', 'introspect': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'no_print': 'None', 'write_json': 'True', 'target_path': 'None', 'static_parser': 'True', 'log_cache_events': 'False', 'printer_width': '80', 'invocation_command': 'dbt run', 'log_path': '/app/dbt_project/logs'}
[0m14:30:07.538619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1b55b5c3-b58d-4a4f-b1a9-821f56a89ca1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e2a2f9ad0>]}
[0m14:30:07.600076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1b55b5c3-b58d-4a4f-b1a9-821f56a89ca1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e2d564e10>]}
[0m14:30:07.603518 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:30:07.685608 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m14:30:07.847877 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:30:07.849229 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:30:07.877194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1b55b5c3-b58d-4a4f-b1a9-821f56a89ca1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e2a999e90>]}
[0m14:30:07.944431 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt_project/target/manifest.json
[0m14:30:07.952075 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt_project/target/semantic_manifest.json
[0m14:30:07.986553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1b55b5c3-b58d-4a4f-b1a9-821f56a89ca1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e29302a50>]}
[0m14:30:07.988099 [info ] [MainThread]: Found 3 models, 434 macros
[0m14:30:07.989900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1b55b5c3-b58d-4a4f-b1a9-821f56a89ca1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e29788a50>]}
[0m14:30:07.992886 [info ] [MainThread]: 
[0m14:30:07.994428 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:30:07.995754 [info ] [MainThread]: 
[0m14:30:07.997504 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:30:08.005795 [debug] [ThreadPool]: Acquiring new postgres connection 'list_social_analytics'
[0m14:30:08.068747 [debug] [ThreadPool]: Using postgres connection "list_social_analytics"
[0m14:30:08.070328 [debug] [ThreadPool]: On list_social_analytics: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "connection_name": "list_social_analytics"} */

    select distinct nspname from pg_namespace
  
[0m14:30:08.071571 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:30:08.089439 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.018 seconds
[0m14:30:08.091472 [debug] [ThreadPool]: On list_social_analytics: Close
[0m14:30:08.094108 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_social_analytics, now list_social_analytics_analytics)
[0m14:30:08.100691 [debug] [ThreadPool]: Using postgres connection "list_social_analytics_analytics"
[0m14:30:08.101661 [debug] [ThreadPool]: On list_social_analytics_analytics: BEGIN
[0m14:30:08.102437 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:30:08.109342 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m14:30:08.110472 [debug] [ThreadPool]: Using postgres connection "list_social_analytics_analytics"
[0m14:30:08.111334 [debug] [ThreadPool]: On list_social_analytics_analytics: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "connection_name": "list_social_analytics_analytics"} */
select
      'social_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'social_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'social_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m14:30:08.115644 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.003 seconds
[0m14:30:08.117916 [debug] [ThreadPool]: On list_social_analytics_analytics: ROLLBACK
[0m14:30:08.118886 [debug] [ThreadPool]: On list_social_analytics_analytics: Close
[0m14:30:08.124854 [debug] [MainThread]: Using postgres connection "master"
[0m14:30:08.125989 [debug] [MainThread]: On master: BEGIN
[0m14:30:08.126903 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:30:08.133590 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m14:30:08.134782 [debug] [MainThread]: Using postgres connection "master"
[0m14:30:08.135960 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:30:08.141143 [debug] [MainThread]: SQL status: SELECT 1 in 0.004 seconds
[0m14:30:08.143331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1b55b5c3-b58d-4a4f-b1a9-821f56a89ca1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e2a864750>]}
[0m14:30:08.144426 [debug] [MainThread]: On master: ROLLBACK
[0m14:30:08.146143 [debug] [MainThread]: Using postgres connection "master"
[0m14:30:08.147484 [debug] [MainThread]: On master: BEGIN
[0m14:30:08.148878 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:30:08.150111 [debug] [MainThread]: On master: COMMIT
[0m14:30:08.151108 [debug] [MainThread]: Using postgres connection "master"
[0m14:30:08.152203 [debug] [MainThread]: On master: COMMIT
[0m14:30:08.153397 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:30:08.154443 [debug] [MainThread]: On master: Close
[0m14:30:08.160940 [debug] [Thread-1 (]: Began running node model.social_analytics.stg_posts
[0m14:30:08.162437 [info ] [Thread-1 (]: 1 of 3 START sql view model analytics.stg_posts ................................ [RUN]
[0m14:30:08.164117 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_social_analytics_analytics, now model.social_analytics.stg_posts)
[0m14:30:08.165341 [debug] [Thread-1 (]: Began compiling node model.social_analytics.stg_posts
[0m14:30:08.173929 [debug] [Thread-1 (]: Writing injected SQL for node "model.social_analytics.stg_posts"
[0m14:30:08.183090 [debug] [Thread-1 (]: Began executing node model.social_analytics.stg_posts
[0m14:30:08.219063 [debug] [Thread-1 (]: Writing runtime sql for node "model.social_analytics.stg_posts"
[0m14:30:08.226723 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.stg_posts"
[0m14:30:08.227788 [debug] [Thread-1 (]: On model.social_analytics.stg_posts: BEGIN
[0m14:30:08.228712 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:30:08.234823 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m14:30:08.236078 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.stg_posts"
[0m14:30:08.237143 [debug] [Thread-1 (]: On model.social_analytics.stg_posts: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.stg_posts"} */

  create view "social_analytics"."analytics"."stg_posts__dbt_tmp"
    
    
  as (
    

SELECT
    id,
    platform,
    author_name,
    content_text,
    like_count,
    comment_count,
    share_count,
    engagement_score,
    posted_at_utc,
    collected_at_utc
FROM public.posts
  );
[0m14:30:08.241847 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.004 seconds
[0m14:30:08.249124 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.stg_posts"
[0m14:30:08.250266 [debug] [Thread-1 (]: On model.social_analytics.stg_posts: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.stg_posts"} */
alter table "social_analytics"."analytics"."stg_posts" rename to "stg_posts__dbt_backup"
[0m14:30:08.251828 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:30:08.255661 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.stg_posts"
[0m14:30:08.256715 [debug] [Thread-1 (]: On model.social_analytics.stg_posts: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.stg_posts"} */
alter table "social_analytics"."analytics"."stg_posts__dbt_tmp" rename to "stg_posts"
[0m14:30:08.258181 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:30:08.275097 [debug] [Thread-1 (]: On model.social_analytics.stg_posts: COMMIT
[0m14:30:08.276544 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.stg_posts"
[0m14:30:08.277739 [debug] [Thread-1 (]: On model.social_analytics.stg_posts: COMMIT
[0m14:30:08.280592 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m14:30:08.345949 [debug] [Thread-1 (]: Applying DROP to: "social_analytics"."analytics"."stg_posts__dbt_backup"
[0m14:30:08.352364 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.stg_posts"
[0m14:30:08.353636 [debug] [Thread-1 (]: On model.social_analytics.stg_posts: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.stg_posts"} */
drop view if exists "social_analytics"."analytics"."stg_posts__dbt_backup" cascade
[0m14:30:08.358257 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m14:30:08.361253 [debug] [Thread-1 (]: On model.social_analytics.stg_posts: Close
[0m14:30:08.364280 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b55b5c3-b58d-4a4f-b1a9-821f56a89ca1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e287ac550>]}
[0m14:30:08.365867 [info ] [Thread-1 (]: 1 of 3 OK created sql view model analytics.stg_posts ........................... [[32mCREATE VIEW[0m in 0.20s]
[0m14:30:08.367389 [debug] [Thread-1 (]: Finished running node model.social_analytics.stg_posts
[0m14:30:08.369140 [debug] [Thread-1 (]: Began running node model.social_analytics.fct_daily_metrics
[0m14:30:08.370205 [info ] [Thread-1 (]: 2 of 3 START sql table model analytics.fct_daily_metrics ....................... [RUN]
[0m14:30:08.371360 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.social_analytics.stg_posts, now model.social_analytics.fct_daily_metrics)
[0m14:30:08.372497 [debug] [Thread-1 (]: Began compiling node model.social_analytics.fct_daily_metrics
[0m14:30:08.376219 [debug] [Thread-1 (]: Writing injected SQL for node "model.social_analytics.fct_daily_metrics"
[0m14:30:08.383983 [debug] [Thread-1 (]: Began executing node model.social_analytics.fct_daily_metrics
[0m14:30:08.407968 [debug] [Thread-1 (]: Writing runtime sql for node "model.social_analytics.fct_daily_metrics"
[0m14:30:08.416250 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.fct_daily_metrics"
[0m14:30:08.417314 [debug] [Thread-1 (]: On model.social_analytics.fct_daily_metrics: BEGIN
[0m14:30:08.418318 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:30:08.424409 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m14:30:08.425619 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.fct_daily_metrics"
[0m14:30:08.426566 [debug] [Thread-1 (]: On model.social_analytics.fct_daily_metrics: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.fct_daily_metrics"} */

  
    

  create  table "social_analytics"."analytics"."fct_daily_metrics__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    DATE(posted_at_utc) AS post_date,
    COUNT(*) AS total_posts,
    SUM(like_count) AS total_likes,
    SUM(comment_count) AS total_comments,
    SUM(share_count) AS total_shares,
    SUM(engagement_score) AS total_engagement
FROM "social_analytics"."analytics"."stg_posts"
GROUP BY DATE(posted_at_utc)
ORDER BY post_date DESC
  );
  
[0m14:30:08.436531 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.009 seconds
[0m14:30:08.443946 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.fct_daily_metrics"
[0m14:30:08.445141 [debug] [Thread-1 (]: On model.social_analytics.fct_daily_metrics: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.fct_daily_metrics"} */
alter table "social_analytics"."analytics"."fct_daily_metrics" rename to "fct_daily_metrics__dbt_backup"
[0m14:30:08.446402 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:30:08.449791 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.fct_daily_metrics"
[0m14:30:08.450882 [debug] [Thread-1 (]: On model.social_analytics.fct_daily_metrics: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.fct_daily_metrics"} */
alter table "social_analytics"."analytics"."fct_daily_metrics__dbt_tmp" rename to "fct_daily_metrics"
[0m14:30:08.452218 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:30:08.454450 [debug] [Thread-1 (]: On model.social_analytics.fct_daily_metrics: COMMIT
[0m14:30:08.455652 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.fct_daily_metrics"
[0m14:30:08.456859 [debug] [Thread-1 (]: On model.social_analytics.fct_daily_metrics: COMMIT
[0m14:30:08.459923 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m14:30:08.463213 [debug] [Thread-1 (]: Applying DROP to: "social_analytics"."analytics"."fct_daily_metrics__dbt_backup"
[0m14:30:08.467034 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.fct_daily_metrics"
[0m14:30:08.468056 [debug] [Thread-1 (]: On model.social_analytics.fct_daily_metrics: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.fct_daily_metrics"} */
drop table if exists "social_analytics"."analytics"."fct_daily_metrics__dbt_backup" cascade
[0m14:30:08.473625 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.005 seconds
[0m14:30:08.475694 [debug] [Thread-1 (]: On model.social_analytics.fct_daily_metrics: Close
[0m14:30:08.477023 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b55b5c3-b58d-4a4f-b1a9-821f56a89ca1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e2a9a5cd0>]}
[0m14:30:08.478494 [info ] [Thread-1 (]: 2 of 3 OK created sql table model analytics.fct_daily_metrics .................. [[32mSELECT 2[0m in 0.11s]
[0m14:30:08.480072 [debug] [Thread-1 (]: Finished running node model.social_analytics.fct_daily_metrics
[0m14:30:08.481249 [debug] [Thread-1 (]: Began running node model.social_analytics.top_posts
[0m14:30:08.482397 [info ] [Thread-1 (]: 3 of 3 START sql table model analytics.top_posts ............................... [RUN]
[0m14:30:08.483748 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.social_analytics.fct_daily_metrics, now model.social_analytics.top_posts)
[0m14:30:08.484790 [debug] [Thread-1 (]: Began compiling node model.social_analytics.top_posts
[0m14:30:08.489120 [debug] [Thread-1 (]: Writing injected SQL for node "model.social_analytics.top_posts"
[0m14:30:08.497663 [debug] [Thread-1 (]: Began executing node model.social_analytics.top_posts
[0m14:30:08.502855 [debug] [Thread-1 (]: Writing runtime sql for node "model.social_analytics.top_posts"
[0m14:30:08.510086 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.top_posts"
[0m14:30:08.511144 [debug] [Thread-1 (]: On model.social_analytics.top_posts: BEGIN
[0m14:30:08.512121 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:30:08.519868 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m14:30:08.520946 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.top_posts"
[0m14:30:08.521907 [debug] [Thread-1 (]: On model.social_analytics.top_posts: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.top_posts"} */

  
    

  create  table "social_analytics"."analytics"."top_posts__dbt_tmp"
  
  
    as
  
  (
    

WITH ranked_posts AS (
    SELECT
        DATE(posted_at_utc) AS post_date,
        platform,
        author_name,
        content_text,
        content_url,
        like_count,
        comment_count,
        share_count,
        engagement_score,
        ROW_NUMBER() OVER (
            PARTITION BY DATE(posted_at_utc), platform
            ORDER BY engagement_score DESC
        ) AS rank
    FROM "social_analytics"."analytics"."stg_posts"
)
SELECT
    post_date,
    platform,
    author_name,
    content_text,
    content_url,
    like_count,
    comment_count,
    share_count,
    engagement_score,
    rank
FROM ranked_posts
WHERE rank <= 10
ORDER BY post_date DESC, platform, rank
  );
  
[0m14:30:08.523479 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "content_url" does not exist
LINE 20:         content_url,
                 ^

[0m14:30:08.524433 [debug] [Thread-1 (]: On model.social_analytics.top_posts: ROLLBACK
[0m14:30:08.525513 [debug] [Thread-1 (]: On model.social_analytics.top_posts: Close
[0m14:30:08.533461 [debug] [Thread-1 (]: Database Error in model top_posts (models/top_posts.sql)
  column "content_url" does not exist
  LINE 20:         content_url,
                   ^
  compiled code at target/run/social_analytics/models/top_posts.sql
[0m14:30:08.535421 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b55b5c3-b58d-4a4f-b1a9-821f56a89ca1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e287a6a10>]}
[0m14:30:08.536799 [error] [Thread-1 (]: 3 of 3 ERROR creating sql table model analytics.top_posts ...................... [[31mERROR[0m in 0.05s]
[0m14:30:08.538183 [debug] [Thread-1 (]: Finished running node model.social_analytics.top_posts
[0m14:30:08.539582 [debug] [Thread-4 (]: Marking all children of 'model.social_analytics.top_posts' to be skipped because of status 'error'.  Reason: Database Error in model top_posts (models/top_posts.sql)
  column "content_url" does not exist
  LINE 20:         content_url,
                   ^
  compiled code at target/run/social_analytics/models/top_posts.sql.
[0m14:30:08.542496 [debug] [MainThread]: Using postgres connection "master"
[0m14:30:08.543429 [debug] [MainThread]: On master: BEGIN
[0m14:30:08.544431 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:30:08.551026 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m14:30:08.552419 [debug] [MainThread]: On master: COMMIT
[0m14:30:08.553479 [debug] [MainThread]: Using postgres connection "master"
[0m14:30:08.554486 [debug] [MainThread]: On master: COMMIT
[0m14:30:08.556253 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:30:08.557792 [debug] [MainThread]: On master: Close
[0m14:30:08.559141 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:30:08.560188 [debug] [MainThread]: Connection 'model.social_analytics.top_posts' was properly closed.
[0m14:30:08.561410 [info ] [MainThread]: 
[0m14:30:08.562974 [info ] [MainThread]: Finished running 2 table models, 1 view model in 0 hours 0 minutes and 0.56 seconds (0.56s).
[0m14:30:08.565255 [debug] [MainThread]: Command end result
[0m14:30:08.602249 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt_project/target/manifest.json
[0m14:30:08.609541 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt_project/target/semantic_manifest.json
[0m14:30:08.620626 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt_project/target/run_results.json
[0m14:30:08.621821 [info ] [MainThread]: 
[0m14:30:08.623229 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:30:08.624686 [info ] [MainThread]: 
[0m14:30:08.626077 [error] [MainThread]: [31mFailure in model top_posts (models/top_posts.sql)[0m
[0m14:30:08.627632 [error] [MainThread]:   Database Error in model top_posts (models/top_posts.sql)
  column "content_url" does not exist
  LINE 20:         content_url,
                   ^
  compiled code at target/run/social_analytics/models/top_posts.sql
[0m14:30:08.628810 [info ] [MainThread]: 
[0m14:30:08.630247 [info ] [MainThread]:   compiled code at target/compiled/social_analytics/models/top_posts.sql
[0m14:30:08.631423 [info ] [MainThread]: 
[0m14:30:08.632594 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=3
[0m14:30:08.635047 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.3647434, "process_in_blocks": "95096", "process_kernel_time": 0.424186, "process_mem_max_rss": "122864", "process_out_blocks": "8", "process_user_time": 2.525837}
[0m14:30:08.636534 [debug] [MainThread]: Command `dbt run` failed at 14:30:08.636354 after 1.37 seconds
[0m14:30:08.637953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e2bc453d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e287b4ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5e2a376550>]}
[0m14:30:08.639405 [debug] [MainThread]: Flushing usage events
[0m14:30:09.791657 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:32:09.075258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea0fac04d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea0fc3a110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea0fd00990>]}


============================== 14:32:09.082558 | de3a18ec-8370-4742-adbc-b652c469acbb ==============================
[0m14:32:09.082558 [info ] [MainThread]: Running with dbt=1.10.9
[0m14:32:09.084017 [debug] [MainThread]: running dbt with arguments {'partial_parse': 'True', 'profiles_dir': '/app', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'log_format': 'default', 'cache_selected_only': 'False', 'no_print': 'None', 'warn_error': 'None', 'invocation_command': 'dbt run', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'log_path': '/app/dbt_project/logs', 'write_json': 'True', 'target_path': 'None', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'empty': 'False', 'static_parser': 'True', 'fail_fast': 'False', 'introspect': 'True'}
[0m14:32:09.276291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'de3a18ec-8370-4742-adbc-b652c469acbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea0f10e110>]}
[0m14:32:09.334724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'de3a18ec-8370-4742-adbc-b652c469acbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea1267d1d0>]}
[0m14:32:09.338334 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:32:09.420348 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m14:32:09.605419 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:32:09.606876 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:32:09.634159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'de3a18ec-8370-4742-adbc-b652c469acbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea0e52a690>]}
[0m14:32:09.701978 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt_project/target/manifest.json
[0m14:32:09.709872 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt_project/target/semantic_manifest.json
[0m14:32:09.743291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'de3a18ec-8370-4742-adbc-b652c469acbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea0e102e90>]}
[0m14:32:09.744854 [info ] [MainThread]: Found 3 models, 434 macros
[0m14:32:09.746153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'de3a18ec-8370-4742-adbc-b652c469acbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea0e9da750>]}
[0m14:32:09.749027 [info ] [MainThread]: 
[0m14:32:09.750532 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:32:09.751746 [info ] [MainThread]: 
[0m14:32:09.753696 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:32:09.760213 [debug] [ThreadPool]: Acquiring new postgres connection 'list_social_analytics'
[0m14:32:09.816236 [debug] [ThreadPool]: Using postgres connection "list_social_analytics"
[0m14:32:09.817662 [debug] [ThreadPool]: On list_social_analytics: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "connection_name": "list_social_analytics"} */

    select distinct nspname from pg_namespace
  
[0m14:32:09.818841 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:32:09.834494 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.016 seconds
[0m14:32:09.836837 [debug] [ThreadPool]: On list_social_analytics: Close
[0m14:32:09.839613 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_social_analytics, now list_social_analytics_analytics)
[0m14:32:09.846499 [debug] [ThreadPool]: Using postgres connection "list_social_analytics_analytics"
[0m14:32:09.847734 [debug] [ThreadPool]: On list_social_analytics_analytics: BEGIN
[0m14:32:09.848844 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:32:09.855133 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m14:32:09.856601 [debug] [ThreadPool]: Using postgres connection "list_social_analytics_analytics"
[0m14:32:09.857656 [debug] [ThreadPool]: On list_social_analytics_analytics: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "connection_name": "list_social_analytics_analytics"} */
select
      'social_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'social_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'social_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m14:32:09.861302 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.003 seconds
[0m14:32:09.863501 [debug] [ThreadPool]: On list_social_analytics_analytics: ROLLBACK
[0m14:32:09.864767 [debug] [ThreadPool]: On list_social_analytics_analytics: Close
[0m14:32:09.870589 [debug] [MainThread]: Using postgres connection "master"
[0m14:32:09.871832 [debug] [MainThread]: On master: BEGIN
[0m14:32:09.872886 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:32:09.879192 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m14:32:09.880341 [debug] [MainThread]: Using postgres connection "master"
[0m14:32:09.881314 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:32:09.886019 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m14:32:09.887800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'de3a18ec-8370-4742-adbc-b652c469acbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea0e54fe10>]}
[0m14:32:09.889016 [debug] [MainThread]: On master: ROLLBACK
[0m14:32:09.890065 [debug] [MainThread]: Using postgres connection "master"
[0m14:32:09.891030 [debug] [MainThread]: On master: BEGIN
[0m14:32:09.892271 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:32:09.893122 [debug] [MainThread]: On master: COMMIT
[0m14:32:09.893937 [debug] [MainThread]: Using postgres connection "master"
[0m14:32:09.894725 [debug] [MainThread]: On master: COMMIT
[0m14:32:09.895735 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:32:09.896652 [debug] [MainThread]: On master: Close
[0m14:32:09.904686 [debug] [Thread-1 (]: Began running node model.social_analytics.stg_posts
[0m14:32:09.906230 [info ] [Thread-1 (]: 1 of 3 START sql view model analytics.stg_posts ................................ [RUN]
[0m14:32:09.907775 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_social_analytics_analytics, now model.social_analytics.stg_posts)
[0m14:32:09.908946 [debug] [Thread-1 (]: Began compiling node model.social_analytics.stg_posts
[0m14:32:09.917007 [debug] [Thread-1 (]: Writing injected SQL for node "model.social_analytics.stg_posts"
[0m14:32:09.926382 [debug] [Thread-1 (]: Began executing node model.social_analytics.stg_posts
[0m14:32:09.961015 [debug] [Thread-1 (]: Writing runtime sql for node "model.social_analytics.stg_posts"
[0m14:32:09.968738 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.stg_posts"
[0m14:32:09.969834 [debug] [Thread-1 (]: On model.social_analytics.stg_posts: BEGIN
[0m14:32:09.970820 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:32:09.977330 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m14:32:09.978462 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.stg_posts"
[0m14:32:09.979409 [debug] [Thread-1 (]: On model.social_analytics.stg_posts: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.stg_posts"} */

  create view "social_analytics"."analytics"."stg_posts__dbt_tmp"
    
    
  as (
    

SELECT
    id,
    platform,
    author_name,
    content_text,
    like_count,
    comment_count,
    share_count,
    engagement_score,
    posted_at_utc,
    collected_at_utc
FROM public.posts
  );
[0m14:32:09.983815 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m14:32:09.991048 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.stg_posts"
[0m14:32:09.992259 [debug] [Thread-1 (]: On model.social_analytics.stg_posts: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.stg_posts"} */
alter table "social_analytics"."analytics"."stg_posts__dbt_tmp" rename to "stg_posts"
[0m14:32:09.993622 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:32:10.009125 [debug] [Thread-1 (]: On model.social_analytics.stg_posts: COMMIT
[0m14:32:10.010541 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.stg_posts"
[0m14:32:10.011465 [debug] [Thread-1 (]: On model.social_analytics.stg_posts: COMMIT
[0m14:32:10.014573 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m14:32:10.022594 [debug] [Thread-1 (]: Applying DROP to: "social_analytics"."analytics"."stg_posts__dbt_backup"
[0m14:32:10.027954 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.stg_posts"
[0m14:32:10.029071 [debug] [Thread-1 (]: On model.social_analytics.stg_posts: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.stg_posts"} */
drop view if exists "social_analytics"."analytics"."stg_posts__dbt_backup" cascade
[0m14:32:10.030881 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m14:32:10.033792 [debug] [Thread-1 (]: On model.social_analytics.stg_posts: Close
[0m14:32:10.036555 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'de3a18ec-8370-4742-adbc-b652c469acbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea0cd77c10>]}
[0m14:32:10.038018 [info ] [Thread-1 (]: 1 of 3 OK created sql view model analytics.stg_posts ........................... [[32mCREATE VIEW[0m in 0.13s]
[0m14:32:10.039768 [debug] [Thread-1 (]: Finished running node model.social_analytics.stg_posts
[0m14:32:10.041679 [debug] [Thread-1 (]: Began running node model.social_analytics.fct_daily_metrics
[0m14:32:10.042962 [info ] [Thread-1 (]: 2 of 3 START sql table model analytics.fct_daily_metrics ....................... [RUN]
[0m14:32:10.044315 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.social_analytics.stg_posts, now model.social_analytics.fct_daily_metrics)
[0m14:32:10.045612 [debug] [Thread-1 (]: Began compiling node model.social_analytics.fct_daily_metrics
[0m14:32:10.115728 [debug] [Thread-1 (]: Writing injected SQL for node "model.social_analytics.fct_daily_metrics"
[0m14:32:10.123865 [debug] [Thread-1 (]: Began executing node model.social_analytics.fct_daily_metrics
[0m14:32:10.149206 [debug] [Thread-1 (]: Writing runtime sql for node "model.social_analytics.fct_daily_metrics"
[0m14:32:10.158484 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.fct_daily_metrics"
[0m14:32:10.159680 [debug] [Thread-1 (]: On model.social_analytics.fct_daily_metrics: BEGIN
[0m14:32:10.160619 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:32:10.167177 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m14:32:10.168325 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.fct_daily_metrics"
[0m14:32:10.169362 [debug] [Thread-1 (]: On model.social_analytics.fct_daily_metrics: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.fct_daily_metrics"} */

  
    

  create  table "social_analytics"."analytics"."fct_daily_metrics__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    DATE(posted_at_utc) AS post_date,
    COUNT(*) AS total_posts,
    SUM(like_count) AS total_likes,
    SUM(comment_count) AS total_comments,
    SUM(share_count) AS total_shares,
    SUM(engagement_score) AS total_engagement
FROM "social_analytics"."analytics"."stg_posts"
GROUP BY DATE(posted_at_utc)
ORDER BY post_date DESC
  );
  
[0m14:32:10.187860 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.017 seconds
[0m14:32:10.197191 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.fct_daily_metrics"
[0m14:32:10.198694 [debug] [Thread-1 (]: On model.social_analytics.fct_daily_metrics: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.fct_daily_metrics"} */
alter table "social_analytics"."analytics"."fct_daily_metrics" rename to "fct_daily_metrics__dbt_backup"
[0m14:32:10.200325 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:32:10.204377 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.fct_daily_metrics"
[0m14:32:10.205580 [debug] [Thread-1 (]: On model.social_analytics.fct_daily_metrics: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.fct_daily_metrics"} */
alter table "social_analytics"."analytics"."fct_daily_metrics__dbt_tmp" rename to "fct_daily_metrics"
[0m14:32:10.207460 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:32:10.211586 [debug] [Thread-1 (]: On model.social_analytics.fct_daily_metrics: COMMIT
[0m14:32:10.212907 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.fct_daily_metrics"
[0m14:32:10.214022 [debug] [Thread-1 (]: On model.social_analytics.fct_daily_metrics: COMMIT
[0m14:32:10.216862 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m14:32:10.220740 [debug] [Thread-1 (]: Applying DROP to: "social_analytics"."analytics"."fct_daily_metrics__dbt_backup"
[0m14:32:10.224499 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.fct_daily_metrics"
[0m14:32:10.225744 [debug] [Thread-1 (]: On model.social_analytics.fct_daily_metrics: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.fct_daily_metrics"} */
drop table if exists "social_analytics"."analytics"."fct_daily_metrics__dbt_backup" cascade
[0m14:32:10.229987 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m14:32:10.232355 [debug] [Thread-1 (]: On model.social_analytics.fct_daily_metrics: Close
[0m14:32:10.233773 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'de3a18ec-8370-4742-adbc-b652c469acbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea10bb81d0>]}
[0m14:32:10.235338 [info ] [Thread-1 (]: 2 of 3 OK created sql table model analytics.fct_daily_metrics .................. [[32mSELECT 2[0m in 0.19s]
[0m14:32:10.236987 [debug] [Thread-1 (]: Finished running node model.social_analytics.fct_daily_metrics
[0m14:32:10.238165 [debug] [Thread-1 (]: Began running node model.social_analytics.top_posts
[0m14:32:10.239568 [info ] [Thread-1 (]: 3 of 3 START sql table model analytics.top_posts ............................... [RUN]
[0m14:32:10.240932 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.social_analytics.fct_daily_metrics, now model.social_analytics.top_posts)
[0m14:32:10.242021 [debug] [Thread-1 (]: Began compiling node model.social_analytics.top_posts
[0m14:32:10.246232 [debug] [Thread-1 (]: Writing injected SQL for node "model.social_analytics.top_posts"
[0m14:32:10.254679 [debug] [Thread-1 (]: Began executing node model.social_analytics.top_posts
[0m14:32:10.260038 [debug] [Thread-1 (]: Writing runtime sql for node "model.social_analytics.top_posts"
[0m14:32:10.269014 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.top_posts"
[0m14:32:10.270285 [debug] [Thread-1 (]: On model.social_analytics.top_posts: BEGIN
[0m14:32:10.271452 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:32:10.278803 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m14:32:10.280321 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.top_posts"
[0m14:32:10.282202 [debug] [Thread-1 (]: On model.social_analytics.top_posts: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.top_posts"} */

  
    

  create  table "social_analytics"."analytics"."top_posts__dbt_tmp"
  
  
    as
  
  (
    

WITH ranked_posts AS (
    SELECT
        DATE(posted_at_utc) AS post_date,
        platform,
        author_name,
        content_text,
        content_url,
        like_count,
        comment_count,
        share_count,
        engagement_score,
        ROW_NUMBER() OVER (
            PARTITION BY DATE(posted_at_utc), platform
            ORDER BY engagement_score DESC
        ) AS rank
    FROM "social_analytics"."analytics"."stg_posts"
)
SELECT
    post_date,
    platform,
    author_name,
    content_text,
    content_url,
    like_count,
    comment_count,
    share_count,
    engagement_score,
    rank
FROM ranked_posts
WHERE rank <= 10
ORDER BY post_date DESC, platform, rank
  );
  
[0m14:32:10.285521 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "content_url" does not exist
LINE 20:         content_url,
                 ^

[0m14:32:10.286922 [debug] [Thread-1 (]: On model.social_analytics.top_posts: ROLLBACK
[0m14:32:10.288974 [debug] [Thread-1 (]: On model.social_analytics.top_posts: Close
[0m14:32:10.298602 [debug] [Thread-1 (]: Database Error in model top_posts (models/top_posts.sql)
  column "content_url" does not exist
  LINE 20:         content_url,
                   ^
  compiled code at target/run/social_analytics/models/top_posts.sql
[0m14:32:10.300367 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'de3a18ec-8370-4742-adbc-b652c469acbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea0f11f410>]}
[0m14:32:10.302030 [error] [Thread-1 (]: 3 of 3 ERROR creating sql table model analytics.top_posts ...................... [[31mERROR[0m in 0.06s]
[0m14:32:10.303771 [debug] [Thread-1 (]: Finished running node model.social_analytics.top_posts
[0m14:32:10.305143 [debug] [Thread-4 (]: Marking all children of 'model.social_analytics.top_posts' to be skipped because of status 'error'.  Reason: Database Error in model top_posts (models/top_posts.sql)
  column "content_url" does not exist
  LINE 20:         content_url,
                   ^
  compiled code at target/run/social_analytics/models/top_posts.sql.
[0m14:32:10.308179 [debug] [MainThread]: Using postgres connection "master"
[0m14:32:10.309268 [debug] [MainThread]: On master: BEGIN
[0m14:32:10.310233 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:32:10.316868 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m14:32:10.318085 [debug] [MainThread]: On master: COMMIT
[0m14:32:10.319218 [debug] [MainThread]: Using postgres connection "master"
[0m14:32:10.320472 [debug] [MainThread]: On master: COMMIT
[0m14:32:10.321860 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:32:10.323037 [debug] [MainThread]: On master: Close
[0m14:32:10.324251 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:32:10.325366 [debug] [MainThread]: Connection 'model.social_analytics.top_posts' was properly closed.
[0m14:32:10.326566 [info ] [MainThread]: 
[0m14:32:10.327818 [info ] [MainThread]: Finished running 2 table models, 1 view model in 0 hours 0 minutes and 0.57 seconds (0.57s).
[0m14:32:10.329768 [debug] [MainThread]: Command end result
[0m14:32:10.370693 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt_project/target/manifest.json
[0m14:32:10.377081 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt_project/target/semantic_manifest.json
[0m14:32:10.388436 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt_project/target/run_results.json
[0m14:32:10.389734 [info ] [MainThread]: 
[0m14:32:10.391438 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:32:10.392827 [info ] [MainThread]: 
[0m14:32:10.394039 [error] [MainThread]: [31mFailure in model top_posts (models/top_posts.sql)[0m
[0m14:32:10.395227 [error] [MainThread]:   Database Error in model top_posts (models/top_posts.sql)
  column "content_url" does not exist
  LINE 20:         content_url,
                   ^
  compiled code at target/run/social_analytics/models/top_posts.sql
[0m14:32:10.396371 [info ] [MainThread]: 
[0m14:32:10.397670 [info ] [MainThread]:   compiled code at target/compiled/social_analytics/models/top_posts.sql
[0m14:32:10.398813 [info ] [MainThread]: 
[0m14:32:10.400026 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=3
[0m14:32:10.402650 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.3940642, "process_in_blocks": "79960", "process_kernel_time": 0.436275, "process_mem_max_rss": "126264", "process_out_blocks": "8", "process_user_time": 2.491616}
[0m14:32:10.404501 [debug] [MainThread]: Command `dbt run` failed at 14:32:10.404312 after 1.40 seconds
[0m14:32:10.405985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea1427fe50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea0cdebe90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea0f1eacd0>]}
[0m14:32:10.407299 [debug] [MainThread]: Flushing usage events
[0m14:32:11.442811 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:33:58.183101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6466f8a850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6467e3a850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6466f8add0>]}


============================== 14:33:58.190031 | 4a170bfd-0304-406c-b0dc-57feba2419bf ==============================
[0m14:33:58.190031 [info ] [MainThread]: Running with dbt=1.10.9
[0m14:33:58.191561 [debug] [MainThread]: running dbt with arguments {'invocation_command': 'dbt run', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'indirect_selection': 'eager', 'partial_parse': 'True', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'log_format': 'default', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_cache_events': 'False', 'quiet': 'False', 'use_colors': 'True', 'write_json': 'True', 'empty': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'fail_fast': 'False', 'static_parser': 'True', 'log_path': '/app/dbt_project/logs', 'profiles_dir': '/app', 'target_path': 'None'}
[0m14:33:58.398490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4a170bfd-0304-406c-b0dc-57feba2419bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6466f80590>]}
[0m14:33:58.457803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4a170bfd-0304-406c-b0dc-57feba2419bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6469b08e90>]}
[0m14:33:58.460355 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:33:58.543591 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m14:33:58.709906 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:33:58.711353 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:33:58.739771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4a170bfd-0304-406c-b0dc-57feba2419bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64657341d0>]}
[0m14:33:58.810793 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt_project/target/manifest.json
[0m14:33:58.825322 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt_project/target/semantic_manifest.json
[0m14:33:58.859246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4a170bfd-0304-406c-b0dc-57feba2419bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6465bc9a50>]}
[0m14:33:58.860656 [info ] [MainThread]: Found 3 models, 434 macros
[0m14:33:58.862159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4a170bfd-0304-406c-b0dc-57feba2419bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f646572a610>]}
[0m14:33:58.864955 [info ] [MainThread]: 
[0m14:33:58.866268 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:33:58.867570 [info ] [MainThread]: 
[0m14:33:58.869302 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:33:58.876532 [debug] [ThreadPool]: Acquiring new postgres connection 'list_social_analytics'
[0m14:33:58.930924 [debug] [ThreadPool]: Using postgres connection "list_social_analytics"
[0m14:33:58.932310 [debug] [ThreadPool]: On list_social_analytics: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "connection_name": "list_social_analytics"} */

    select distinct nspname from pg_namespace
  
[0m14:33:58.933486 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:33:58.951055 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.018 seconds
[0m14:33:58.953706 [debug] [ThreadPool]: On list_social_analytics: Close
[0m14:33:58.956567 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_social_analytics, now list_social_analytics_analytics)
[0m14:33:58.963165 [debug] [ThreadPool]: Using postgres connection "list_social_analytics_analytics"
[0m14:33:58.964381 [debug] [ThreadPool]: On list_social_analytics_analytics: BEGIN
[0m14:33:58.965519 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:33:58.972207 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m14:33:58.973601 [debug] [ThreadPool]: Using postgres connection "list_social_analytics_analytics"
[0m14:33:58.974479 [debug] [ThreadPool]: On list_social_analytics_analytics: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "connection_name": "list_social_analytics_analytics"} */
select
      'social_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'social_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'social_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m14:33:58.978256 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.003 seconds
[0m14:33:58.980480 [debug] [ThreadPool]: On list_social_analytics_analytics: ROLLBACK
[0m14:33:58.981724 [debug] [ThreadPool]: On list_social_analytics_analytics: Close
[0m14:33:58.987685 [debug] [MainThread]: Using postgres connection "master"
[0m14:33:58.988825 [debug] [MainThread]: On master: BEGIN
[0m14:33:58.989866 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:33:58.997373 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m14:33:58.998583 [debug] [MainThread]: Using postgres connection "master"
[0m14:33:58.999517 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:33:59.004946 [debug] [MainThread]: SQL status: SELECT 1 in 0.004 seconds
[0m14:33:59.007767 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4a170bfd-0304-406c-b0dc-57feba2419bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6466e99310>]}
[0m14:33:59.009195 [debug] [MainThread]: On master: ROLLBACK
[0m14:33:59.010371 [debug] [MainThread]: Using postgres connection "master"
[0m14:33:59.011221 [debug] [MainThread]: On master: BEGIN
[0m14:33:59.012393 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:33:59.013437 [debug] [MainThread]: On master: COMMIT
[0m14:33:59.014530 [debug] [MainThread]: Using postgres connection "master"
[0m14:33:59.015433 [debug] [MainThread]: On master: COMMIT
[0m14:33:59.016434 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:33:59.017570 [debug] [MainThread]: On master: Close
[0m14:33:59.024260 [debug] [Thread-1 (]: Began running node model.social_analytics.stg_posts
[0m14:33:59.025523 [info ] [Thread-1 (]: 1 of 3 START sql view model analytics.stg_posts ................................ [RUN]
[0m14:33:59.026894 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_social_analytics_analytics, now model.social_analytics.stg_posts)
[0m14:33:59.028002 [debug] [Thread-1 (]: Began compiling node model.social_analytics.stg_posts
[0m14:33:59.035905 [debug] [Thread-1 (]: Writing injected SQL for node "model.social_analytics.stg_posts"
[0m14:33:59.042964 [debug] [Thread-1 (]: Began executing node model.social_analytics.stg_posts
[0m14:33:59.077988 [debug] [Thread-1 (]: Writing runtime sql for node "model.social_analytics.stg_posts"
[0m14:33:59.085754 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.stg_posts"
[0m14:33:59.086786 [debug] [Thread-1 (]: On model.social_analytics.stg_posts: BEGIN
[0m14:33:59.087668 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:33:59.094800 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m14:33:59.096016 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.stg_posts"
[0m14:33:59.096928 [debug] [Thread-1 (]: On model.social_analytics.stg_posts: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.stg_posts"} */

  create view "social_analytics"."analytics"."stg_posts__dbt_tmp"
    
    
  as (
    

SELECT
    id,
    platform,
    author_name,
    content_text,
    like_count,
    comment_count,
    share_count,
    engagement_score,
    posted_at_utc,
    collected_at_utc
FROM public.posts
  );
[0m14:33:59.109729 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.012 seconds
[0m14:33:59.116844 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.stg_posts"
[0m14:33:59.118061 [debug] [Thread-1 (]: On model.social_analytics.stg_posts: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.stg_posts"} */
alter table "social_analytics"."analytics"."stg_posts" rename to "stg_posts__dbt_backup"
[0m14:33:59.119562 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:33:59.122983 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.stg_posts"
[0m14:33:59.124115 [debug] [Thread-1 (]: On model.social_analytics.stg_posts: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.stg_posts"} */
alter table "social_analytics"."analytics"."stg_posts__dbt_tmp" rename to "stg_posts"
[0m14:33:59.125442 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:33:59.142378 [debug] [Thread-1 (]: On model.social_analytics.stg_posts: COMMIT
[0m14:33:59.143842 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.stg_posts"
[0m14:33:59.145083 [debug] [Thread-1 (]: On model.social_analytics.stg_posts: COMMIT
[0m14:33:59.148259 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m14:33:59.215509 [debug] [Thread-1 (]: Applying DROP to: "social_analytics"."analytics"."stg_posts__dbt_backup"
[0m14:33:59.221654 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.stg_posts"
[0m14:33:59.222994 [debug] [Thread-1 (]: On model.social_analytics.stg_posts: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.stg_posts"} */
drop view if exists "social_analytics"."analytics"."stg_posts__dbt_backup" cascade
[0m14:33:59.229027 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.005 seconds
[0m14:33:59.232401 [debug] [Thread-1 (]: On model.social_analytics.stg_posts: Close
[0m14:33:59.235868 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a170bfd-0304-406c-b0dc-57feba2419bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64670e0d90>]}
[0m14:33:59.237908 [info ] [Thread-1 (]: 1 of 3 OK created sql view model analytics.stg_posts ........................... [[32mCREATE VIEW[0m in 0.21s]
[0m14:33:59.239408 [debug] [Thread-1 (]: Finished running node model.social_analytics.stg_posts
[0m14:33:59.241428 [debug] [Thread-1 (]: Began running node model.social_analytics.fct_daily_metrics
[0m14:33:59.242645 [info ] [Thread-1 (]: 2 of 3 START sql table model analytics.fct_daily_metrics ....................... [RUN]
[0m14:33:59.244243 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.social_analytics.stg_posts, now model.social_analytics.fct_daily_metrics)
[0m14:33:59.245679 [debug] [Thread-1 (]: Began compiling node model.social_analytics.fct_daily_metrics
[0m14:33:59.250423 [debug] [Thread-1 (]: Writing injected SQL for node "model.social_analytics.fct_daily_metrics"
[0m14:33:59.260874 [debug] [Thread-1 (]: Began executing node model.social_analytics.fct_daily_metrics
[0m14:33:59.285680 [debug] [Thread-1 (]: Writing runtime sql for node "model.social_analytics.fct_daily_metrics"
[0m14:33:59.294490 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.fct_daily_metrics"
[0m14:33:59.295735 [debug] [Thread-1 (]: On model.social_analytics.fct_daily_metrics: BEGIN
[0m14:33:59.296829 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:33:59.303394 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m14:33:59.304806 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.fct_daily_metrics"
[0m14:33:59.305833 [debug] [Thread-1 (]: On model.social_analytics.fct_daily_metrics: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.fct_daily_metrics"} */

  
    

  create  table "social_analytics"."analytics"."fct_daily_metrics__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    DATE(posted_at_utc) AS post_date,
    COUNT(*) AS total_posts,
    SUM(like_count) AS total_likes,
    SUM(comment_count) AS total_comments,
    SUM(share_count) AS total_shares,
    SUM(engagement_score) AS total_engagement
FROM "social_analytics"."analytics"."stg_posts"
GROUP BY DATE(posted_at_utc)
ORDER BY post_date DESC
  );
  
[0m14:33:59.315828 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.009 seconds
[0m14:33:59.323188 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.fct_daily_metrics"
[0m14:33:59.324480 [debug] [Thread-1 (]: On model.social_analytics.fct_daily_metrics: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.fct_daily_metrics"} */
alter table "social_analytics"."analytics"."fct_daily_metrics" rename to "fct_daily_metrics__dbt_backup"
[0m14:33:59.325911 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:33:59.329644 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.fct_daily_metrics"
[0m14:33:59.330911 [debug] [Thread-1 (]: On model.social_analytics.fct_daily_metrics: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.fct_daily_metrics"} */
alter table "social_analytics"."analytics"."fct_daily_metrics__dbt_tmp" rename to "fct_daily_metrics"
[0m14:33:59.332513 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:33:59.334620 [debug] [Thread-1 (]: On model.social_analytics.fct_daily_metrics: COMMIT
[0m14:33:59.335707 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.fct_daily_metrics"
[0m14:33:59.336661 [debug] [Thread-1 (]: On model.social_analytics.fct_daily_metrics: COMMIT
[0m14:33:59.339625 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m14:33:59.342914 [debug] [Thread-1 (]: Applying DROP to: "social_analytics"."analytics"."fct_daily_metrics__dbt_backup"
[0m14:33:59.346630 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.fct_daily_metrics"
[0m14:33:59.347767 [debug] [Thread-1 (]: On model.social_analytics.fct_daily_metrics: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.fct_daily_metrics"} */
drop table if exists "social_analytics"."analytics"."fct_daily_metrics__dbt_backup" cascade
[0m14:33:59.352001 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m14:33:59.354079 [debug] [Thread-1 (]: On model.social_analytics.fct_daily_metrics: Close
[0m14:33:59.355338 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a170bfd-0304-406c-b0dc-57feba2419bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f646704a090>]}
[0m14:33:59.356819 [info ] [Thread-1 (]: 2 of 3 OK created sql table model analytics.fct_daily_metrics .................. [[32mSELECT 2[0m in 0.11s]
[0m14:33:59.358509 [debug] [Thread-1 (]: Finished running node model.social_analytics.fct_daily_metrics
[0m14:33:59.359682 [debug] [Thread-1 (]: Began running node model.social_analytics.top_posts
[0m14:33:59.360696 [info ] [Thread-1 (]: 3 of 3 START sql table model analytics.top_posts ............................... [RUN]
[0m14:33:59.361894 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.social_analytics.fct_daily_metrics, now model.social_analytics.top_posts)
[0m14:33:59.362857 [debug] [Thread-1 (]: Began compiling node model.social_analytics.top_posts
[0m14:33:59.366594 [debug] [Thread-1 (]: Writing injected SQL for node "model.social_analytics.top_posts"
[0m14:33:59.373855 [debug] [Thread-1 (]: Began executing node model.social_analytics.top_posts
[0m14:33:59.378589 [debug] [Thread-1 (]: Writing runtime sql for node "model.social_analytics.top_posts"
[0m14:33:59.385714 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.top_posts"
[0m14:33:59.386690 [debug] [Thread-1 (]: On model.social_analytics.top_posts: BEGIN
[0m14:33:59.387545 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:33:59.395112 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m14:33:59.396562 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.top_posts"
[0m14:33:59.397633 [debug] [Thread-1 (]: On model.social_analytics.top_posts: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.top_posts"} */

  
    

  create  table "social_analytics"."analytics"."top_posts__dbt_tmp"
  
  
    as
  
  (
    

WITH ranked_posts AS (
    SELECT
        DATE(posted_at_utc) AS post_date,
        platform,
        author_name,
        content_text,
        content_url,
        like_count,
        comment_count,
        share_count,
        engagement_score,
        ROW_NUMBER() OVER (
            PARTITION BY DATE(posted_at_utc), platform
            ORDER BY engagement_score DESC
        ) AS rank
    FROM "social_analytics"."analytics"."stg_posts"
)
SELECT
    post_date,
    platform,
    author_name,
    content_text,
    content_url,
    like_count,
    comment_count,
    share_count,
    engagement_score,
    rank
FROM ranked_posts
WHERE rank <= 10
ORDER BY post_date DESC, platform, rank
  );
  
[0m14:33:59.400445 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "content_url" does not exist
LINE 20:         content_url,
                 ^

[0m14:33:59.401958 [debug] [Thread-1 (]: On model.social_analytics.top_posts: ROLLBACK
[0m14:33:59.403135 [debug] [Thread-1 (]: On model.social_analytics.top_posts: Close
[0m14:33:59.410492 [debug] [Thread-1 (]: Database Error in model top_posts (models/top_posts.sql)
  column "content_url" does not exist
  LINE 20:         content_url,
                   ^
  compiled code at target/run/social_analytics/models/top_posts.sql
[0m14:33:59.411774 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4a170bfd-0304-406c-b0dc-57feba2419bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6464215dd0>]}
[0m14:33:59.413558 [error] [Thread-1 (]: 3 of 3 ERROR creating sql table model analytics.top_posts ...................... [[31mERROR[0m in 0.05s]
[0m14:33:59.415211 [debug] [Thread-1 (]: Finished running node model.social_analytics.top_posts
[0m14:33:59.416451 [debug] [Thread-4 (]: Marking all children of 'model.social_analytics.top_posts' to be skipped because of status 'error'.  Reason: Database Error in model top_posts (models/top_posts.sql)
  column "content_url" does not exist
  LINE 20:         content_url,
                   ^
  compiled code at target/run/social_analytics/models/top_posts.sql.
[0m14:33:59.418949 [debug] [MainThread]: Using postgres connection "master"
[0m14:33:59.420078 [debug] [MainThread]: On master: BEGIN
[0m14:33:59.421379 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:33:59.428368 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m14:33:59.429857 [debug] [MainThread]: On master: COMMIT
[0m14:33:59.430828 [debug] [MainThread]: Using postgres connection "master"
[0m14:33:59.431670 [debug] [MainThread]: On master: COMMIT
[0m14:33:59.432669 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:33:59.433768 [debug] [MainThread]: On master: Close
[0m14:33:59.435196 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:33:59.436329 [debug] [MainThread]: Connection 'model.social_analytics.top_posts' was properly closed.
[0m14:33:59.437540 [info ] [MainThread]: 
[0m14:33:59.438614 [info ] [MainThread]: Finished running 2 table models, 1 view model in 0 hours 0 minutes and 0.57 seconds (0.57s).
[0m14:33:59.440480 [debug] [MainThread]: Command end result
[0m14:33:59.476552 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt_project/target/manifest.json
[0m14:33:59.482768 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt_project/target/semantic_manifest.json
[0m14:33:59.494919 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt_project/target/run_results.json
[0m14:33:59.496430 [info ] [MainThread]: 
[0m14:33:59.498047 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:33:59.499750 [info ] [MainThread]: 
[0m14:33:59.501303 [error] [MainThread]: [31mFailure in model top_posts (models/top_posts.sql)[0m
[0m14:33:59.502656 [error] [MainThread]:   Database Error in model top_posts (models/top_posts.sql)
  column "content_url" does not exist
  LINE 20:         content_url,
                   ^
  compiled code at target/run/social_analytics/models/top_posts.sql
[0m14:33:59.503927 [info ] [MainThread]: 
[0m14:33:59.505345 [info ] [MainThread]:   compiled code at target/compiled/social_analytics/models/top_posts.sql
[0m14:33:59.506529 [info ] [MainThread]: 
[0m14:33:59.507701 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=3
[0m14:33:59.510131 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.3924568, "process_in_blocks": "95080", "process_kernel_time": 0.454325, "process_mem_max_rss": "124664", "process_out_blocks": "8", "process_user_time": 2.463454}
[0m14:33:59.511463 [debug] [MainThread]: Command `dbt run` failed at 14:33:59.511326 after 1.39 seconds
[0m14:33:59.512853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64642dd150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6466fef6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6466fef3d0>]}
[0m14:33:59.514226 [debug] [MainThread]: Flushing usage events
[0m14:34:02.442820 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:35:38.439077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2442845d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe244287910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe244287d50>]}


============================== 14:35:38.445966 | 30e53bb3-31a5-4922-a5e5-a4c9627d3a19 ==============================
[0m14:35:38.445966 [info ] [MainThread]: Running with dbt=1.10.9
[0m14:35:38.447652 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'printer_width': '80', 'log_path': '/app/dbt_project/logs', 'write_json': 'True', 'debug': 'False', 'partial_parse': 'True', 'target_path': 'None', 'empty': 'False', 'quiet': 'False', 'invocation_command': 'dbt run', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'static_parser': 'True', 'indirect_selection': 'eager', 'use_colors': 'True', 'version_check': 'True', 'no_print': 'None', 'warn_error': 'None', 'log_cache_events': 'False', 'profiles_dir': '/app', 'log_format': 'default'}
[0m14:35:38.642045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '30e53bb3-31a5-4922-a5e5-a4c9627d3a19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe243900910>]}
[0m14:35:38.700519 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '30e53bb3-31a5-4922-a5e5-a4c9627d3a19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe246e60d50>]}
[0m14:35:38.704020 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:35:38.792084 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m14:35:38.966082 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:35:38.967509 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:35:38.997939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '30e53bb3-31a5-4922-a5e5-a4c9627d3a19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe242d26850>]}
[0m14:35:39.065965 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt_project/target/manifest.json
[0m14:35:39.072959 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt_project/target/semantic_manifest.json
[0m14:35:39.109581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '30e53bb3-31a5-4922-a5e5-a4c9627d3a19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe242943650>]}
[0m14:35:39.111103 [info ] [MainThread]: Found 3 models, 434 macros
[0m14:35:39.112381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '30e53bb3-31a5-4922-a5e5-a4c9627d3a19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2431fab10>]}
[0m14:35:39.115289 [info ] [MainThread]: 
[0m14:35:39.116558 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:35:39.117746 [info ] [MainThread]: 
[0m14:35:39.119087 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:35:39.125849 [debug] [ThreadPool]: Acquiring new postgres connection 'list_social_analytics'
[0m14:35:39.181183 [debug] [ThreadPool]: Using postgres connection "list_social_analytics"
[0m14:35:39.182654 [debug] [ThreadPool]: On list_social_analytics: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "connection_name": "list_social_analytics"} */

    select distinct nspname from pg_namespace
  
[0m14:35:39.183739 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:35:39.200021 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.016 seconds
[0m14:35:39.202782 [debug] [ThreadPool]: On list_social_analytics: Close
[0m14:35:39.205636 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_social_analytics, now list_social_analytics_analytics)
[0m14:35:39.212725 [debug] [ThreadPool]: Using postgres connection "list_social_analytics_analytics"
[0m14:35:39.214008 [debug] [ThreadPool]: On list_social_analytics_analytics: BEGIN
[0m14:35:39.215373 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:35:39.221841 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m14:35:39.223391 [debug] [ThreadPool]: Using postgres connection "list_social_analytics_analytics"
[0m14:35:39.224442 [debug] [ThreadPool]: On list_social_analytics_analytics: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "connection_name": "list_social_analytics_analytics"} */
select
      'social_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'social_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'social_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m14:35:39.228336 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.003 seconds
[0m14:35:39.230788 [debug] [ThreadPool]: On list_social_analytics_analytics: ROLLBACK
[0m14:35:39.232162 [debug] [ThreadPool]: On list_social_analytics_analytics: Close
[0m14:35:39.238724 [debug] [MainThread]: Using postgres connection "master"
[0m14:35:39.240034 [debug] [MainThread]: On master: BEGIN
[0m14:35:39.240896 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:35:39.248373 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m14:35:39.249699 [debug] [MainThread]: Using postgres connection "master"
[0m14:35:39.250835 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:35:39.255969 [debug] [MainThread]: SQL status: SELECT 1 in 0.004 seconds
[0m14:35:39.258179 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '30e53bb3-31a5-4922-a5e5-a4c9627d3a19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe24427fe50>]}
[0m14:35:39.259306 [debug] [MainThread]: On master: ROLLBACK
[0m14:35:39.260336 [debug] [MainThread]: Using postgres connection "master"
[0m14:35:39.261109 [debug] [MainThread]: On master: BEGIN
[0m14:35:39.262318 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:35:39.263408 [debug] [MainThread]: On master: COMMIT
[0m14:35:39.264322 [debug] [MainThread]: Using postgres connection "master"
[0m14:35:39.265077 [debug] [MainThread]: On master: COMMIT
[0m14:35:39.266013 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:35:39.266828 [debug] [MainThread]: On master: Close
[0m14:35:39.274722 [debug] [Thread-1 (]: Began running node model.social_analytics.stg_posts
[0m14:35:39.276056 [info ] [Thread-1 (]: 1 of 3 START sql view model analytics.stg_posts ................................ [RUN]
[0m14:35:39.277656 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_social_analytics_analytics, now model.social_analytics.stg_posts)
[0m14:35:39.278678 [debug] [Thread-1 (]: Began compiling node model.social_analytics.stg_posts
[0m14:35:39.287371 [debug] [Thread-1 (]: Writing injected SQL for node "model.social_analytics.stg_posts"
[0m14:35:39.295329 [debug] [Thread-1 (]: Began executing node model.social_analytics.stg_posts
[0m14:35:39.331797 [debug] [Thread-1 (]: Writing runtime sql for node "model.social_analytics.stg_posts"
[0m14:35:39.340287 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.stg_posts"
[0m14:35:39.341498 [debug] [Thread-1 (]: On model.social_analytics.stg_posts: BEGIN
[0m14:35:39.342487 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:35:39.348505 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m14:35:39.349634 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.stg_posts"
[0m14:35:39.350622 [debug] [Thread-1 (]: On model.social_analytics.stg_posts: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.stg_posts"} */

  create view "social_analytics"."analytics"."stg_posts__dbt_tmp"
    
    
  as (
    

SELECT
    id,
    platform,
    author_name,
    content_text,
    like_count,
    comment_count,
    share_count,
    engagement_score,
    posted_at_utc,
    collected_at_utc
FROM public.posts
  );
[0m14:35:39.354217 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m14:35:39.361265 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.stg_posts"
[0m14:35:39.362391 [debug] [Thread-1 (]: On model.social_analytics.stg_posts: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.stg_posts"} */
alter table "social_analytics"."analytics"."stg_posts" rename to "stg_posts__dbt_backup"
[0m14:35:39.363713 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:35:39.367169 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.stg_posts"
[0m14:35:39.368272 [debug] [Thread-1 (]: On model.social_analytics.stg_posts: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.stg_posts"} */
alter table "social_analytics"."analytics"."stg_posts__dbt_tmp" rename to "stg_posts"
[0m14:35:39.369510 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:35:39.386095 [debug] [Thread-1 (]: On model.social_analytics.stg_posts: COMMIT
[0m14:35:39.387517 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.stg_posts"
[0m14:35:39.388700 [debug] [Thread-1 (]: On model.social_analytics.stg_posts: COMMIT
[0m14:35:39.391944 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m14:35:39.466207 [debug] [Thread-1 (]: Applying DROP to: "social_analytics"."analytics"."stg_posts__dbt_backup"
[0m14:35:39.472557 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.stg_posts"
[0m14:35:39.473874 [debug] [Thread-1 (]: On model.social_analytics.stg_posts: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.stg_posts"} */
drop view if exists "social_analytics"."analytics"."stg_posts__dbt_backup" cascade
[0m14:35:39.478929 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.004 seconds
[0m14:35:39.481883 [debug] [Thread-1 (]: On model.social_analytics.stg_posts: Close
[0m14:35:39.484737 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '30e53bb3-31a5-4922-a5e5-a4c9627d3a19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe24437f450>]}
[0m14:35:39.486289 [info ] [Thread-1 (]: 1 of 3 OK created sql view model analytics.stg_posts ........................... [[32mCREATE VIEW[0m in 0.21s]
[0m14:35:39.487586 [debug] [Thread-1 (]: Finished running node model.social_analytics.stg_posts
[0m14:35:39.489491 [debug] [Thread-1 (]: Began running node model.social_analytics.fct_daily_metrics
[0m14:35:39.490566 [info ] [Thread-1 (]: 2 of 3 START sql table model analytics.fct_daily_metrics ....................... [RUN]
[0m14:35:39.491971 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.social_analytics.stg_posts, now model.social_analytics.fct_daily_metrics)
[0m14:35:39.493501 [debug] [Thread-1 (]: Began compiling node model.social_analytics.fct_daily_metrics
[0m14:35:39.498275 [debug] [Thread-1 (]: Writing injected SQL for node "model.social_analytics.fct_daily_metrics"
[0m14:35:39.506090 [debug] [Thread-1 (]: Began executing node model.social_analytics.fct_daily_metrics
[0m14:35:39.528691 [debug] [Thread-1 (]: Writing runtime sql for node "model.social_analytics.fct_daily_metrics"
[0m14:35:39.537377 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.fct_daily_metrics"
[0m14:35:39.538443 [debug] [Thread-1 (]: On model.social_analytics.fct_daily_metrics: BEGIN
[0m14:35:39.539358 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:35:39.545885 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m14:35:39.547193 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.fct_daily_metrics"
[0m14:35:39.548224 [debug] [Thread-1 (]: On model.social_analytics.fct_daily_metrics: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.fct_daily_metrics"} */

  
    

  create  table "social_analytics"."analytics"."fct_daily_metrics__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    DATE(posted_at_utc) AS post_date,
    COUNT(*) AS total_posts,
    SUM(like_count) AS total_likes,
    SUM(comment_count) AS total_comments,
    SUM(share_count) AS total_shares,
    SUM(engagement_score) AS total_engagement
FROM "social_analytics"."analytics"."stg_posts"
GROUP BY DATE(posted_at_utc)
ORDER BY post_date DESC
  );
  
[0m14:35:39.557935 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.009 seconds
[0m14:35:39.565452 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.fct_daily_metrics"
[0m14:35:39.566654 [debug] [Thread-1 (]: On model.social_analytics.fct_daily_metrics: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.fct_daily_metrics"} */
alter table "social_analytics"."analytics"."fct_daily_metrics" rename to "fct_daily_metrics__dbt_backup"
[0m14:35:39.568022 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:35:39.571776 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.fct_daily_metrics"
[0m14:35:39.572818 [debug] [Thread-1 (]: On model.social_analytics.fct_daily_metrics: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.fct_daily_metrics"} */
alter table "social_analytics"."analytics"."fct_daily_metrics__dbt_tmp" rename to "fct_daily_metrics"
[0m14:35:39.574187 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:35:39.576046 [debug] [Thread-1 (]: On model.social_analytics.fct_daily_metrics: COMMIT
[0m14:35:39.577078 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.fct_daily_metrics"
[0m14:35:39.578004 [debug] [Thread-1 (]: On model.social_analytics.fct_daily_metrics: COMMIT
[0m14:35:39.580577 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m14:35:39.583711 [debug] [Thread-1 (]: Applying DROP to: "social_analytics"."analytics"."fct_daily_metrics__dbt_backup"
[0m14:35:39.586863 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.fct_daily_metrics"
[0m14:35:39.587819 [debug] [Thread-1 (]: On model.social_analytics.fct_daily_metrics: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.fct_daily_metrics"} */
drop table if exists "social_analytics"."analytics"."fct_daily_metrics__dbt_backup" cascade
[0m14:35:39.592446 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m14:35:39.594815 [debug] [Thread-1 (]: On model.social_analytics.fct_daily_metrics: Close
[0m14:35:39.596192 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '30e53bb3-31a5-4922-a5e5-a4c9627d3a19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe244b1c910>]}
[0m14:35:39.597736 [info ] [Thread-1 (]: 2 of 3 OK created sql table model analytics.fct_daily_metrics .................. [[32mSELECT 2[0m in 0.10s]
[0m14:35:39.599332 [debug] [Thread-1 (]: Finished running node model.social_analytics.fct_daily_metrics
[0m14:35:39.600594 [debug] [Thread-1 (]: Began running node model.social_analytics.top_posts
[0m14:35:39.601830 [info ] [Thread-1 (]: 3 of 3 START sql table model analytics.top_posts ............................... [RUN]
[0m14:35:39.603195 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.social_analytics.fct_daily_metrics, now model.social_analytics.top_posts)
[0m14:35:39.604244 [debug] [Thread-1 (]: Began compiling node model.social_analytics.top_posts
[0m14:35:39.608264 [debug] [Thread-1 (]: Writing injected SQL for node "model.social_analytics.top_posts"
[0m14:35:39.615760 [debug] [Thread-1 (]: Began executing node model.social_analytics.top_posts
[0m14:35:39.620866 [debug] [Thread-1 (]: Writing runtime sql for node "model.social_analytics.top_posts"
[0m14:35:39.628806 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.top_posts"
[0m14:35:39.630163 [debug] [Thread-1 (]: On model.social_analytics.top_posts: BEGIN
[0m14:35:39.631072 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:35:39.637726 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m14:35:39.639197 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.top_posts"
[0m14:35:39.640245 [debug] [Thread-1 (]: On model.social_analytics.top_posts: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.top_posts"} */

  
    

  create  table "social_analytics"."analytics"."top_posts__dbt_tmp"
  
  
    as
  
  (
    

WITH ranked_posts AS (
    SELECT
        DATE(posted_at_utc) AS post_date,
        platform,
        author_name,
        content_text,
        content_url,
        like_count,
        comment_count,
        share_count,
        engagement_score,
        ROW_NUMBER() OVER (
            PARTITION BY DATE(posted_at_utc), platform
            ORDER BY engagement_score DESC
        ) AS rank
    FROM "social_analytics"."analytics"."stg_posts"
)
SELECT
    post_date,
    platform,
    author_name,
    content_text,
    content_url,
    like_count,
    comment_count,
    share_count,
    engagement_score,
    rank
FROM ranked_posts
WHERE rank <= 10
ORDER BY post_date DESC, platform, rank
  );
  
[0m14:35:39.643879 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "content_url" does not exist
LINE 20:         content_url,
                 ^

[0m14:35:39.645227 [debug] [Thread-1 (]: On model.social_analytics.top_posts: ROLLBACK
[0m14:35:39.646509 [debug] [Thread-1 (]: On model.social_analytics.top_posts: Close
[0m14:35:39.653631 [debug] [Thread-1 (]: Database Error in model top_posts (models/top_posts.sql)
  column "content_url" does not exist
  LINE 20:         content_url,
                   ^
  compiled code at target/run/social_analytics/models/top_posts.sql
[0m14:35:39.655302 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '30e53bb3-31a5-4922-a5e5-a4c9627d3a19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2414ac2d0>]}
[0m14:35:39.656650 [error] [Thread-1 (]: 3 of 3 ERROR creating sql table model analytics.top_posts ...................... [[31mERROR[0m in 0.05s]
[0m14:35:39.658101 [debug] [Thread-1 (]: Finished running node model.social_analytics.top_posts
[0m14:35:39.659315 [debug] [Thread-4 (]: Marking all children of 'model.social_analytics.top_posts' to be skipped because of status 'error'.  Reason: Database Error in model top_posts (models/top_posts.sql)
  column "content_url" does not exist
  LINE 20:         content_url,
                   ^
  compiled code at target/run/social_analytics/models/top_posts.sql.
[0m14:35:39.662128 [debug] [MainThread]: Using postgres connection "master"
[0m14:35:39.663128 [debug] [MainThread]: On master: BEGIN
[0m14:35:39.664047 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:35:39.670686 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m14:35:39.671859 [debug] [MainThread]: On master: COMMIT
[0m14:35:39.672696 [debug] [MainThread]: Using postgres connection "master"
[0m14:35:39.673435 [debug] [MainThread]: On master: COMMIT
[0m14:35:39.674405 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:35:39.675390 [debug] [MainThread]: On master: Close
[0m14:35:39.676351 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:35:39.677179 [debug] [MainThread]: Connection 'model.social_analytics.top_posts' was properly closed.
[0m14:35:39.678078 [info ] [MainThread]: 
[0m14:35:39.679236 [info ] [MainThread]: Finished running 2 table models, 1 view model in 0 hours 0 minutes and 0.56 seconds (0.56s).
[0m14:35:39.681098 [debug] [MainThread]: Command end result
[0m14:35:39.716962 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt_project/target/manifest.json
[0m14:35:39.723391 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt_project/target/semantic_manifest.json
[0m14:35:39.733431 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt_project/target/run_results.json
[0m14:35:39.734429 [info ] [MainThread]: 
[0m14:35:39.735605 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:35:39.736934 [info ] [MainThread]: 
[0m14:35:39.738088 [error] [MainThread]: [31mFailure in model top_posts (models/top_posts.sql)[0m
[0m14:35:39.739250 [error] [MainThread]:   Database Error in model top_posts (models/top_posts.sql)
  column "content_url" does not exist
  LINE 20:         content_url,
                   ^
  compiled code at target/run/social_analytics/models/top_posts.sql
[0m14:35:39.740422 [info ] [MainThread]: 
[0m14:35:39.741872 [info ] [MainThread]:   compiled code at target/compiled/social_analytics/models/top_posts.sql
[0m14:35:39.743029 [info ] [MainThread]: 
[0m14:35:39.744132 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=3
[0m14:35:39.746612 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.371687, "process_in_blocks": "95080", "process_kernel_time": 0.346108, "process_mem_max_rss": "126380", "process_out_blocks": "8", "process_user_time": 2.595811}
[0m14:35:39.747816 [debug] [MainThread]: Command `dbt run` failed at 14:35:39.747652 after 1.37 seconds
[0m14:35:39.748940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe248c25750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe2415131d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe24428fb10>]}
[0m14:35:39.749811 [debug] [MainThread]: Flushing usage events
[0m14:35:40.747347 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:36:54.564958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5cb4859d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5ca0c2e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5ca355650>]}


============================== 14:36:54.572650 | e9869327-c089-48bf-b6ca-d81e5cb9911b ==============================
[0m14:36:54.572650 [info ] [MainThread]: Running with dbt=1.10.9
[0m14:36:54.574427 [debug] [MainThread]: running dbt with arguments {'warn_error': 'None', 'printer_width': '80', 'debug': 'False', 'invocation_command': 'dbt run --full-refresh', 'no_print': 'None', 'partial_parse': 'True', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'log_path': '/app/dbt_project/logs', 'version_check': 'True', 'log_format': 'default', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'quiet': 'False', 'target_path': 'None', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'introspect': 'True', 'profiles_dir': '/app', 'empty': 'False', 'fail_fast': 'False'}
[0m14:36:54.799389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e9869327-c089-48bf-b6ca-d81e5cb9911b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5c9733190>]}
[0m14:36:54.857756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e9869327-c089-48bf-b6ca-d81e5cb9911b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5ccc41c50>]}
[0m14:36:54.861337 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:36:54.946333 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m14:36:55.104584 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:36:55.105971 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:36:55.134026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e9869327-c089-48bf-b6ca-d81e5cb9911b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5ca10b5d0>]}
[0m14:36:55.201402 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt_project/target/manifest.json
[0m14:36:55.208827 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt_project/target/semantic_manifest.json
[0m14:36:55.243270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e9869327-c089-48bf-b6ca-d81e5cb9911b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5c8702390>]}
[0m14:36:55.244817 [info ] [MainThread]: Found 3 models, 434 macros
[0m14:36:55.246166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e9869327-c089-48bf-b6ca-d81e5cb9911b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5c8b27dd0>]}
[0m14:36:55.248972 [info ] [MainThread]: 
[0m14:36:55.250394 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:36:55.252004 [info ] [MainThread]: 
[0m14:36:55.253597 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:36:55.259495 [debug] [ThreadPool]: Acquiring new postgres connection 'list_social_analytics'
[0m14:36:55.310020 [debug] [ThreadPool]: Using postgres connection "list_social_analytics"
[0m14:36:55.311334 [debug] [ThreadPool]: On list_social_analytics: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "connection_name": "list_social_analytics"} */

    select distinct nspname from pg_namespace
  
[0m14:36:55.312411 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:36:55.334576 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.022 seconds
[0m14:36:55.336822 [debug] [ThreadPool]: On list_social_analytics: Close
[0m14:36:55.339484 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_social_analytics, now list_social_analytics_analytics)
[0m14:36:55.346252 [debug] [ThreadPool]: Using postgres connection "list_social_analytics_analytics"
[0m14:36:55.347502 [debug] [ThreadPool]: On list_social_analytics_analytics: BEGIN
[0m14:36:55.348495 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:36:55.354296 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m14:36:55.355652 [debug] [ThreadPool]: Using postgres connection "list_social_analytics_analytics"
[0m14:36:55.356687 [debug] [ThreadPool]: On list_social_analytics_analytics: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "connection_name": "list_social_analytics_analytics"} */
select
      'social_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'social_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'social_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m14:36:55.361433 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.004 seconds
[0m14:36:55.363795 [debug] [ThreadPool]: On list_social_analytics_analytics: ROLLBACK
[0m14:36:55.365074 [debug] [ThreadPool]: On list_social_analytics_analytics: Close
[0m14:36:55.370600 [debug] [MainThread]: Using postgres connection "master"
[0m14:36:55.371650 [debug] [MainThread]: On master: BEGIN
[0m14:36:55.372507 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:36:55.378693 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m14:36:55.379876 [debug] [MainThread]: Using postgres connection "master"
[0m14:36:55.380788 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:36:55.386086 [debug] [MainThread]: SQL status: SELECT 1 in 0.004 seconds
[0m14:36:55.388151 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e9869327-c089-48bf-b6ca-d81e5cb9911b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5ca0b8850>]}
[0m14:36:55.389304 [debug] [MainThread]: On master: ROLLBACK
[0m14:36:55.390683 [debug] [MainThread]: Using postgres connection "master"
[0m14:36:55.392031 [debug] [MainThread]: On master: BEGIN
[0m14:36:55.393424 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:36:55.394469 [debug] [MainThread]: On master: COMMIT
[0m14:36:55.395307 [debug] [MainThread]: Using postgres connection "master"
[0m14:36:55.396164 [debug] [MainThread]: On master: COMMIT
[0m14:36:55.397359 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:36:55.398292 [debug] [MainThread]: On master: Close
[0m14:36:55.404689 [debug] [Thread-1 (]: Began running node model.social_analytics.stg_posts
[0m14:36:55.405997 [info ] [Thread-1 (]: 1 of 3 START sql view model analytics.stg_posts ................................ [RUN]
[0m14:36:55.407409 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_social_analytics_analytics, now model.social_analytics.stg_posts)
[0m14:36:55.408513 [debug] [Thread-1 (]: Began compiling node model.social_analytics.stg_posts
[0m14:36:55.416410 [debug] [Thread-1 (]: Writing injected SQL for node "model.social_analytics.stg_posts"
[0m14:36:55.424025 [debug] [Thread-1 (]: Began executing node model.social_analytics.stg_posts
[0m14:36:55.459669 [debug] [Thread-1 (]: Writing runtime sql for node "model.social_analytics.stg_posts"
[0m14:36:55.467618 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.stg_posts"
[0m14:36:55.468936 [debug] [Thread-1 (]: On model.social_analytics.stg_posts: BEGIN
[0m14:36:55.470150 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:36:55.477893 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m14:36:55.479152 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.stg_posts"
[0m14:36:55.480142 [debug] [Thread-1 (]: On model.social_analytics.stg_posts: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.stg_posts"} */

  create view "social_analytics"."analytics"."stg_posts__dbt_tmp"
    
    
  as (
    

SELECT
    id,
    platform,
    author_name,
    content_text,
    like_count,
    comment_count,
    share_count,
    engagement_score,
    posted_at_utc,
    collected_at_utc
FROM public.posts
  );
[0m14:36:55.486596 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.005 seconds
[0m14:36:55.493860 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.stg_posts"
[0m14:36:55.495253 [debug] [Thread-1 (]: On model.social_analytics.stg_posts: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.stg_posts"} */
alter table "social_analytics"."analytics"."stg_posts" rename to "stg_posts__dbt_backup"
[0m14:36:55.496831 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:36:55.500397 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.stg_posts"
[0m14:36:55.501514 [debug] [Thread-1 (]: On model.social_analytics.stg_posts: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.stg_posts"} */
alter table "social_analytics"."analytics"."stg_posts__dbt_tmp" rename to "stg_posts"
[0m14:36:55.502921 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:36:55.519984 [debug] [Thread-1 (]: On model.social_analytics.stg_posts: COMMIT
[0m14:36:55.521856 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.stg_posts"
[0m14:36:55.523031 [debug] [Thread-1 (]: On model.social_analytics.stg_posts: COMMIT
[0m14:36:55.526169 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m14:36:55.599613 [debug] [Thread-1 (]: Applying DROP to: "social_analytics"."analytics"."stg_posts__dbt_backup"
[0m14:36:55.606096 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.stg_posts"
[0m14:36:55.607325 [debug] [Thread-1 (]: On model.social_analytics.stg_posts: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.stg_posts"} */
drop view if exists "social_analytics"."analytics"."stg_posts__dbt_backup" cascade
[0m14:36:55.611289 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m14:36:55.614670 [debug] [Thread-1 (]: On model.social_analytics.stg_posts: Close
[0m14:36:55.617748 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e9869327-c089-48bf-b6ca-d81e5cb9911b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5ca197dd0>]}
[0m14:36:55.619257 [info ] [Thread-1 (]: 1 of 3 OK created sql view model analytics.stg_posts ........................... [[32mCREATE VIEW[0m in 0.21s]
[0m14:36:55.621157 [debug] [Thread-1 (]: Finished running node model.social_analytics.stg_posts
[0m14:36:55.623158 [debug] [Thread-1 (]: Began running node model.social_analytics.fct_daily_metrics
[0m14:36:55.624345 [info ] [Thread-1 (]: 2 of 3 START sql table model analytics.fct_daily_metrics ....................... [RUN]
[0m14:36:55.625575 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.social_analytics.stg_posts, now model.social_analytics.fct_daily_metrics)
[0m14:36:55.626616 [debug] [Thread-1 (]: Began compiling node model.social_analytics.fct_daily_metrics
[0m14:36:55.630525 [debug] [Thread-1 (]: Writing injected SQL for node "model.social_analytics.fct_daily_metrics"
[0m14:36:55.637720 [debug] [Thread-1 (]: Began executing node model.social_analytics.fct_daily_metrics
[0m14:36:55.662448 [debug] [Thread-1 (]: Writing runtime sql for node "model.social_analytics.fct_daily_metrics"
[0m14:36:55.670249 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.fct_daily_metrics"
[0m14:36:55.671323 [debug] [Thread-1 (]: On model.social_analytics.fct_daily_metrics: BEGIN
[0m14:36:55.672301 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:36:55.678189 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m14:36:55.679521 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.fct_daily_metrics"
[0m14:36:55.680461 [debug] [Thread-1 (]: On model.social_analytics.fct_daily_metrics: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.fct_daily_metrics"} */

  
    

  create  table "social_analytics"."analytics"."fct_daily_metrics__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    DATE(posted_at_utc) AS post_date,
    COUNT(*) AS total_posts,
    SUM(like_count) AS total_likes,
    SUM(comment_count) AS total_comments,
    SUM(share_count) AS total_shares,
    SUM(engagement_score) AS total_engagement
FROM "social_analytics"."analytics"."stg_posts"
GROUP BY DATE(posted_at_utc)
ORDER BY post_date DESC
  );
  
[0m14:36:55.694221 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.013 seconds
[0m14:36:55.701681 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.fct_daily_metrics"
[0m14:36:55.702904 [debug] [Thread-1 (]: On model.social_analytics.fct_daily_metrics: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.fct_daily_metrics"} */
alter table "social_analytics"."analytics"."fct_daily_metrics" rename to "fct_daily_metrics__dbt_backup"
[0m14:36:55.704293 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:36:55.707611 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.fct_daily_metrics"
[0m14:36:55.708567 [debug] [Thread-1 (]: On model.social_analytics.fct_daily_metrics: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.fct_daily_metrics"} */
alter table "social_analytics"."analytics"."fct_daily_metrics__dbt_tmp" rename to "fct_daily_metrics"
[0m14:36:55.709670 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:36:55.711985 [debug] [Thread-1 (]: On model.social_analytics.fct_daily_metrics: COMMIT
[0m14:36:55.713068 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.fct_daily_metrics"
[0m14:36:55.714083 [debug] [Thread-1 (]: On model.social_analytics.fct_daily_metrics: COMMIT
[0m14:36:55.716930 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m14:36:55.720385 [debug] [Thread-1 (]: Applying DROP to: "social_analytics"."analytics"."fct_daily_metrics__dbt_backup"
[0m14:36:55.723978 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.fct_daily_metrics"
[0m14:36:55.725012 [debug] [Thread-1 (]: On model.social_analytics.fct_daily_metrics: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.fct_daily_metrics"} */
drop table if exists "social_analytics"."analytics"."fct_daily_metrics__dbt_backup" cascade
[0m14:36:55.730639 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.005 seconds
[0m14:36:55.732832 [debug] [Thread-1 (]: On model.social_analytics.fct_daily_metrics: Close
[0m14:36:55.734109 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e9869327-c089-48bf-b6ca-d81e5cb9911b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5c726cb10>]}
[0m14:36:55.735515 [info ] [Thread-1 (]: 2 of 3 OK created sql table model analytics.fct_daily_metrics .................. [[32mSELECT 2[0m in 0.11s]
[0m14:36:55.736872 [debug] [Thread-1 (]: Finished running node model.social_analytics.fct_daily_metrics
[0m14:36:55.738038 [debug] [Thread-1 (]: Began running node model.social_analytics.top_posts
[0m14:36:55.739134 [info ] [Thread-1 (]: 3 of 3 START sql table model analytics.top_posts ............................... [RUN]
[0m14:36:55.740461 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.social_analytics.fct_daily_metrics, now model.social_analytics.top_posts)
[0m14:36:55.741398 [debug] [Thread-1 (]: Began compiling node model.social_analytics.top_posts
[0m14:36:55.745337 [debug] [Thread-1 (]: Writing injected SQL for node "model.social_analytics.top_posts"
[0m14:36:55.753321 [debug] [Thread-1 (]: Began executing node model.social_analytics.top_posts
[0m14:36:55.758125 [debug] [Thread-1 (]: Writing runtime sql for node "model.social_analytics.top_posts"
[0m14:36:55.765550 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.top_posts"
[0m14:36:55.766860 [debug] [Thread-1 (]: On model.social_analytics.top_posts: BEGIN
[0m14:36:55.768206 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:36:55.775279 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m14:36:55.776520 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.top_posts"
[0m14:36:55.777492 [debug] [Thread-1 (]: On model.social_analytics.top_posts: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.top_posts"} */

  
    

  create  table "social_analytics"."analytics"."top_posts__dbt_tmp"
  
  
    as
  
  (
    

WITH ranked_posts AS (
    SELECT
        DATE(posted_at_utc) AS post_date,
        platform,
        author_name,
        content_text,
        content_url,
        like_count,
        comment_count,
        share_count,
        engagement_score,
        ROW_NUMBER() OVER (
            PARTITION BY DATE(posted_at_utc), platform
            ORDER BY engagement_score DESC
        ) AS rank
    FROM "social_analytics"."analytics"."stg_posts"
)
SELECT
    post_date,
    platform,
    author_name,
    content_text,
    content_url,
    like_count,
    comment_count,
    share_count,
    engagement_score,
    rank
FROM ranked_posts
WHERE rank <= 10
ORDER BY post_date DESC, platform, rank
  );
  
[0m14:36:55.780514 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "content_url" does not exist
LINE 20:         content_url,
                 ^

[0m14:36:55.781773 [debug] [Thread-1 (]: On model.social_analytics.top_posts: ROLLBACK
[0m14:36:55.782866 [debug] [Thread-1 (]: On model.social_analytics.top_posts: Close
[0m14:36:55.790759 [debug] [Thread-1 (]: Database Error in model top_posts (models/top_posts.sql)
  column "content_url" does not exist
  LINE 20:         content_url,
                   ^
  compiled code at target/run/social_analytics/models/top_posts.sql
[0m14:36:55.792172 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e9869327-c089-48bf-b6ca-d81e5cb9911b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5c8be8dd0>]}
[0m14:36:55.793371 [error] [Thread-1 (]: 3 of 3 ERROR creating sql table model analytics.top_posts ...................... [[31mERROR[0m in 0.05s]
[0m14:36:55.794902 [debug] [Thread-1 (]: Finished running node model.social_analytics.top_posts
[0m14:36:55.796072 [debug] [Thread-4 (]: Marking all children of 'model.social_analytics.top_posts' to be skipped because of status 'error'.  Reason: Database Error in model top_posts (models/top_posts.sql)
  column "content_url" does not exist
  LINE 20:         content_url,
                   ^
  compiled code at target/run/social_analytics/models/top_posts.sql.
[0m14:36:55.798790 [debug] [MainThread]: Using postgres connection "master"
[0m14:36:55.799707 [debug] [MainThread]: On master: BEGIN
[0m14:36:55.800560 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:36:55.806211 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m14:36:55.807408 [debug] [MainThread]: On master: COMMIT
[0m14:36:55.808332 [debug] [MainThread]: Using postgres connection "master"
[0m14:36:55.809149 [debug] [MainThread]: On master: COMMIT
[0m14:36:55.810585 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:36:55.811763 [debug] [MainThread]: On master: Close
[0m14:36:55.813247 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:36:55.814579 [debug] [MainThread]: Connection 'model.social_analytics.top_posts' was properly closed.
[0m14:36:55.815766 [info ] [MainThread]: 
[0m14:36:55.816781 [info ] [MainThread]: Finished running 2 table models, 1 view model in 0 hours 0 minutes and 0.56 seconds (0.56s).
[0m14:36:55.818607 [debug] [MainThread]: Command end result
[0m14:36:55.858333 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt_project/target/manifest.json
[0m14:36:55.865233 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt_project/target/semantic_manifest.json
[0m14:36:55.876994 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt_project/target/run_results.json
[0m14:36:55.878286 [info ] [MainThread]: 
[0m14:36:55.879738 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:36:55.881290 [info ] [MainThread]: 
[0m14:36:55.883055 [error] [MainThread]: [31mFailure in model top_posts (models/top_posts.sql)[0m
[0m14:36:55.884514 [error] [MainThread]:   Database Error in model top_posts (models/top_posts.sql)
  column "content_url" does not exist
  LINE 20:         content_url,
                   ^
  compiled code at target/run/social_analytics/models/top_posts.sql
[0m14:36:55.886259 [info ] [MainThread]: 
[0m14:36:55.887913 [info ] [MainThread]:   compiled code at target/compiled/social_analytics/models/top_posts.sql
[0m14:36:55.889189 [info ] [MainThread]: 
[0m14:36:55.890482 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=3
[0m14:36:55.893731 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.4143076, "process_in_blocks": "95032", "process_kernel_time": 0.3733, "process_mem_max_rss": "124372", "process_out_blocks": "8", "process_user_time": 2.583632}
[0m14:36:55.895925 [debug] [MainThread]: Command `dbt run` failed at 14:36:55.895674 after 1.42 seconds
[0m14:36:55.897330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5c73e0e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5cafd11d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5c8b1a490>]}
[0m14:36:55.898552 [debug] [MainThread]: Flushing usage events
[0m14:36:57.341640 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:38:38.524116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2421e39d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2421e2e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2421e24d0>]}


============================== 14:38:38.531050 | a72baff7-f20f-4fb9-9e75-59c5ef14d7f0 ==============================
[0m14:38:38.531050 [info ] [MainThread]: Running with dbt=1.10.9
[0m14:38:38.532714 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'invocation_command': 'dbt run --full-refresh', 'write_json': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'use_experimental_parser': 'False', 'cache_selected_only': 'False', 'profiles_dir': '/app', 'empty': 'False', 'quiet': 'False', 'log_path': '/app/dbt_project/logs', 'printer_width': '80', 'no_print': 'None', 'indirect_selection': 'eager', 'debug': 'False', 'log_cache_events': 'False', 'fail_fast': 'False', 'partial_parse': 'True', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'log_format': 'default', 'use_colors': 'True', 'version_check': 'True'}
[0m14:38:38.724688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a72baff7-f20f-4fb9-9e75-59c5ef14d7f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd242160c10>]}
[0m14:38:38.781836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a72baff7-f20f-4fb9-9e75-59c5ef14d7f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd244d616d0>]}
[0m14:38:38.784157 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:38:38.867542 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m14:38:39.025241 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:38:39.026646 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:38:39.054201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a72baff7-f20f-4fb9-9e75-59c5ef14d7f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd240930290>]}
[0m14:38:39.124777 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt_project/target/manifest.json
[0m14:38:39.131623 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt_project/target/semantic_manifest.json
[0m14:38:39.165815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a72baff7-f20f-4fb9-9e75-59c5ef14d7f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd240502fd0>]}
[0m14:38:39.167590 [info ] [MainThread]: Found 3 models, 434 macros
[0m14:38:39.169115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a72baff7-f20f-4fb9-9e75-59c5ef14d7f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd240d7d610>]}
[0m14:38:39.171972 [info ] [MainThread]: 
[0m14:38:39.173462 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:38:39.174688 [info ] [MainThread]: 
[0m14:38:39.176491 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:38:39.182960 [debug] [ThreadPool]: Acquiring new postgres connection 'list_social_analytics'
[0m14:38:39.235265 [debug] [ThreadPool]: Using postgres connection "list_social_analytics"
[0m14:38:39.236552 [debug] [ThreadPool]: On list_social_analytics: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "connection_name": "list_social_analytics"} */

    select distinct nspname from pg_namespace
  
[0m14:38:39.237507 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:38:39.251789 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.014 seconds
[0m14:38:39.253939 [debug] [ThreadPool]: On list_social_analytics: Close
[0m14:38:39.256443 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_social_analytics, now list_social_analytics_analytics)
[0m14:38:39.263518 [debug] [ThreadPool]: Using postgres connection "list_social_analytics_analytics"
[0m14:38:39.264617 [debug] [ThreadPool]: On list_social_analytics_analytics: BEGIN
[0m14:38:39.265702 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:38:39.271396 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m14:38:39.272615 [debug] [ThreadPool]: Using postgres connection "list_social_analytics_analytics"
[0m14:38:39.273537 [debug] [ThreadPool]: On list_social_analytics_analytics: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "connection_name": "list_social_analytics_analytics"} */
select
      'social_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'social_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'social_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m14:38:39.276996 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.003 seconds
[0m14:38:39.279004 [debug] [ThreadPool]: On list_social_analytics_analytics: ROLLBACK
[0m14:38:39.280274 [debug] [ThreadPool]: On list_social_analytics_analytics: Close
[0m14:38:39.286176 [debug] [MainThread]: Using postgres connection "master"
[0m14:38:39.287470 [debug] [MainThread]: On master: BEGIN
[0m14:38:39.288378 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:38:39.294465 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m14:38:39.295769 [debug] [MainThread]: Using postgres connection "master"
[0m14:38:39.296821 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:38:39.301234 [debug] [MainThread]: SQL status: SELECT 1 in 0.003 seconds
[0m14:38:39.303106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a72baff7-f20f-4fb9-9e75-59c5ef14d7f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2420dcbd0>]}
[0m14:38:39.304153 [debug] [MainThread]: On master: ROLLBACK
[0m14:38:39.305247 [debug] [MainThread]: Using postgres connection "master"
[0m14:38:39.306126 [debug] [MainThread]: On master: BEGIN
[0m14:38:39.307394 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:38:39.308428 [debug] [MainThread]: On master: COMMIT
[0m14:38:39.309300 [debug] [MainThread]: Using postgres connection "master"
[0m14:38:39.310204 [debug] [MainThread]: On master: COMMIT
[0m14:38:39.311254 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:38:39.312080 [debug] [MainThread]: On master: Close
[0m14:38:39.316811 [debug] [Thread-1 (]: Began running node model.social_analytics.stg_posts
[0m14:38:39.318026 [info ] [Thread-1 (]: 1 of 3 START sql view model analytics.stg_posts ................................ [RUN]
[0m14:38:39.319471 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_social_analytics_analytics, now model.social_analytics.stg_posts)
[0m14:38:39.320678 [debug] [Thread-1 (]: Began compiling node model.social_analytics.stg_posts
[0m14:38:39.329294 [debug] [Thread-1 (]: Writing injected SQL for node "model.social_analytics.stg_posts"
[0m14:38:39.336874 [debug] [Thread-1 (]: Began executing node model.social_analytics.stg_posts
[0m14:38:39.373832 [debug] [Thread-1 (]: Writing runtime sql for node "model.social_analytics.stg_posts"
[0m14:38:39.382224 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.stg_posts"
[0m14:38:39.383463 [debug] [Thread-1 (]: On model.social_analytics.stg_posts: BEGIN
[0m14:38:39.384750 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:38:39.390630 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m14:38:39.391962 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.stg_posts"
[0m14:38:39.392857 [debug] [Thread-1 (]: On model.social_analytics.stg_posts: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.stg_posts"} */

  create view "social_analytics"."analytics"."stg_posts__dbt_tmp"
    
    
  as (
    

SELECT
    id,
    platform,
    author_name,
    content_text,
    like_count,
    comment_count,
    share_count,
    engagement_score,
    posted_at_utc,
    collected_at_utc
FROM public.posts
  );
[0m14:38:39.397153 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m14:38:39.404502 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.stg_posts"
[0m14:38:39.406069 [debug] [Thread-1 (]: On model.social_analytics.stg_posts: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.stg_posts"} */
alter table "social_analytics"."analytics"."stg_posts" rename to "stg_posts__dbt_backup"
[0m14:38:39.407665 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:38:39.411558 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.stg_posts"
[0m14:38:39.412778 [debug] [Thread-1 (]: On model.social_analytics.stg_posts: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.stg_posts"} */
alter table "social_analytics"."analytics"."stg_posts__dbt_tmp" rename to "stg_posts"
[0m14:38:39.414133 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:38:39.431537 [debug] [Thread-1 (]: On model.social_analytics.stg_posts: COMMIT
[0m14:38:39.433178 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.stg_posts"
[0m14:38:39.434223 [debug] [Thread-1 (]: On model.social_analytics.stg_posts: COMMIT
[0m14:38:39.437446 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m14:38:39.507481 [debug] [Thread-1 (]: Applying DROP to: "social_analytics"."analytics"."stg_posts__dbt_backup"
[0m14:38:39.513962 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.stg_posts"
[0m14:38:39.515423 [debug] [Thread-1 (]: On model.social_analytics.stg_posts: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.stg_posts"} */
drop view if exists "social_analytics"."analytics"."stg_posts__dbt_backup" cascade
[0m14:38:39.520313 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m14:38:39.523461 [debug] [Thread-1 (]: On model.social_analytics.stg_posts: Close
[0m14:38:39.526431 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a72baff7-f20f-4fb9-9e75-59c5ef14d7f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd23f4296d0>]}
[0m14:38:39.527893 [info ] [Thread-1 (]: 1 of 3 OK created sql view model analytics.stg_posts ........................... [[32mCREATE VIEW[0m in 0.21s]
[0m14:38:39.529425 [debug] [Thread-1 (]: Finished running node model.social_analytics.stg_posts
[0m14:38:39.531662 [debug] [Thread-1 (]: Began running node model.social_analytics.fct_daily_metrics
[0m14:38:39.532887 [info ] [Thread-1 (]: 2 of 3 START sql table model analytics.fct_daily_metrics ....................... [RUN]
[0m14:38:39.534107 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.social_analytics.stg_posts, now model.social_analytics.fct_daily_metrics)
[0m14:38:39.535461 [debug] [Thread-1 (]: Began compiling node model.social_analytics.fct_daily_metrics
[0m14:38:39.541101 [debug] [Thread-1 (]: Writing injected SQL for node "model.social_analytics.fct_daily_metrics"
[0m14:38:39.550092 [debug] [Thread-1 (]: Began executing node model.social_analytics.fct_daily_metrics
[0m14:38:39.575527 [debug] [Thread-1 (]: Writing runtime sql for node "model.social_analytics.fct_daily_metrics"
[0m14:38:39.583049 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.fct_daily_metrics"
[0m14:38:39.584210 [debug] [Thread-1 (]: On model.social_analytics.fct_daily_metrics: BEGIN
[0m14:38:39.585183 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:38:39.591227 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m14:38:39.592644 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.fct_daily_metrics"
[0m14:38:39.593626 [debug] [Thread-1 (]: On model.social_analytics.fct_daily_metrics: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.fct_daily_metrics"} */

  
    

  create  table "social_analytics"."analytics"."fct_daily_metrics__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    DATE(posted_at_utc) AS post_date,
    COUNT(*) AS total_posts,
    SUM(like_count) AS total_likes,
    SUM(comment_count) AS total_comments,
    SUM(share_count) AS total_shares,
    SUM(engagement_score) AS total_engagement
FROM "social_analytics"."analytics"."stg_posts"
GROUP BY DATE(posted_at_utc)
ORDER BY post_date DESC
  );
  
[0m14:38:39.603746 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.009 seconds
[0m14:38:39.611936 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.fct_daily_metrics"
[0m14:38:39.613431 [debug] [Thread-1 (]: On model.social_analytics.fct_daily_metrics: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.fct_daily_metrics"} */
alter table "social_analytics"."analytics"."fct_daily_metrics" rename to "fct_daily_metrics__dbt_backup"
[0m14:38:39.615180 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:38:39.619197 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.fct_daily_metrics"
[0m14:38:39.620631 [debug] [Thread-1 (]: On model.social_analytics.fct_daily_metrics: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.fct_daily_metrics"} */
alter table "social_analytics"."analytics"."fct_daily_metrics__dbt_tmp" rename to "fct_daily_metrics"
[0m14:38:39.622406 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:38:39.624743 [debug] [Thread-1 (]: On model.social_analytics.fct_daily_metrics: COMMIT
[0m14:38:39.625806 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.fct_daily_metrics"
[0m14:38:39.626824 [debug] [Thread-1 (]: On model.social_analytics.fct_daily_metrics: COMMIT
[0m14:38:39.629727 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m14:38:39.632935 [debug] [Thread-1 (]: Applying DROP to: "social_analytics"."analytics"."fct_daily_metrics__dbt_backup"
[0m14:38:39.636749 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.fct_daily_metrics"
[0m14:38:39.637901 [debug] [Thread-1 (]: On model.social_analytics.fct_daily_metrics: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.fct_daily_metrics"} */
drop table if exists "social_analytics"."analytics"."fct_daily_metrics__dbt_backup" cascade
[0m14:38:39.641583 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m14:38:39.643689 [debug] [Thread-1 (]: On model.social_analytics.fct_daily_metrics: Close
[0m14:38:39.644861 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a72baff7-f20f-4fb9-9e75-59c5ef14d7f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd23f494fd0>]}
[0m14:38:39.646251 [info ] [Thread-1 (]: 2 of 3 OK created sql table model analytics.fct_daily_metrics .................. [[32mSELECT 2[0m in 0.11s]
[0m14:38:39.647966 [debug] [Thread-1 (]: Finished running node model.social_analytics.fct_daily_metrics
[0m14:38:39.649162 [debug] [Thread-1 (]: Began running node model.social_analytics.top_posts
[0m14:38:39.650289 [info ] [Thread-1 (]: 3 of 3 START sql table model analytics.top_posts ............................... [RUN]
[0m14:38:39.651449 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.social_analytics.fct_daily_metrics, now model.social_analytics.top_posts)
[0m14:38:39.652398 [debug] [Thread-1 (]: Began compiling node model.social_analytics.top_posts
[0m14:38:39.656303 [debug] [Thread-1 (]: Writing injected SQL for node "model.social_analytics.top_posts"
[0m14:38:39.663022 [debug] [Thread-1 (]: Began executing node model.social_analytics.top_posts
[0m14:38:39.667938 [debug] [Thread-1 (]: Writing runtime sql for node "model.social_analytics.top_posts"
[0m14:38:39.675607 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.top_posts"
[0m14:38:39.676960 [debug] [Thread-1 (]: On model.social_analytics.top_posts: BEGIN
[0m14:38:39.677808 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:38:39.685506 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m14:38:39.686899 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.top_posts"
[0m14:38:39.687943 [debug] [Thread-1 (]: On model.social_analytics.top_posts: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.top_posts"} */

  
    

  create  table "social_analytics"."analytics"."top_posts__dbt_tmp"
  
  
    as
  
  (
    

WITH ranked_posts AS (
    SELECT
        DATE(posted_at_utc) AS post_date,
        platform,
        author_name,
        content_text,
        content_url,
        like_count,
        comment_count,
        share_count,
        engagement_score,
        ROW_NUMBER() OVER (
            PARTITION BY DATE(posted_at_utc), platform
            ORDER BY engagement_score DESC
        ) AS rank
    FROM "social_analytics"."analytics"."stg_posts"
)
SELECT
    post_date,
    platform,
    author_name,
    content_text,
    content_url,
    like_count,
    comment_count,
    share_count,
    engagement_score,
    rank
FROM ranked_posts
WHERE rank <= 10
ORDER BY post_date DESC, platform, rank
  );
  
[0m14:38:39.691058 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "content_url" does not exist
LINE 20:         content_url,
                 ^

[0m14:38:39.692327 [debug] [Thread-1 (]: On model.social_analytics.top_posts: ROLLBACK
[0m14:38:39.693486 [debug] [Thread-1 (]: On model.social_analytics.top_posts: Close
[0m14:38:39.700940 [debug] [Thread-1 (]: Database Error in model top_posts (models/top_posts.sql)
  column "content_url" does not exist
  LINE 20:         content_url,
                   ^
  compiled code at target/run/social_analytics/models/top_posts.sql
[0m14:38:39.702275 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a72baff7-f20f-4fb9-9e75-59c5ef14d7f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd23f45c8d0>]}
[0m14:38:39.703574 [error] [Thread-1 (]: 3 of 3 ERROR creating sql table model analytics.top_posts ...................... [[31mERROR[0m in 0.05s]
[0m14:38:39.704919 [debug] [Thread-1 (]: Finished running node model.social_analytics.top_posts
[0m14:38:39.706179 [debug] [Thread-4 (]: Marking all children of 'model.social_analytics.top_posts' to be skipped because of status 'error'.  Reason: Database Error in model top_posts (models/top_posts.sql)
  column "content_url" does not exist
  LINE 20:         content_url,
                   ^
  compiled code at target/run/social_analytics/models/top_posts.sql.
[0m14:38:39.709393 [debug] [MainThread]: Using postgres connection "master"
[0m14:38:39.710586 [debug] [MainThread]: On master: BEGIN
[0m14:38:39.711629 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:38:39.717720 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m14:38:39.719022 [debug] [MainThread]: On master: COMMIT
[0m14:38:39.720250 [debug] [MainThread]: Using postgres connection "master"
[0m14:38:39.721452 [debug] [MainThread]: On master: COMMIT
[0m14:38:39.722744 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:38:39.723635 [debug] [MainThread]: On master: Close
[0m14:38:39.724677 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:38:39.725621 [debug] [MainThread]: Connection 'model.social_analytics.top_posts' was properly closed.
[0m14:38:39.727163 [info ] [MainThread]: 
[0m14:38:39.728604 [info ] [MainThread]: Finished running 2 table models, 1 view model in 0 hours 0 minutes and 0.55 seconds (0.55s).
[0m14:38:39.730404 [debug] [MainThread]: Command end result
[0m14:38:39.767331 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt_project/target/manifest.json
[0m14:38:39.774531 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt_project/target/semantic_manifest.json
[0m14:38:39.785313 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt_project/target/run_results.json
[0m14:38:39.786635 [info ] [MainThread]: 
[0m14:38:39.788056 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m14:38:39.789645 [info ] [MainThread]: 
[0m14:38:39.791099 [error] [MainThread]: [31mFailure in model top_posts (models/top_posts.sql)[0m
[0m14:38:39.792404 [error] [MainThread]:   Database Error in model top_posts (models/top_posts.sql)
  column "content_url" does not exist
  LINE 20:         content_url,
                   ^
  compiled code at target/run/social_analytics/models/top_posts.sql
[0m14:38:39.793640 [info ] [MainThread]: 
[0m14:38:39.795142 [info ] [MainThread]:   compiled code at target/compiled/social_analytics/models/top_posts.sql
[0m14:38:39.796624 [info ] [MainThread]: 
[0m14:38:39.797868 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=3
[0m14:38:39.800527 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.3417629, "process_in_blocks": "95032", "process_kernel_time": 0.405766, "process_mem_max_rss": "122880", "process_out_blocks": "8", "process_user_time": 2.476213}
[0m14:38:39.802171 [debug] [MainThread]: Command `dbt run` failed at 14:38:39.801980 after 1.34 seconds
[0m14:38:39.803730 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd242284410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd2422477d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd242247610>]}
[0m14:38:39.804917 [debug] [MainThread]: Flushing usage events
[0m14:38:40.970166 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m14:42:12.610127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8f9f8fb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8f9f8de50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8f9f8c690>]}


============================== 14:42:12.618129 | 02ab77e9-3f36-49b1-8994-f4d809fc827f ==============================
[0m14:42:12.618129 [info ] [MainThread]: Running with dbt=1.10.9
[0m14:42:12.619758 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'warn_error': 'None', 'introspect': 'True', 'cache_selected_only': 'False', 'use_colors': 'True', 'profiles_dir': '/app', 'version_check': 'True', 'log_format': 'default', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'write_json': 'True', 'empty': 'False', 'fail_fast': 'False', 'debug': 'False', 'quiet': 'False', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'target_path': 'None', 'invocation_command': 'dbt run --full-refresh', 'indirect_selection': 'eager', 'static_parser': 'True', 'log_path': '/app/dbt_project/logs', 'send_anonymous_usage_stats': 'True'}
[0m14:42:12.811700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '02ab77e9-3f36-49b1-8994-f4d809fc827f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8fc5e8f90>]}
[0m14:42:12.869573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '02ab77e9-3f36-49b1-8994-f4d809fc827f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8fcad5950>]}
[0m14:42:12.873625 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m14:42:12.954719 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m14:42:13.140786 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:42:13.142083 [debug] [MainThread]: Partial parsing: updated file: social_analytics://models/stg_posts.sql
[0m14:42:13.379540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '02ab77e9-3f36-49b1-8994-f4d809fc827f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8f98fd350>]}
[0m14:42:13.447034 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt_project/target/manifest.json
[0m14:42:13.454036 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt_project/target/semantic_manifest.json
[0m14:42:13.486931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '02ab77e9-3f36-49b1-8994-f4d809fc827f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8f856f290>]}
[0m14:42:13.488831 [info ] [MainThread]: Found 3 models, 434 macros
[0m14:42:13.490414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '02ab77e9-3f36-49b1-8994-f4d809fc827f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8f8926950>]}
[0m14:42:13.493188 [info ] [MainThread]: 
[0m14:42:13.494824 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:42:13.496546 [info ] [MainThread]: 
[0m14:42:13.498307 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m14:42:13.503843 [debug] [ThreadPool]: Acquiring new postgres connection 'list_social_analytics'
[0m14:42:13.619272 [debug] [ThreadPool]: Using postgres connection "list_social_analytics"
[0m14:42:13.620826 [debug] [ThreadPool]: On list_social_analytics: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "connection_name": "list_social_analytics"} */

    select distinct nspname from pg_namespace
  
[0m14:42:13.622188 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:42:13.637027 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.015 seconds
[0m14:42:13.639392 [debug] [ThreadPool]: On list_social_analytics: Close
[0m14:42:13.641914 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_social_analytics, now list_social_analytics_analytics)
[0m14:42:13.649125 [debug] [ThreadPool]: Using postgres connection "list_social_analytics_analytics"
[0m14:42:13.650414 [debug] [ThreadPool]: On list_social_analytics_analytics: BEGIN
[0m14:42:13.651788 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:42:13.658889 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m14:42:13.660387 [debug] [ThreadPool]: Using postgres connection "list_social_analytics_analytics"
[0m14:42:13.661458 [debug] [ThreadPool]: On list_social_analytics_analytics: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "connection_name": "list_social_analytics_analytics"} */
select
      'social_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics'
    union all
    select
      'social_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics'
    union all
    select
      'social_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics'
  
[0m14:42:13.665497 [debug] [ThreadPool]: SQL status: SELECT 2 in 0.003 seconds
[0m14:42:13.667601 [debug] [ThreadPool]: On list_social_analytics_analytics: ROLLBACK
[0m14:42:13.668870 [debug] [ThreadPool]: On list_social_analytics_analytics: Close
[0m14:42:13.674982 [debug] [MainThread]: Using postgres connection "master"
[0m14:42:13.676253 [debug] [MainThread]: On master: BEGIN
[0m14:42:13.677326 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:42:13.684390 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m14:42:13.685782 [debug] [MainThread]: Using postgres connection "master"
[0m14:42:13.686950 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m14:42:13.691891 [debug] [MainThread]: SQL status: SELECT 1 in 0.004 seconds
[0m14:42:13.694114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '02ab77e9-3f36-49b1-8994-f4d809fc827f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8fcbaab50>]}
[0m14:42:13.695304 [debug] [MainThread]: On master: ROLLBACK
[0m14:42:13.696453 [debug] [MainThread]: Using postgres connection "master"
[0m14:42:13.697402 [debug] [MainThread]: On master: BEGIN
[0m14:42:13.698853 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m14:42:13.700262 [debug] [MainThread]: On master: COMMIT
[0m14:42:13.701506 [debug] [MainThread]: Using postgres connection "master"
[0m14:42:13.702751 [debug] [MainThread]: On master: COMMIT
[0m14:42:13.704160 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:42:13.705361 [debug] [MainThread]: On master: Close
[0m14:42:13.712280 [debug] [Thread-1 (]: Began running node model.social_analytics.stg_posts
[0m14:42:13.714092 [info ] [Thread-1 (]: 1 of 3 START sql view model analytics.stg_posts ................................ [RUN]
[0m14:42:13.715932 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_social_analytics_analytics, now model.social_analytics.stg_posts)
[0m14:42:13.717023 [debug] [Thread-1 (]: Began compiling node model.social_analytics.stg_posts
[0m14:42:13.725791 [debug] [Thread-1 (]: Writing injected SQL for node "model.social_analytics.stg_posts"
[0m14:42:13.734271 [debug] [Thread-1 (]: Began executing node model.social_analytics.stg_posts
[0m14:42:13.771179 [debug] [Thread-1 (]: Writing runtime sql for node "model.social_analytics.stg_posts"
[0m14:42:13.779024 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.stg_posts"
[0m14:42:13.780517 [debug] [Thread-1 (]: On model.social_analytics.stg_posts: BEGIN
[0m14:42:13.781643 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:42:13.788631 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m14:42:13.789973 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.stg_posts"
[0m14:42:13.791359 [debug] [Thread-1 (]: On model.social_analytics.stg_posts: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.stg_posts"} */

  create view "social_analytics"."analytics"."stg_posts__dbt_tmp"
    
    
  as (
    

SELECT
    id,
    platform,
    platform_post_id,
    author_name,
    content_text,
    content_url,
    like_count,
    comment_count,
    share_count,
    engagement_score,
    posted_at_utc,
    collected_at_utc
FROM public.posts
  );
[0m14:42:13.798105 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m14:42:13.805141 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.stg_posts"
[0m14:42:13.806335 [debug] [Thread-1 (]: On model.social_analytics.stg_posts: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.stg_posts"} */
alter table "social_analytics"."analytics"."stg_posts" rename to "stg_posts__dbt_backup"
[0m14:42:13.807728 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:42:13.811553 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.stg_posts"
[0m14:42:13.812566 [debug] [Thread-1 (]: On model.social_analytics.stg_posts: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.stg_posts"} */
alter table "social_analytics"."analytics"."stg_posts__dbt_tmp" rename to "stg_posts"
[0m14:42:13.813739 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:42:13.829347 [debug] [Thread-1 (]: On model.social_analytics.stg_posts: COMMIT
[0m14:42:13.830785 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.stg_posts"
[0m14:42:13.832044 [debug] [Thread-1 (]: On model.social_analytics.stg_posts: COMMIT
[0m14:42:13.835082 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m14:42:13.841768 [debug] [Thread-1 (]: Applying DROP to: "social_analytics"."analytics"."stg_posts__dbt_backup"
[0m14:42:13.847147 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.stg_posts"
[0m14:42:13.848404 [debug] [Thread-1 (]: On model.social_analytics.stg_posts: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.stg_posts"} */
drop view if exists "social_analytics"."analytics"."stg_posts__dbt_backup" cascade
[0m14:42:13.852353 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m14:42:13.855579 [debug] [Thread-1 (]: On model.social_analytics.stg_posts: Close
[0m14:42:13.858196 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '02ab77e9-3f36-49b1-8994-f4d809fc827f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8f995b990>]}
[0m14:42:13.859519 [info ] [Thread-1 (]: 1 of 3 OK created sql view model analytics.stg_posts ........................... [[32mCREATE VIEW[0m in 0.14s]
[0m14:42:13.861177 [debug] [Thread-1 (]: Finished running node model.social_analytics.stg_posts
[0m14:42:13.863093 [debug] [Thread-1 (]: Began running node model.social_analytics.fct_daily_metrics
[0m14:42:13.864208 [info ] [Thread-1 (]: 2 of 3 START sql table model analytics.fct_daily_metrics ....................... [RUN]
[0m14:42:13.865467 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.social_analytics.stg_posts, now model.social_analytics.fct_daily_metrics)
[0m14:42:13.866477 [debug] [Thread-1 (]: Began compiling node model.social_analytics.fct_daily_metrics
[0m14:42:13.870826 [debug] [Thread-1 (]: Writing injected SQL for node "model.social_analytics.fct_daily_metrics"
[0m14:42:13.879040 [debug] [Thread-1 (]: Began executing node model.social_analytics.fct_daily_metrics
[0m14:42:13.903899 [debug] [Thread-1 (]: Writing runtime sql for node "model.social_analytics.fct_daily_metrics"
[0m14:42:13.911975 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.fct_daily_metrics"
[0m14:42:13.913239 [debug] [Thread-1 (]: On model.social_analytics.fct_daily_metrics: BEGIN
[0m14:42:13.914432 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:42:13.921396 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m14:42:13.922815 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.fct_daily_metrics"
[0m14:42:13.923754 [debug] [Thread-1 (]: On model.social_analytics.fct_daily_metrics: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.fct_daily_metrics"} */

  
    

  create  table "social_analytics"."analytics"."fct_daily_metrics__dbt_tmp"
  
  
    as
  
  (
    

SELECT
    DATE(posted_at_utc) AS post_date,
    COUNT(*) AS total_posts,
    SUM(like_count) AS total_likes,
    SUM(comment_count) AS total_comments,
    SUM(share_count) AS total_shares,
    SUM(engagement_score) AS total_engagement
FROM "social_analytics"."analytics"."stg_posts"
GROUP BY DATE(posted_at_utc)
ORDER BY post_date DESC
  );
  
[0m14:42:13.932706 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.008 seconds
[0m14:42:13.941030 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.fct_daily_metrics"
[0m14:42:13.942392 [debug] [Thread-1 (]: On model.social_analytics.fct_daily_metrics: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.fct_daily_metrics"} */
alter table "social_analytics"."analytics"."fct_daily_metrics" rename to "fct_daily_metrics__dbt_backup"
[0m14:42:13.944001 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:42:13.947884 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.fct_daily_metrics"
[0m14:42:13.949204 [debug] [Thread-1 (]: On model.social_analytics.fct_daily_metrics: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.fct_daily_metrics"} */
alter table "social_analytics"."analytics"."fct_daily_metrics__dbt_tmp" rename to "fct_daily_metrics"
[0m14:42:13.950571 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m14:42:13.952628 [debug] [Thread-1 (]: On model.social_analytics.fct_daily_metrics: COMMIT
[0m14:42:13.953635 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.fct_daily_metrics"
[0m14:42:13.954533 [debug] [Thread-1 (]: On model.social_analytics.fct_daily_metrics: COMMIT
[0m14:42:13.957236 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m14:42:13.960603 [debug] [Thread-1 (]: Applying DROP to: "social_analytics"."analytics"."fct_daily_metrics__dbt_backup"
[0m14:42:13.964151 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.fct_daily_metrics"
[0m14:42:13.965292 [debug] [Thread-1 (]: On model.social_analytics.fct_daily_metrics: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.fct_daily_metrics"} */
drop table if exists "social_analytics"."analytics"."fct_daily_metrics__dbt_backup" cascade
[0m14:42:13.969160 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m14:42:13.971513 [debug] [Thread-1 (]: On model.social_analytics.fct_daily_metrics: Close
[0m14:42:13.973008 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '02ab77e9-3f36-49b1-8994-f4d809fc827f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8f582d0d0>]}
[0m14:42:13.974506 [info ] [Thread-1 (]: 2 of 3 OK created sql table model analytics.fct_daily_metrics .................. [[32mSELECT 2[0m in 0.11s]
[0m14:42:13.976012 [debug] [Thread-1 (]: Finished running node model.social_analytics.fct_daily_metrics
[0m14:42:13.977063 [debug] [Thread-1 (]: Began running node model.social_analytics.top_posts
[0m14:42:13.978190 [info ] [Thread-1 (]: 3 of 3 START sql table model analytics.top_posts ............................... [RUN]
[0m14:42:13.980313 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.social_analytics.fct_daily_metrics, now model.social_analytics.top_posts)
[0m14:42:13.981771 [debug] [Thread-1 (]: Began compiling node model.social_analytics.top_posts
[0m14:42:13.985826 [debug] [Thread-1 (]: Writing injected SQL for node "model.social_analytics.top_posts"
[0m14:42:13.993007 [debug] [Thread-1 (]: Began executing node model.social_analytics.top_posts
[0m14:42:13.997689 [debug] [Thread-1 (]: Writing runtime sql for node "model.social_analytics.top_posts"
[0m14:42:14.006619 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.top_posts"
[0m14:42:14.008092 [debug] [Thread-1 (]: On model.social_analytics.top_posts: BEGIN
[0m14:42:14.009397 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:42:14.016553 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m14:42:14.018320 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.top_posts"
[0m14:42:14.019448 [debug] [Thread-1 (]: On model.social_analytics.top_posts: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.top_posts"} */

  
    

  create  table "social_analytics"."analytics"."top_posts__dbt_tmp"
  
  
    as
  
  (
    

WITH ranked_posts AS (
    SELECT
        DATE(posted_at_utc) AS post_date,
        platform,
        author_name,
        content_text,
        content_url,
        like_count,
        comment_count,
        share_count,
        engagement_score,
        ROW_NUMBER() OVER (
            PARTITION BY DATE(posted_at_utc), platform
            ORDER BY engagement_score DESC
        ) AS rank
    FROM "social_analytics"."analytics"."stg_posts"
)
SELECT
    post_date,
    platform,
    author_name,
    content_text,
    content_url,
    like_count,
    comment_count,
    share_count,
    engagement_score,
    rank
FROM ranked_posts
WHERE rank <= 10
ORDER BY post_date DESC, platform, rank
  );
  
[0m14:42:14.028949 [debug] [Thread-1 (]: SQL status: SELECT 2 in 0.008 seconds
[0m14:42:14.033087 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.top_posts"
[0m14:42:14.034124 [debug] [Thread-1 (]: On model.social_analytics.top_posts: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.top_posts"} */
alter table "social_analytics"."analytics"."top_posts__dbt_tmp" rename to "top_posts"
[0m14:42:14.036028 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m14:42:14.037965 [debug] [Thread-1 (]: On model.social_analytics.top_posts: COMMIT
[0m14:42:14.038880 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.top_posts"
[0m14:42:14.039770 [debug] [Thread-1 (]: On model.social_analytics.top_posts: COMMIT
[0m14:42:14.042505 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m14:42:14.045545 [debug] [Thread-1 (]: Applying DROP to: "social_analytics"."analytics"."top_posts__dbt_backup"
[0m14:42:14.046981 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.top_posts"
[0m14:42:14.047928 [debug] [Thread-1 (]: On model.social_analytics.top_posts: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.top_posts"} */
drop table if exists "social_analytics"."analytics"."top_posts__dbt_backup" cascade
[0m14:42:14.049495 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m14:42:14.051357 [debug] [Thread-1 (]: On model.social_analytics.top_posts: Close
[0m14:42:14.052544 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '02ab77e9-3f36-49b1-8994-f4d809fc827f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8f5974290>]}
[0m14:42:14.054015 [info ] [Thread-1 (]: 3 of 3 OK created sql table model analytics.top_posts .......................... [[32mSELECT 2[0m in 0.07s]
[0m14:42:14.055638 [debug] [Thread-1 (]: Finished running node model.social_analytics.top_posts
[0m14:42:14.058115 [debug] [MainThread]: Using postgres connection "master"
[0m14:42:14.059153 [debug] [MainThread]: On master: BEGIN
[0m14:42:14.060078 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:42:14.065648 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m14:42:14.066737 [debug] [MainThread]: On master: COMMIT
[0m14:42:14.067597 [debug] [MainThread]: Using postgres connection "master"
[0m14:42:14.068594 [debug] [MainThread]: On master: COMMIT
[0m14:42:14.069680 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m14:42:14.070623 [debug] [MainThread]: On master: Close
[0m14:42:14.071744 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:42:14.072847 [debug] [MainThread]: Connection 'model.social_analytics.top_posts' was properly closed.
[0m14:42:14.074179 [info ] [MainThread]: 
[0m14:42:14.075608 [info ] [MainThread]: Finished running 2 table models, 1 view model in 0 hours 0 minutes and 0.58 seconds (0.58s).
[0m14:42:14.077814 [debug] [MainThread]: Command end result
[0m14:42:14.113712 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt_project/target/manifest.json
[0m14:42:14.119740 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt_project/target/semantic_manifest.json
[0m14:42:14.130761 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt_project/target/run_results.json
[0m14:42:14.132132 [info ] [MainThread]: 
[0m14:42:14.133577 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:42:14.134744 [info ] [MainThread]: 
[0m14:42:14.135916 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m14:42:14.138568 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.5963955, "process_in_blocks": "95328", "process_kernel_time": 0.390081, "process_mem_max_rss": "128952", "process_out_blocks": "8", "process_user_time": 2.720818}
[0m14:42:14.140024 [debug] [MainThread]: Command `dbt run` succeeded at 14:42:14.139886 after 1.60 seconds
[0m14:42:14.141182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8f9f5bb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8f9f4c210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8f9fbbad0>]}
[0m14:42:14.142379 [debug] [MainThread]: Flushing usage events
[0m14:42:15.088264 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:28:58.116688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc2b02fa10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc29f43f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc29f385d0>]}


============================== 15:28:58.124123 | f6c7f9ea-20a2-44e0-b5ef-aa8005175716 ==============================
[0m15:28:58.124123 [info ] [MainThread]: Running with dbt=1.10.9
[0m15:28:58.125588 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'static_parser': 'True', 'warn_error': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'fail_fast': 'False', 'no_print': 'None', 'target_path': 'None', 'log_path': '/app/dbt_project/logs', 'use_colors': 'True', 'introspect': 'True', 'version_check': 'True', 'use_experimental_parser': 'False', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'empty': 'None', 'write_json': 'True', 'partial_parse': 'True', 'profiles_dir': '/app', 'debug': 'False'}
[0m15:28:58.151319 [info ] [MainThread]: dbt version: 1.10.9
[0m15:28:58.152911 [info ] [MainThread]: python version: 3.11.13
[0m15:28:58.154241 [info ] [MainThread]: python path: /usr/local/bin/python3.11
[0m15:28:58.155279 [info ] [MainThread]: os info: Linux-5.15.167.4-microsoft-standard-WSL2-x86_64-with-glibc2.41
[0m15:28:58.239550 [info ] [MainThread]: Using profiles dir at /app
[0m15:28:58.241401 [info ] [MainThread]: Using profiles.yml file at /app/profiles.yml
[0m15:28:58.242683 [info ] [MainThread]: Using dbt_project.yml file at /app/dbt_project/dbt_project.yml
[0m15:28:58.244750 [info ] [MainThread]: adapter type: postgres
[0m15:28:58.246227 [info ] [MainThread]: adapter version: 1.9.0
[0m15:28:58.354387 [info ] [MainThread]: Configuration:
[0m15:28:58.356235 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m15:28:58.357389 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m15:28:58.358580 [info ] [MainThread]: Required dependencies:
[0m15:28:58.359596 [debug] [MainThread]: Executing "git --help"
[0m15:28:58.361458 [info ] [MainThread]:  - git [[31mERROR[0m]

[0m15:28:58.362798 [info ] [MainThread]: Connection:
[0m15:28:58.364247 [info ] [MainThread]:   host: postgres
[0m15:28:58.365615 [info ] [MainThread]:   port: 5432
[0m15:28:58.367123 [info ] [MainThread]:   user: postgres
[0m15:28:58.368402 [info ] [MainThread]:   database: social_analytics
[0m15:28:58.370215 [info ] [MainThread]:   schema: analytics
[0m15:28:58.371930 [info ] [MainThread]:   connect_timeout: 10
[0m15:28:58.373276 [info ] [MainThread]:   role: None
[0m15:28:58.374350 [info ] [MainThread]:   search_path: None
[0m15:28:58.375422 [info ] [MainThread]:   keepalives_idle: 0
[0m15:28:58.376719 [info ] [MainThread]:   sslmode: None
[0m15:28:58.377798 [info ] [MainThread]:   sslcert: None
[0m15:28:58.378906 [info ] [MainThread]:   sslkey: None
[0m15:28:58.380031 [info ] [MainThread]:   sslrootcert: None
[0m15:28:58.381515 [info ] [MainThread]:   application_name: dbt
[0m15:28:58.383157 [info ] [MainThread]:   retries: 1
[0m15:28:58.384860 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:28:58.465753 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m15:28:58.522995 [debug] [MainThread]: Using postgres connection "debug"
[0m15:28:58.524433 [debug] [MainThread]: On debug: select 1 as id
[0m15:28:58.525498 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:28:58.538889 [debug] [MainThread]: SQL status: SELECT 1 in 0.013 seconds
[0m15:28:58.540709 [debug] [MainThread]: On debug: Close
[0m15:28:58.541745 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m15:28:58.543015 [info ] [MainThread]: [31m1 check failed:[0m
[0m15:28:58.544502 [info ] [MainThread]: Error from git --help: Could not find command, ensure it is in the user's PATH: "git"

[0m15:28:58.547014 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": false, "command_wall_clock_time": 0.5190863, "process_in_blocks": "75360", "process_kernel_time": 0.628792, "process_mem_max_rss": "115304", "process_out_blocks": "8", "process_user_time": 1.886376}
[0m15:28:58.548271 [debug] [MainThread]: Command `dbt debug` failed at 15:28:58.548097 after 0.52 seconds
[0m15:28:58.549298 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m15:28:58.550243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc29f3b990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc29f31550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc2a0a9b50>]}
[0m15:28:58.551336 [debug] [MainThread]: Flushing usage events
[0m15:28:59.810578 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:33:16.753457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff333182190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff332ff3c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff333250950>]}


============================== 15:33:16.761662 | 884d0012-3c23-49d9-a692-a6cd647c1932 ==============================
[0m15:33:16.761662 [info ] [MainThread]: Running with dbt=1.10.9
[0m15:33:16.763649 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'debug': 'False', 'invocation_command': 'dbt run', 'profiles_dir': '/app', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'target_path': 'None', 'static_parser': 'True', 'no_print': 'None', 'fail_fast': 'False', 'cache_selected_only': 'False', 'indirect_selection': 'eager', 'empty': 'False', 'log_path': '/app/dbt_project/logs', 'log_cache_events': 'False', 'warn_error': 'None', 'quiet': 'False', 'use_colors': 'True', 'write_json': 'True', 'printer_width': '80', 'use_experimental_parser': 'False', 'partial_parse': 'True'}
[0m15:33:16.979153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '884d0012-3c23-49d9-a692-a6cd647c1932', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff332341950>]}
[0m15:33:17.039375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '884d0012-3c23-49d9-a692-a6cd647c1932', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff335bd0f90>]}
[0m15:33:17.043335 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:33:17.126017 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m15:33:17.359231 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m15:33:17.361078 [debug] [MainThread]: Partial parsing: updated file: social_analytics://models/top_posts.sql
[0m15:33:17.362407 [debug] [MainThread]: Partial parsing: updated file: social_analytics://models/fct_daily_metrics.sql
[0m15:33:17.363472 [debug] [MainThread]: Partial parsing: updated file: social_analytics://models/stg_posts.sql
[0m15:33:17.622794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '884d0012-3c23-49d9-a692-a6cd647c1932', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff331763090>]}
[0m15:33:17.694348 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt_project/target/manifest.json
[0m15:33:17.702005 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt_project/target/semantic_manifest.json
[0m15:33:17.741556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '884d0012-3c23-49d9-a692-a6cd647c1932', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff330f78550>]}
[0m15:33:17.743188 [info ] [MainThread]: Found 3 models, 434 macros
[0m15:33:17.744883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '884d0012-3c23-49d9-a692-a6cd647c1932', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff330f09cd0>]}
[0m15:33:17.748212 [info ] [MainThread]: 
[0m15:33:17.749890 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:33:17.751656 [info ] [MainThread]: 
[0m15:33:17.753593 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:33:17.760766 [debug] [ThreadPool]: Acquiring new postgres connection 'list_social_analytics'
[0m15:33:17.922478 [debug] [ThreadPool]: Using postgres connection "list_social_analytics"
[0m15:33:17.924105 [debug] [ThreadPool]: On list_social_analytics: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "connection_name": "list_social_analytics"} */

    select distinct nspname from pg_namespace
  
[0m15:33:17.925748 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:33:17.966675 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.041 seconds
[0m15:33:17.969201 [debug] [ThreadPool]: On list_social_analytics: Close
[0m15:33:17.971151 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_social_analytics, now create_social_analytics_analytics_analytics)
[0m15:33:17.972616 [debug] [ThreadPool]: Creating schema "database: "social_analytics"
schema: "analytics_analytics"
"
[0m15:33:17.979026 [debug] [ThreadPool]: Using postgres connection "create_social_analytics_analytics_analytics"
[0m15:33:17.981063 [debug] [ThreadPool]: On create_social_analytics_analytics_analytics: BEGIN
[0m15:33:17.982434 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:33:17.989770 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m15:33:17.991529 [debug] [ThreadPool]: Using postgres connection "create_social_analytics_analytics_analytics"
[0m15:33:17.992740 [debug] [ThreadPool]: On create_social_analytics_analytics_analytics: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "connection_name": "create_social_analytics_analytics_analytics"} */
create schema if not exists "analytics_analytics"
[0m15:33:17.997804 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.004 seconds
[0m15:33:17.999909 [debug] [ThreadPool]: On create_social_analytics_analytics_analytics: COMMIT
[0m15:33:18.001449 [debug] [ThreadPool]: Using postgres connection "create_social_analytics_analytics_analytics"
[0m15:33:18.002971 [debug] [ThreadPool]: On create_social_analytics_analytics_analytics: COMMIT
[0m15:33:18.007015 [debug] [ThreadPool]: SQL status: COMMIT in 0.003 seconds
[0m15:33:18.008972 [debug] [ThreadPool]: On create_social_analytics_analytics_analytics: Close
[0m15:33:18.012188 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_social_analytics_analytics_analytics, now list_social_analytics_analytics_analytics)
[0m15:33:18.019681 [debug] [ThreadPool]: Using postgres connection "list_social_analytics_analytics_analytics"
[0m15:33:18.021295 [debug] [ThreadPool]: On list_social_analytics_analytics_analytics: BEGIN
[0m15:33:18.022905 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:33:18.031606 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m15:33:18.033163 [debug] [ThreadPool]: Using postgres connection "list_social_analytics_analytics_analytics"
[0m15:33:18.034286 [debug] [ThreadPool]: On list_social_analytics_analytics_analytics: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "connection_name": "list_social_analytics_analytics_analytics"} */
select
      'social_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'social_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'social_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics'
  
[0m15:33:18.051415 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.016 seconds
[0m15:33:18.053567 [debug] [ThreadPool]: On list_social_analytics_analytics_analytics: ROLLBACK
[0m15:33:18.054797 [debug] [ThreadPool]: On list_social_analytics_analytics_analytics: Close
[0m15:33:18.061071 [debug] [MainThread]: Using postgres connection "master"
[0m15:33:18.062527 [debug] [MainThread]: On master: BEGIN
[0m15:33:18.063603 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:33:18.070021 [debug] [MainThread]: SQL status: BEGIN in 0.006 seconds
[0m15:33:18.071489 [debug] [MainThread]: Using postgres connection "master"
[0m15:33:18.072528 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:33:18.082928 [debug] [MainThread]: SQL status: SELECT 0 in 0.009 seconds
[0m15:33:18.084936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '884d0012-3c23-49d9-a692-a6cd647c1932', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3338f1210>]}
[0m15:33:18.086141 [debug] [MainThread]: On master: ROLLBACK
[0m15:33:18.087287 [debug] [MainThread]: Using postgres connection "master"
[0m15:33:18.088370 [debug] [MainThread]: On master: BEGIN
[0m15:33:18.089636 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m15:33:18.090651 [debug] [MainThread]: On master: COMMIT
[0m15:33:18.091621 [debug] [MainThread]: Using postgres connection "master"
[0m15:33:18.092614 [debug] [MainThread]: On master: COMMIT
[0m15:33:18.093599 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:33:18.094526 [debug] [MainThread]: On master: Close
[0m15:33:18.100595 [debug] [Thread-1 (]: Began running node model.social_analytics.stg_posts
[0m15:33:18.101875 [info ] [Thread-1 (]: 1 of 3 START sql view model analytics_analytics.stg_posts ...................... [RUN]
[0m15:33:18.103266 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_social_analytics_analytics_analytics, now model.social_analytics.stg_posts)
[0m15:33:18.104489 [debug] [Thread-1 (]: Began compiling node model.social_analytics.stg_posts
[0m15:33:18.113177 [debug] [Thread-1 (]: Writing injected SQL for node "model.social_analytics.stg_posts"
[0m15:33:18.121352 [debug] [Thread-1 (]: Began executing node model.social_analytics.stg_posts
[0m15:33:18.156961 [debug] [Thread-1 (]: Writing runtime sql for node "model.social_analytics.stg_posts"
[0m15:33:18.164745 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.stg_posts"
[0m15:33:18.166113 [debug] [Thread-1 (]: On model.social_analytics.stg_posts: BEGIN
[0m15:33:18.167366 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:33:18.176602 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m15:33:18.178085 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.stg_posts"
[0m15:33:18.179221 [debug] [Thread-1 (]: On model.social_analytics.stg_posts: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.stg_posts"} */

  create view "social_analytics"."analytics_analytics"."stg_posts__dbt_tmp"
    
    
  as (
    

select
    id,
    platform,
    platform_post_id,
    author_name,
    content_text,
    content_url,
    coalesce(like_count, 0) as like_count,
    coalesce(comment_count, 0) as comment_count,
    coalesce(share_count, 0) as share_count,
    posted_at_utc,
    collected_at_utc
from public.posts;
  );
[0m15:33:18.181250 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 21: from public.posts;
                          ^

[0m15:33:18.182704 [debug] [Thread-1 (]: On model.social_analytics.stg_posts: ROLLBACK
[0m15:33:18.183931 [debug] [Thread-1 (]: On model.social_analytics.stg_posts: Close
[0m15:33:18.191402 [debug] [Thread-1 (]: Database Error in model stg_posts (models/stg_posts.sql)
  syntax error at or near ";"
  LINE 21: from public.posts;
                            ^
  compiled code at target/run/social_analytics/models/stg_posts.sql
[0m15:33:18.194404 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '884d0012-3c23-49d9-a692-a6cd647c1932', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3228c9650>]}
[0m15:33:18.195960 [error] [Thread-1 (]: 1 of 3 ERROR creating sql view model analytics_analytics.stg_posts ............. [[31mERROR[0m in 0.09s]
[0m15:33:18.197683 [debug] [Thread-1 (]: Finished running node model.social_analytics.stg_posts
[0m15:33:18.199725 [debug] [Thread-4 (]: Marking all children of 'model.social_analytics.stg_posts' to be skipped because of status 'error'.  Reason: Database Error in model stg_posts (models/stg_posts.sql)
  syntax error at or near ";"
  LINE 21: from public.posts;
                            ^
  compiled code at target/run/social_analytics/models/stg_posts.sql.
[0m15:33:18.202456 [debug] [Thread-1 (]: Began running node model.social_analytics.fct_daily_metrics
[0m15:33:18.203785 [info ] [Thread-1 (]: 2 of 3 SKIP relation analytics_analytics.fct_daily_metrics ..................... [[33mSKIP[0m]
[0m15:33:18.205013 [debug] [Thread-1 (]: Finished running node model.social_analytics.fct_daily_metrics
[0m15:33:18.206312 [debug] [Thread-1 (]: Began running node model.social_analytics.top_posts
[0m15:33:18.207470 [info ] [Thread-1 (]: 3 of 3 SKIP relation analytics_analytics.top_posts ............................. [[33mSKIP[0m]
[0m15:33:18.208914 [debug] [Thread-1 (]: Finished running node model.social_analytics.top_posts
[0m15:33:18.211792 [debug] [MainThread]: Using postgres connection "master"
[0m15:33:18.213389 [debug] [MainThread]: On master: BEGIN
[0m15:33:18.214558 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:33:18.221921 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m15:33:18.223245 [debug] [MainThread]: On master: COMMIT
[0m15:33:18.224428 [debug] [MainThread]: Using postgres connection "master"
[0m15:33:18.225604 [debug] [MainThread]: On master: COMMIT
[0m15:33:18.226848 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:33:18.227849 [debug] [MainThread]: On master: Close
[0m15:33:18.229092 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:33:18.230432 [debug] [MainThread]: Connection 'model.social_analytics.stg_posts' was properly closed.
[0m15:33:18.232244 [info ] [MainThread]: 
[0m15:33:18.233628 [info ] [MainThread]: Finished running 2 table models, 1 view model in 0 hours 0 minutes and 0.48 seconds (0.48s).
[0m15:33:18.236093 [debug] [MainThread]: Command end result
[0m15:33:18.276396 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt_project/target/manifest.json
[0m15:33:18.282864 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt_project/target/semantic_manifest.json
[0m15:33:18.294643 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt_project/target/run_results.json
[0m15:33:18.296031 [info ] [MainThread]: 
[0m15:33:18.297366 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:33:18.298787 [info ] [MainThread]: 
[0m15:33:18.300261 [error] [MainThread]: [31mFailure in model stg_posts (models/stg_posts.sql)[0m
[0m15:33:18.301630 [error] [MainThread]:   Database Error in model stg_posts (models/stg_posts.sql)
  syntax error at or near ";"
  LINE 21: from public.posts;
                            ^
  compiled code at target/run/social_analytics/models/stg_posts.sql
[0m15:33:18.302832 [info ] [MainThread]: 
[0m15:33:18.304364 [info ] [MainThread]:   compiled code at target/compiled/social_analytics/models/stg_posts.sql
[0m15:33:18.305958 [info ] [MainThread]: 
[0m15:33:18.307605 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=2 NO-OP=0 TOTAL=3
[0m15:33:18.311586 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.6279176, "process_in_blocks": "95704", "process_kernel_time": 1.03354, "process_mem_max_rss": "129444", "process_out_blocks": "8", "process_user_time": 2.782609}
[0m15:33:18.313259 [debug] [MainThread]: Command `dbt run` failed at 15:33:18.313113 after 1.63 seconds
[0m15:33:18.314368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3378080d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff332ff3b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff333182250>]}
[0m15:33:18.315637 [debug] [MainThread]: Flushing usage events
[0m15:33:19.387005 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:33:54.732241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55daf72e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55db736310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55dae73190>]}


============================== 15:33:54.737719 | e1cb9f1d-f4f5-4838-9df3-0b33c38fbf74 ==============================
[0m15:33:54.737719 [info ] [MainThread]: Running with dbt=1.10.9
[0m15:33:54.739406 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'use_experimental_parser': 'False', 'introspect': 'True', 'empty': 'False', 'no_print': 'None', 'log_format': 'default', 'debug': 'False', 'target_path': 'None', 'version_check': 'True', 'indirect_selection': 'eager', 'use_colors': 'True', 'partial_parse': 'True', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'write_json': 'True', 'invocation_command': 'dbt run', 'quiet': 'False', 'printer_width': '80', 'warn_error': 'None', 'log_cache_events': 'False', 'fail_fast': 'False', 'log_path': '/app/dbt_project/logs', 'profiles_dir': '/app', 'static_parser': 'True'}
[0m15:33:54.904773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e1cb9f1d-f4f5-4838-9df3-0b33c38fbf74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55da501d50>]}
[0m15:33:54.963568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e1cb9f1d-f4f5-4838-9df3-0b33c38fbf74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55dd9bd290>]}
[0m15:33:54.965674 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:33:55.066376 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m15:33:55.226672 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:33:55.228728 [debug] [MainThread]: Partial parsing: updated file: social_analytics://models/stg_posts.sql
[0m15:33:55.472534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e1cb9f1d-f4f5-4838-9df3-0b33c38fbf74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55da5cb5d0>]}
[0m15:33:55.541531 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt_project/target/manifest.json
[0m15:33:55.548195 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt_project/target/semantic_manifest.json
[0m15:33:55.574813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e1cb9f1d-f4f5-4838-9df3-0b33c38fbf74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55d91351d0>]}
[0m15:33:55.576570 [info ] [MainThread]: Found 3 models, 434 macros
[0m15:33:55.577951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e1cb9f1d-f4f5-4838-9df3-0b33c38fbf74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55d91025d0>]}
[0m15:33:55.580556 [info ] [MainThread]: 
[0m15:33:55.582045 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:33:55.583848 [info ] [MainThread]: 
[0m15:33:55.586028 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:33:55.593273 [debug] [ThreadPool]: Acquiring new postgres connection 'list_social_analytics'
[0m15:33:55.723641 [debug] [ThreadPool]: Using postgres connection "list_social_analytics"
[0m15:33:55.724985 [debug] [ThreadPool]: On list_social_analytics: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "connection_name": "list_social_analytics"} */

    select distinct nspname from pg_namespace
  
[0m15:33:55.726012 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:33:55.734801 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.009 seconds
[0m15:33:55.737204 [debug] [ThreadPool]: On list_social_analytics: Close
[0m15:33:55.739736 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_social_analytics, now list_social_analytics_analytics_analytics)
[0m15:33:55.746657 [debug] [ThreadPool]: Using postgres connection "list_social_analytics_analytics_analytics"
[0m15:33:55.747825 [debug] [ThreadPool]: On list_social_analytics_analytics_analytics: BEGIN
[0m15:33:55.748815 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:33:55.755323 [debug] [ThreadPool]: SQL status: BEGIN in 0.006 seconds
[0m15:33:55.756871 [debug] [ThreadPool]: Using postgres connection "list_social_analytics_analytics_analytics"
[0m15:33:55.758169 [debug] [ThreadPool]: On list_social_analytics_analytics_analytics: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "connection_name": "list_social_analytics_analytics_analytics"} */
select
      'social_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'social_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'social_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics'
  
[0m15:33:55.762454 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.003 seconds
[0m15:33:55.765064 [debug] [ThreadPool]: On list_social_analytics_analytics_analytics: ROLLBACK
[0m15:33:55.766385 [debug] [ThreadPool]: On list_social_analytics_analytics_analytics: Close
[0m15:33:55.772127 [debug] [MainThread]: Using postgres connection "master"
[0m15:33:55.773300 [debug] [MainThread]: On master: BEGIN
[0m15:33:55.774283 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:33:55.781877 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m15:33:55.783222 [debug] [MainThread]: Using postgres connection "master"
[0m15:33:55.784362 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:33:55.789324 [debug] [MainThread]: SQL status: SELECT 0 in 0.004 seconds
[0m15:33:55.791272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e1cb9f1d-f4f5-4838-9df3-0b33c38fbf74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55dae352d0>]}
[0m15:33:55.792411 [debug] [MainThread]: On master: ROLLBACK
[0m15:33:55.793498 [debug] [MainThread]: Using postgres connection "master"
[0m15:33:55.794632 [debug] [MainThread]: On master: BEGIN
[0m15:33:55.796085 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m15:33:55.797298 [debug] [MainThread]: On master: COMMIT
[0m15:33:55.798794 [debug] [MainThread]: Using postgres connection "master"
[0m15:33:55.800234 [debug] [MainThread]: On master: COMMIT
[0m15:33:55.801884 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:33:55.802828 [debug] [MainThread]: On master: Close
[0m15:33:55.807720 [debug] [Thread-1 (]: Began running node model.social_analytics.stg_posts
[0m15:33:55.809026 [info ] [Thread-1 (]: 1 of 3 START sql view model analytics_analytics.stg_posts ...................... [RUN]
[0m15:33:55.810437 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_social_analytics_analytics_analytics, now model.social_analytics.stg_posts)
[0m15:33:55.811517 [debug] [Thread-1 (]: Began compiling node model.social_analytics.stg_posts
[0m15:33:55.820770 [debug] [Thread-1 (]: Writing injected SQL for node "model.social_analytics.stg_posts"
[0m15:33:55.829647 [debug] [Thread-1 (]: Began executing node model.social_analytics.stg_posts
[0m15:33:55.865601 [debug] [Thread-1 (]: Writing runtime sql for node "model.social_analytics.stg_posts"
[0m15:33:55.874192 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.stg_posts"
[0m15:33:55.875628 [debug] [Thread-1 (]: On model.social_analytics.stg_posts: BEGIN
[0m15:33:55.876728 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:33:55.884572 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m15:33:55.885896 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.stg_posts"
[0m15:33:55.887053 [debug] [Thread-1 (]: On model.social_analytics.stg_posts: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.stg_posts"} */

  create view "social_analytics"."analytics_analytics"."stg_posts__dbt_tmp"
    
    
  as (
    

select
    id,
    platform,
    platform_post_id,
    author_name,
    content_text,
    content_url,
    coalesce(like_count, 0) as like_count,
    coalesce(comment_count, 0) as comment_count,
    coalesce(share_count, 0) as share_count,
    posted_at_utc,
    collected_at_utc
from public.posts
  );
[0m15:33:55.901408 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.013 seconds
[0m15:33:55.908691 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.stg_posts"
[0m15:33:55.910312 [debug] [Thread-1 (]: On model.social_analytics.stg_posts: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.stg_posts"} */
alter table "social_analytics"."analytics_analytics"."stg_posts__dbt_tmp" rename to "stg_posts"
[0m15:33:55.911865 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:33:55.926459 [debug] [Thread-1 (]: On model.social_analytics.stg_posts: COMMIT
[0m15:33:55.927951 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.stg_posts"
[0m15:33:55.928945 [debug] [Thread-1 (]: On model.social_analytics.stg_posts: COMMIT
[0m15:33:55.931968 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m15:33:55.938762 [debug] [Thread-1 (]: Applying DROP to: "social_analytics"."analytics_analytics"."stg_posts__dbt_backup"
[0m15:33:55.944183 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.stg_posts"
[0m15:33:55.945268 [debug] [Thread-1 (]: On model.social_analytics.stg_posts: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.stg_posts"} */
drop view if exists "social_analytics"."analytics_analytics"."stg_posts__dbt_backup" cascade
[0m15:33:55.947198 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.001 seconds
[0m15:33:55.950325 [debug] [Thread-1 (]: On model.social_analytics.stg_posts: Close
[0m15:33:55.953182 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1cb9f1d-f4f5-4838-9df3-0b33c38fbf74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55d9d61e50>]}
[0m15:33:55.954648 [info ] [Thread-1 (]: 1 of 3 OK created sql view model analytics_analytics.stg_posts ................. [[32mCREATE VIEW[0m in 0.14s]
[0m15:33:55.956100 [debug] [Thread-1 (]: Finished running node model.social_analytics.stg_posts
[0m15:33:55.958116 [debug] [Thread-1 (]: Began running node model.social_analytics.fct_daily_metrics
[0m15:33:55.959550 [info ] [Thread-1 (]: 2 of 3 START sql table model analytics_analytics.fct_daily_metrics ............. [RUN]
[0m15:33:55.960809 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.social_analytics.stg_posts, now model.social_analytics.fct_daily_metrics)
[0m15:33:55.961790 [debug] [Thread-1 (]: Began compiling node model.social_analytics.fct_daily_metrics
[0m15:33:55.966174 [debug] [Thread-1 (]: Writing injected SQL for node "model.social_analytics.fct_daily_metrics"
[0m15:33:55.974871 [debug] [Thread-1 (]: Began executing node model.social_analytics.fct_daily_metrics
[0m15:33:56.001811 [debug] [Thread-1 (]: Writing runtime sql for node "model.social_analytics.fct_daily_metrics"
[0m15:33:56.011087 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.fct_daily_metrics"
[0m15:33:56.012745 [debug] [Thread-1 (]: On model.social_analytics.fct_daily_metrics: BEGIN
[0m15:33:56.014083 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:33:56.021143 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m15:33:56.022507 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.fct_daily_metrics"
[0m15:33:56.023509 [debug] [Thread-1 (]: On model.social_analytics.fct_daily_metrics: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.fct_daily_metrics"} */

  
    

  create  table "social_analytics"."analytics_analytics"."fct_daily_metrics__dbt_tmp"
  
  
    as
  
  (
    

select
    platform,
    date_trunc('day', posted_at_utc) as post_date,
    count(*) as total_posts,
    sum(like_count) as total_likes,
    sum(comment_count) as total_comments,
    sum(share_count) as total_shares
from "social_analytics"."analytics_analytics"."stg_posts"
group by platform, date_trunc('day', posted_at_utc);
  );
  
[0m15:33:56.024921 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 22: group by platform, date_trunc('day', posted_at_utc);
                                                            ^

[0m15:33:56.025941 [debug] [Thread-1 (]: On model.social_analytics.fct_daily_metrics: ROLLBACK
[0m15:33:56.027209 [debug] [Thread-1 (]: On model.social_analytics.fct_daily_metrics: Close
[0m15:33:56.031944 [debug] [Thread-1 (]: Database Error in model fct_daily_metrics (models/fct_daily_metrics.sql)
  syntax error at or near ";"
  LINE 22: group by platform, date_trunc('day', posted_at_utc);
                                                              ^
  compiled code at target/run/social_analytics/models/fct_daily_metrics.sql
[0m15:33:56.033328 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1cb9f1d-f4f5-4838-9df3-0b33c38fbf74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55ca64fd90>]}
[0m15:33:56.034703 [error] [Thread-1 (]: 2 of 3 ERROR creating sql table model analytics_analytics.fct_daily_metrics .... [[31mERROR[0m in 0.07s]
[0m15:33:56.036065 [debug] [Thread-1 (]: Finished running node model.social_analytics.fct_daily_metrics
[0m15:33:56.037249 [debug] [Thread-1 (]: Began running node model.social_analytics.top_posts
[0m15:33:56.037752 [debug] [Thread-4 (]: Marking all children of 'model.social_analytics.fct_daily_metrics' to be skipped because of status 'error'.  Reason: Database Error in model fct_daily_metrics (models/fct_daily_metrics.sql)
  syntax error at or near ";"
  LINE 22: group by platform, date_trunc('day', posted_at_utc);
                                                              ^
  compiled code at target/run/social_analytics/models/fct_daily_metrics.sql.
[0m15:33:56.038610 [info ] [Thread-1 (]: 3 of 3 START sql table model analytics_analytics.top_posts ..................... [RUN]
[0m15:33:56.041186 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.social_analytics.fct_daily_metrics, now model.social_analytics.top_posts)
[0m15:33:56.042026 [debug] [Thread-1 (]: Began compiling node model.social_analytics.top_posts
[0m15:33:56.046726 [debug] [Thread-1 (]: Writing injected SQL for node "model.social_analytics.top_posts"
[0m15:33:56.054281 [debug] [Thread-1 (]: Began executing node model.social_analytics.top_posts
[0m15:33:56.059091 [debug] [Thread-1 (]: Writing runtime sql for node "model.social_analytics.top_posts"
[0m15:33:56.067413 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.top_posts"
[0m15:33:56.068777 [debug] [Thread-1 (]: On model.social_analytics.top_posts: BEGIN
[0m15:33:56.070239 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:33:56.077233 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m15:33:56.078598 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.top_posts"
[0m15:33:56.079652 [debug] [Thread-1 (]: On model.social_analytics.top_posts: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.top_posts"} */

  
    

  create  table "social_analytics"."analytics_analytics"."top_posts__dbt_tmp"
  
  
    as
  
  (
    

select
    platform,
    platform_post_id,
    author_name,
    content_text,
    content_url,
    like_count,
    comment_count,
    share_count,
    (like_count + comment_count + share_count) as engagement_score,
    posted_at_utc
from "social_analytics"."analytics_analytics"."stg_posts"
where posted_at_utc is not null
order by engagement_score desc
limit 20;
  );
  
[0m15:33:56.081102 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ";"
LINE 28: limit 20;
                 ^

[0m15:33:56.082252 [debug] [Thread-1 (]: On model.social_analytics.top_posts: ROLLBACK
[0m15:33:56.083612 [debug] [Thread-1 (]: On model.social_analytics.top_posts: Close
[0m15:33:56.087273 [debug] [Thread-1 (]: Database Error in model top_posts (models/top_posts.sql)
  syntax error at or near ";"
  LINE 28: limit 20;
                   ^
  compiled code at target/run/social_analytics/models/top_posts.sql
[0m15:33:56.088698 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e1cb9f1d-f4f5-4838-9df3-0b33c38fbf74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55ca635050>]}
[0m15:33:56.090219 [error] [Thread-1 (]: 3 of 3 ERROR creating sql table model analytics_analytics.top_posts ............ [[31mERROR[0m in 0.05s]
[0m15:33:56.092258 [debug] [Thread-1 (]: Finished running node model.social_analytics.top_posts
[0m15:33:56.093716 [debug] [Thread-4 (]: Marking all children of 'model.social_analytics.top_posts' to be skipped because of status 'error'.  Reason: Database Error in model top_posts (models/top_posts.sql)
  syntax error at or near ";"
  LINE 28: limit 20;
                   ^
  compiled code at target/run/social_analytics/models/top_posts.sql.
[0m15:33:56.095906 [debug] [MainThread]: Using postgres connection "master"
[0m15:33:56.096867 [debug] [MainThread]: On master: BEGIN
[0m15:33:56.097729 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:33:56.105016 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m15:33:56.106395 [debug] [MainThread]: On master: COMMIT
[0m15:33:56.107695 [debug] [MainThread]: Using postgres connection "master"
[0m15:33:56.108813 [debug] [MainThread]: On master: COMMIT
[0m15:33:56.110394 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:33:56.111617 [debug] [MainThread]: On master: Close
[0m15:33:56.112732 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:33:56.113663 [debug] [MainThread]: Connection 'model.social_analytics.top_posts' was properly closed.
[0m15:33:56.114752 [info ] [MainThread]: 
[0m15:33:56.115806 [info ] [MainThread]: Finished running 2 table models, 1 view model in 0 hours 0 minutes and 0.53 seconds (0.53s).
[0m15:33:56.117885 [debug] [MainThread]: Command end result
[0m15:33:56.151680 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt_project/target/manifest.json
[0m15:33:56.158294 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt_project/target/semantic_manifest.json
[0m15:33:56.169671 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt_project/target/run_results.json
[0m15:33:56.171031 [info ] [MainThread]: 
[0m15:33:56.172453 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m15:33:56.173748 [info ] [MainThread]: 
[0m15:33:56.175084 [error] [MainThread]: [31mFailure in model fct_daily_metrics (models/fct_daily_metrics.sql)[0m
[0m15:33:56.176331 [error] [MainThread]:   Database Error in model fct_daily_metrics (models/fct_daily_metrics.sql)
  syntax error at or near ";"
  LINE 22: group by platform, date_trunc('day', posted_at_utc);
                                                              ^
  compiled code at target/run/social_analytics/models/fct_daily_metrics.sql
[0m15:33:56.177436 [info ] [MainThread]: 
[0m15:33:56.179137 [info ] [MainThread]:   compiled code at target/compiled/social_analytics/models/fct_daily_metrics.sql
[0m15:33:56.180673 [info ] [MainThread]: 
[0m15:33:56.182383 [error] [MainThread]: [31mFailure in model top_posts (models/top_posts.sql)[0m
[0m15:33:56.183989 [error] [MainThread]:   Database Error in model top_posts (models/top_posts.sql)
  syntax error at or near ";"
  LINE 28: limit 20;
                   ^
  compiled code at target/run/social_analytics/models/top_posts.sql
[0m15:33:56.185742 [info ] [MainThread]: 
[0m15:33:56.187342 [info ] [MainThread]:   compiled code at target/compiled/social_analytics/models/top_posts.sql
[0m15:33:56.188814 [info ] [MainThread]: 
[0m15:33:56.190139 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=2 SKIP=0 NO-OP=0 TOTAL=3
[0m15:33:56.192183 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.5221586, "process_in_blocks": "0", "process_kernel_time": 0.581827, "process_mem_max_rss": "130456", "process_out_blocks": "8", "process_user_time": 2.563986}
[0m15:33:56.193255 [debug] [MainThread]: Command `dbt run` failed at 15:33:56.193134 after 1.52 seconds
[0m15:33:56.194286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55dae3fc50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55dae91390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f55df5f40d0>]}
[0m15:33:56.195207 [debug] [MainThread]: Flushing usage events
[0m15:33:56.990537 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:34:23.773357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26626974d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26629d5c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2662696450>]}


============================== 15:34:23.780349 | 331546be-5f3a-4628-9204-495d39548b90 ==============================
[0m15:34:23.780349 [info ] [MainThread]: Running with dbt=1.10.9
[0m15:34:23.781959 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'printer_width': '80', 'target_path': 'None', 'write_json': 'True', 'cache_selected_only': 'False', 'invocation_command': 'dbt run', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'log_path': '/app/dbt_project/logs', 'log_cache_events': 'False', 'introspect': 'True', 'log_format': 'default', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/app', 'empty': 'False', 'partial_parse': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'use_colors': 'True', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'debug': 'False'}
[0m15:34:23.964558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '331546be-5f3a-4628-9204-495d39548b90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2661d02a10>]}
[0m15:34:24.023570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '331546be-5f3a-4628-9204-495d39548b90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2665209290>]}
[0m15:34:24.026026 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:34:24.106494 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m15:34:24.267266 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m15:34:24.268802 [debug] [MainThread]: Partial parsing: updated file: social_analytics://models/fct_daily_metrics.sql
[0m15:34:24.269897 [debug] [MainThread]: Partial parsing: updated file: social_analytics://models/top_posts.sql
[0m15:34:24.516445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '331546be-5f3a-4628-9204-495d39548b90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2661dc34d0>]}
[0m15:34:24.592923 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt_project/target/manifest.json
[0m15:34:24.600688 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt_project/target/semantic_manifest.json
[0m15:34:24.632174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '331546be-5f3a-4628-9204-495d39548b90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f266092eb10>]}
[0m15:34:24.633870 [info ] [MainThread]: Found 3 models, 434 macros
[0m15:34:24.635068 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '331546be-5f3a-4628-9204-495d39548b90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2664a6dad0>]}
[0m15:34:24.638170 [info ] [MainThread]: 
[0m15:34:24.639988 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:34:24.641577 [info ] [MainThread]: 
[0m15:34:24.643449 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:34:24.649999 [debug] [ThreadPool]: Acquiring new postgres connection 'list_social_analytics'
[0m15:34:24.796221 [debug] [ThreadPool]: Using postgres connection "list_social_analytics"
[0m15:34:24.797932 [debug] [ThreadPool]: On list_social_analytics: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "connection_name": "list_social_analytics"} */

    select distinct nspname from pg_namespace
  
[0m15:34:24.799161 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:34:24.810525 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.011 seconds
[0m15:34:24.813355 [debug] [ThreadPool]: On list_social_analytics: Close
[0m15:34:24.816467 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_social_analytics, now list_social_analytics_analytics_analytics)
[0m15:34:24.824527 [debug] [ThreadPool]: Using postgres connection "list_social_analytics_analytics_analytics"
[0m15:34:24.825993 [debug] [ThreadPool]: On list_social_analytics_analytics_analytics: BEGIN
[0m15:34:24.827150 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:34:24.833775 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m15:34:24.835520 [debug] [ThreadPool]: Using postgres connection "list_social_analytics_analytics_analytics"
[0m15:34:24.836812 [debug] [ThreadPool]: On list_social_analytics_analytics_analytics: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "connection_name": "list_social_analytics_analytics_analytics"} */
select
      'social_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'social_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'social_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics'
  
[0m15:34:24.841361 [debug] [ThreadPool]: SQL status: SELECT 1 in 0.003 seconds
[0m15:34:24.843892 [debug] [ThreadPool]: On list_social_analytics_analytics_analytics: ROLLBACK
[0m15:34:24.845340 [debug] [ThreadPool]: On list_social_analytics_analytics_analytics: Close
[0m15:34:24.851712 [debug] [MainThread]: Using postgres connection "master"
[0m15:34:24.853246 [debug] [MainThread]: On master: BEGIN
[0m15:34:24.854439 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:34:24.863532 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m15:34:24.865202 [debug] [MainThread]: Using postgres connection "master"
[0m15:34:24.866614 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:34:24.872598 [debug] [MainThread]: SQL status: SELECT 1 in 0.004 seconds
[0m15:34:24.874686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '331546be-5f3a-4628-9204-495d39548b90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26652def50>]}
[0m15:34:24.875820 [debug] [MainThread]: On master: ROLLBACK
[0m15:34:24.877161 [debug] [MainThread]: Using postgres connection "master"
[0m15:34:24.878096 [debug] [MainThread]: On master: BEGIN
[0m15:34:24.879271 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m15:34:24.880224 [debug] [MainThread]: On master: COMMIT
[0m15:34:24.881065 [debug] [MainThread]: Using postgres connection "master"
[0m15:34:24.881907 [debug] [MainThread]: On master: COMMIT
[0m15:34:24.882856 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:34:24.883833 [debug] [MainThread]: On master: Close
[0m15:34:24.887921 [debug] [Thread-1 (]: Began running node model.social_analytics.stg_posts
[0m15:34:24.889181 [info ] [Thread-1 (]: 1 of 3 START sql view model analytics_analytics.stg_posts ...................... [RUN]
[0m15:34:24.890844 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_social_analytics_analytics_analytics, now model.social_analytics.stg_posts)
[0m15:34:24.891962 [debug] [Thread-1 (]: Began compiling node model.social_analytics.stg_posts
[0m15:34:24.900275 [debug] [Thread-1 (]: Writing injected SQL for node "model.social_analytics.stg_posts"
[0m15:34:24.909273 [debug] [Thread-1 (]: Began executing node model.social_analytics.stg_posts
[0m15:34:24.944593 [debug] [Thread-1 (]: Writing runtime sql for node "model.social_analytics.stg_posts"
[0m15:34:24.953190 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.stg_posts"
[0m15:34:24.954429 [debug] [Thread-1 (]: On model.social_analytics.stg_posts: BEGIN
[0m15:34:24.955320 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:34:24.962411 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m15:34:24.963632 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.stg_posts"
[0m15:34:24.964851 [debug] [Thread-1 (]: On model.social_analytics.stg_posts: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.stg_posts"} */

  create view "social_analytics"."analytics_analytics"."stg_posts__dbt_tmp"
    
    
  as (
    

select
    id,
    platform,
    platform_post_id,
    author_name,
    content_text,
    content_url,
    coalesce(like_count, 0) as like_count,
    coalesce(comment_count, 0) as comment_count,
    coalesce(share_count, 0) as share_count,
    posted_at_utc,
    collected_at_utc
from public.posts
  );
[0m15:34:24.968276 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m15:34:24.975413 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.stg_posts"
[0m15:34:24.976699 [debug] [Thread-1 (]: On model.social_analytics.stg_posts: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.stg_posts"} */
alter table "social_analytics"."analytics_analytics"."stg_posts" rename to "stg_posts__dbt_backup"
[0m15:34:24.978455 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:34:24.982295 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.stg_posts"
[0m15:34:24.983366 [debug] [Thread-1 (]: On model.social_analytics.stg_posts: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.stg_posts"} */
alter table "social_analytics"."analytics_analytics"."stg_posts__dbt_tmp" rename to "stg_posts"
[0m15:34:24.984790 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:34:25.000755 [debug] [Thread-1 (]: On model.social_analytics.stg_posts: COMMIT
[0m15:34:25.002545 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.stg_posts"
[0m15:34:25.003798 [debug] [Thread-1 (]: On model.social_analytics.stg_posts: COMMIT
[0m15:34:25.007293 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m15:34:25.015170 [debug] [Thread-1 (]: Applying DROP to: "social_analytics"."analytics_analytics"."stg_posts__dbt_backup"
[0m15:34:25.021141 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.stg_posts"
[0m15:34:25.022338 [debug] [Thread-1 (]: On model.social_analytics.stg_posts: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.stg_posts"} */
drop view if exists "social_analytics"."analytics_analytics"."stg_posts__dbt_backup" cascade
[0m15:34:25.031879 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.008 seconds
[0m15:34:25.035318 [debug] [Thread-1 (]: On model.social_analytics.stg_posts: Close
[0m15:34:25.038063 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '331546be-5f3a-4628-9204-495d39548b90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f265df15a50>]}
[0m15:34:25.039518 [info ] [Thread-1 (]: 1 of 3 OK created sql view model analytics_analytics.stg_posts ................. [[32mCREATE VIEW[0m in 0.15s]
[0m15:34:25.040957 [debug] [Thread-1 (]: Finished running node model.social_analytics.stg_posts
[0m15:34:25.042768 [debug] [Thread-1 (]: Began running node model.social_analytics.fct_daily_metrics
[0m15:34:25.044219 [info ] [Thread-1 (]: 2 of 3 START sql table model analytics_analytics.fct_daily_metrics ............. [RUN]
[0m15:34:25.045505 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.social_analytics.stg_posts, now model.social_analytics.fct_daily_metrics)
[0m15:34:25.046537 [debug] [Thread-1 (]: Began compiling node model.social_analytics.fct_daily_metrics
[0m15:34:25.050388 [debug] [Thread-1 (]: Writing injected SQL for node "model.social_analytics.fct_daily_metrics"
[0m15:34:25.057919 [debug] [Thread-1 (]: Began executing node model.social_analytics.fct_daily_metrics
[0m15:34:25.085638 [debug] [Thread-1 (]: Writing runtime sql for node "model.social_analytics.fct_daily_metrics"
[0m15:34:25.093763 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.fct_daily_metrics"
[0m15:34:25.095062 [debug] [Thread-1 (]: On model.social_analytics.fct_daily_metrics: BEGIN
[0m15:34:25.096189 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:34:25.103194 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m15:34:25.104885 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.fct_daily_metrics"
[0m15:34:25.106145 [debug] [Thread-1 (]: On model.social_analytics.fct_daily_metrics: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.fct_daily_metrics"} */

  
    

  create  table "social_analytics"."analytics_analytics"."fct_daily_metrics__dbt_tmp"
  
  
    as
  
  (
    

select
    platform,
    date_trunc('day', posted_at_utc) as post_date,
    count(*) as total_posts,
    sum(like_count) as total_likes,
    sum(comment_count) as total_comments,
    sum(share_count) as total_shares
from "social_analytics"."analytics_analytics"."stg_posts"
group by platform, date_trunc('day', posted_at_utc)
  );
  
[0m15:34:25.125960 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.019 seconds
[0m15:34:25.133763 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.fct_daily_metrics"
[0m15:34:25.134909 [debug] [Thread-1 (]: On model.social_analytics.fct_daily_metrics: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.fct_daily_metrics"} */
alter table "social_analytics"."analytics_analytics"."fct_daily_metrics__dbt_tmp" rename to "fct_daily_metrics"
[0m15:34:25.136646 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:34:25.138943 [debug] [Thread-1 (]: On model.social_analytics.fct_daily_metrics: COMMIT
[0m15:34:25.139960 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.fct_daily_metrics"
[0m15:34:25.140889 [debug] [Thread-1 (]: On model.social_analytics.fct_daily_metrics: COMMIT
[0m15:34:25.143479 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m15:34:25.146607 [debug] [Thread-1 (]: Applying DROP to: "social_analytics"."analytics_analytics"."fct_daily_metrics__dbt_backup"
[0m15:34:25.149926 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.fct_daily_metrics"
[0m15:34:25.150956 [debug] [Thread-1 (]: On model.social_analytics.fct_daily_metrics: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.fct_daily_metrics"} */
drop table if exists "social_analytics"."analytics_analytics"."fct_daily_metrics__dbt_backup" cascade
[0m15:34:25.152435 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m15:34:25.154648 [debug] [Thread-1 (]: On model.social_analytics.fct_daily_metrics: Close
[0m15:34:25.155878 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '331546be-5f3a-4628-9204-495d39548b90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f265df25fd0>]}
[0m15:34:25.157481 [info ] [Thread-1 (]: 2 of 3 OK created sql table model analytics_analytics.fct_daily_metrics ........ [[32mSELECT 8[0m in 0.11s]
[0m15:34:25.159296 [debug] [Thread-1 (]: Finished running node model.social_analytics.fct_daily_metrics
[0m15:34:25.160316 [debug] [Thread-1 (]: Began running node model.social_analytics.top_posts
[0m15:34:25.161423 [info ] [Thread-1 (]: 3 of 3 START sql table model analytics_analytics.top_posts ..................... [RUN]
[0m15:34:25.162608 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.social_analytics.fct_daily_metrics, now model.social_analytics.top_posts)
[0m15:34:25.163679 [debug] [Thread-1 (]: Began compiling node model.social_analytics.top_posts
[0m15:34:25.167704 [debug] [Thread-1 (]: Writing injected SQL for node "model.social_analytics.top_posts"
[0m15:34:25.176054 [debug] [Thread-1 (]: Began executing node model.social_analytics.top_posts
[0m15:34:25.181018 [debug] [Thread-1 (]: Writing runtime sql for node "model.social_analytics.top_posts"
[0m15:34:25.189310 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.top_posts"
[0m15:34:25.190644 [debug] [Thread-1 (]: On model.social_analytics.top_posts: BEGIN
[0m15:34:25.191753 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:34:25.199686 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m15:34:25.200983 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.top_posts"
[0m15:34:25.201970 [debug] [Thread-1 (]: On model.social_analytics.top_posts: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.top_posts"} */

  
    

  create  table "social_analytics"."analytics_analytics"."top_posts__dbt_tmp"
  
  
    as
  
  (
    

select
    platform,
    platform_post_id,
    author_name,
    content_text,
    content_url,
    like_count,
    comment_count,
    share_count,
    (like_count + comment_count + share_count) as engagement_score,
    posted_at_utc
from "social_analytics"."analytics_analytics"."stg_posts"
where posted_at_utc is not null
order by engagement_score desc
limit 20
  );
  
[0m15:34:25.211280 [debug] [Thread-1 (]: SQL status: SELECT 10 in 0.008 seconds
[0m15:34:25.215800 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.top_posts"
[0m15:34:25.217198 [debug] [Thread-1 (]: On model.social_analytics.top_posts: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.top_posts"} */
alter table "social_analytics"."analytics_analytics"."top_posts__dbt_tmp" rename to "top_posts"
[0m15:34:25.218611 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:34:25.220815 [debug] [Thread-1 (]: On model.social_analytics.top_posts: COMMIT
[0m15:34:25.221808 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.top_posts"
[0m15:34:25.222670 [debug] [Thread-1 (]: On model.social_analytics.top_posts: COMMIT
[0m15:34:25.225228 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m15:34:25.228760 [debug] [Thread-1 (]: Applying DROP to: "social_analytics"."analytics_analytics"."top_posts__dbt_backup"
[0m15:34:25.230516 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.top_posts"
[0m15:34:25.231543 [debug] [Thread-1 (]: On model.social_analytics.top_posts: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.top_posts"} */
drop table if exists "social_analytics"."analytics_analytics"."top_posts__dbt_backup" cascade
[0m15:34:25.232982 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m15:34:25.235217 [debug] [Thread-1 (]: On model.social_analytics.top_posts: Close
[0m15:34:25.236438 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '331546be-5f3a-4628-9204-495d39548b90', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2661dd2450>]}
[0m15:34:25.238104 [info ] [Thread-1 (]: 3 of 3 OK created sql table model analytics_analytics.top_posts ................ [[32mSELECT 10[0m in 0.07s]
[0m15:34:25.239826 [debug] [Thread-1 (]: Finished running node model.social_analytics.top_posts
[0m15:34:25.242031 [debug] [MainThread]: Using postgres connection "master"
[0m15:34:25.243083 [debug] [MainThread]: On master: BEGIN
[0m15:34:25.243986 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:34:25.251203 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m15:34:25.252439 [debug] [MainThread]: On master: COMMIT
[0m15:34:25.253330 [debug] [MainThread]: Using postgres connection "master"
[0m15:34:25.254178 [debug] [MainThread]: On master: COMMIT
[0m15:34:25.255191 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:34:25.256052 [debug] [MainThread]: On master: Close
[0m15:34:25.257108 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:34:25.258041 [debug] [MainThread]: Connection 'model.social_analytics.top_posts' was properly closed.
[0m15:34:25.259557 [info ] [MainThread]: 
[0m15:34:25.261108 [info ] [MainThread]: Finished running 2 table models, 1 view model in 0 hours 0 minutes and 0.62 seconds (0.62s).
[0m15:34:25.263493 [debug] [MainThread]: Command end result
[0m15:34:25.299971 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt_project/target/manifest.json
[0m15:34:25.306725 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt_project/target/semantic_manifest.json
[0m15:34:25.318332 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt_project/target/run_results.json
[0m15:34:25.319600 [info ] [MainThread]: 
[0m15:34:25.321434 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:34:25.322727 [info ] [MainThread]: 
[0m15:34:25.323964 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m15:34:25.326354 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.6267549, "process_in_blocks": "0", "process_kernel_time": 0.614581, "process_mem_max_rss": "127968", "process_out_blocks": "8", "process_user_time": 2.734885}
[0m15:34:25.327935 [debug] [MainThread]: Command `dbt run` succeeded at 15:34:25.327796 after 1.63 seconds
[0m15:34:25.329216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26626f2450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f26626f0810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2666e790d0>]}
[0m15:34:25.330516 [debug] [MainThread]: Flushing usage events
[0m15:34:26.360615 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m15:39:34.636676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0519999550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0519999f90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05197cf550>]}


============================== 15:39:34.644892 | 39b6dea4-4fc2-47d0-8115-05ec908dd47e ==============================
[0m15:39:34.644892 [info ] [MainThread]: Running with dbt=1.10.9
[0m15:39:34.646748 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'empty': 'False', 'target_path': 'None', 'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'quiet': 'False', 'cache_selected_only': 'False', 'no_print': 'None', 'fail_fast': 'False', 'debug': 'False', 'warn_error': 'None', 'log_cache_events': 'False', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'static_parser': 'True', 'version_check': 'True', 'write_json': 'True', 'profiles_dir': '/app', 'invocation_command': 'dbt run', 'partial_parse': 'True', 'log_path': '/app/dbt_project/logs', 'send_anonymous_usage_stats': 'True', 'introspect': 'True', 'printer_width': '80'}
[0m15:39:34.864110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '39b6dea4-4fc2-47d0-8115-05ec908dd47e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0518ba6d10>]}
[0m15:39:34.933470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '39b6dea4-4fc2-47d0-8115-05ec908dd47e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f051c350e10>]}
[0m15:39:34.936402 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m15:39:35.026838 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m15:39:35.251114 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:39:35.252763 [debug] [MainThread]: Partial parsing: updated file: social_analytics://models/top_posts.sql
[0m15:39:35.495575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '39b6dea4-4fc2-47d0-8115-05ec908dd47e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f051831b4d0>]}
[0m15:39:35.568216 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt_project/target/manifest.json
[0m15:39:35.575851 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt_project/target/semantic_manifest.json
[0m15:39:35.621185 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '39b6dea4-4fc2-47d0-8115-05ec908dd47e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f051770d1d0>]}
[0m15:39:35.622645 [info ] [MainThread]: Found 3 models, 434 macros
[0m15:39:35.624169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '39b6dea4-4fc2-47d0-8115-05ec908dd47e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0518b5c190>]}
[0m15:39:35.627918 [info ] [MainThread]: 
[0m15:39:35.629689 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m15:39:35.631307 [info ] [MainThread]: 
[0m15:39:35.633340 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m15:39:35.640596 [debug] [ThreadPool]: Acquiring new postgres connection 'list_social_analytics'
[0m15:39:35.835508 [debug] [ThreadPool]: Using postgres connection "list_social_analytics"
[0m15:39:35.836963 [debug] [ThreadPool]: On list_social_analytics: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "connection_name": "list_social_analytics"} */

    select distinct nspname from pg_namespace
  
[0m15:39:35.838057 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:39:35.880965 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.043 seconds
[0m15:39:35.883452 [debug] [ThreadPool]: On list_social_analytics: Close
[0m15:39:35.886293 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_social_analytics, now list_social_analytics_analytics_analytics)
[0m15:39:35.894637 [debug] [ThreadPool]: Using postgres connection "list_social_analytics_analytics_analytics"
[0m15:39:35.895878 [debug] [ThreadPool]: On list_social_analytics_analytics_analytics: BEGIN
[0m15:39:35.897466 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:39:35.906123 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m15:39:35.907456 [debug] [ThreadPool]: Using postgres connection "list_social_analytics_analytics_analytics"
[0m15:39:35.908536 [debug] [ThreadPool]: On list_social_analytics_analytics_analytics: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "connection_name": "list_social_analytics_analytics_analytics"} */
select
      'social_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'social_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'social_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics'
  
[0m15:39:35.919774 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.010 seconds
[0m15:39:35.922362 [debug] [ThreadPool]: On list_social_analytics_analytics_analytics: ROLLBACK
[0m15:39:35.923619 [debug] [ThreadPool]: On list_social_analytics_analytics_analytics: Close
[0m15:39:35.930241 [debug] [MainThread]: Using postgres connection "master"
[0m15:39:35.931440 [debug] [MainThread]: On master: BEGIN
[0m15:39:35.932548 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:39:35.940115 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m15:39:35.941348 [debug] [MainThread]: Using postgres connection "master"
[0m15:39:35.942292 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m15:39:35.950973 [debug] [MainThread]: SQL status: SELECT 1 in 0.008 seconds
[0m15:39:35.953289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '39b6dea4-4fc2-47d0-8115-05ec908dd47e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0519878410>]}
[0m15:39:35.954491 [debug] [MainThread]: On master: ROLLBACK
[0m15:39:35.955733 [debug] [MainThread]: Using postgres connection "master"
[0m15:39:35.956654 [debug] [MainThread]: On master: BEGIN
[0m15:39:35.957782 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m15:39:35.958773 [debug] [MainThread]: On master: COMMIT
[0m15:39:35.959900 [debug] [MainThread]: Using postgres connection "master"
[0m15:39:35.960909 [debug] [MainThread]: On master: COMMIT
[0m15:39:35.961932 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:39:35.962869 [debug] [MainThread]: On master: Close
[0m15:39:35.971193 [debug] [Thread-1 (]: Began running node model.social_analytics.stg_posts
[0m15:39:35.972670 [info ] [Thread-1 (]: 1 of 3 START sql view model analytics_analytics.stg_posts ...................... [RUN]
[0m15:39:35.974603 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_social_analytics_analytics_analytics, now model.social_analytics.stg_posts)
[0m15:39:35.975792 [debug] [Thread-1 (]: Began compiling node model.social_analytics.stg_posts
[0m15:39:35.984255 [debug] [Thread-1 (]: Writing injected SQL for node "model.social_analytics.stg_posts"
[0m15:39:35.994872 [debug] [Thread-1 (]: Began executing node model.social_analytics.stg_posts
[0m15:39:36.032211 [debug] [Thread-1 (]: Writing runtime sql for node "model.social_analytics.stg_posts"
[0m15:39:36.041023 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.stg_posts"
[0m15:39:36.042240 [debug] [Thread-1 (]: On model.social_analytics.stg_posts: BEGIN
[0m15:39:36.043223 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:39:36.050319 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m15:39:36.052114 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.stg_posts"
[0m15:39:36.053420 [debug] [Thread-1 (]: On model.social_analytics.stg_posts: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.stg_posts"} */

  create view "social_analytics"."analytics_analytics"."stg_posts__dbt_tmp"
    
    
  as (
    

select
    id,
    platform,
    platform_post_id,
    author_name,
    content_text,
    content_url,
    coalesce(like_count, 0) as like_count,
    coalesce(comment_count, 0) as comment_count,
    coalesce(share_count, 0) as share_count,
    posted_at_utc,
    collected_at_utc
from public.posts
  );
[0m15:39:36.065153 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.011 seconds
[0m15:39:36.072803 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.stg_posts"
[0m15:39:36.074119 [debug] [Thread-1 (]: On model.social_analytics.stg_posts: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.stg_posts"} */
alter table "social_analytics"."analytics_analytics"."stg_posts" rename to "stg_posts__dbt_backup"
[0m15:39:36.076198 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:39:36.080171 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.stg_posts"
[0m15:39:36.081333 [debug] [Thread-1 (]: On model.social_analytics.stg_posts: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.stg_posts"} */
alter table "social_analytics"."analytics_analytics"."stg_posts__dbt_tmp" rename to "stg_posts"
[0m15:39:36.082852 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:39:36.098813 [debug] [Thread-1 (]: On model.social_analytics.stg_posts: COMMIT
[0m15:39:36.100406 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.stg_posts"
[0m15:39:36.101601 [debug] [Thread-1 (]: On model.social_analytics.stg_posts: COMMIT
[0m15:39:36.104705 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m15:39:36.111607 [debug] [Thread-1 (]: Applying DROP to: "social_analytics"."analytics_analytics"."stg_posts__dbt_backup"
[0m15:39:36.117119 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.stg_posts"
[0m15:39:36.118243 [debug] [Thread-1 (]: On model.social_analytics.stg_posts: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.stg_posts"} */
drop view if exists "social_analytics"."analytics_analytics"."stg_posts__dbt_backup" cascade
[0m15:39:36.123926 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.005 seconds
[0m15:39:36.126980 [debug] [Thread-1 (]: On model.social_analytics.stg_posts: Close
[0m15:39:36.129914 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '39b6dea4-4fc2-47d0-8115-05ec908dd47e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0515170450>]}
[0m15:39:36.131359 [info ] [Thread-1 (]: 1 of 3 OK created sql view model analytics_analytics.stg_posts ................. [[32mCREATE VIEW[0m in 0.15s]
[0m15:39:36.132814 [debug] [Thread-1 (]: Finished running node model.social_analytics.stg_posts
[0m15:39:36.134783 [debug] [Thread-1 (]: Began running node model.social_analytics.fct_daily_metrics
[0m15:39:36.135875 [info ] [Thread-1 (]: 2 of 3 START sql table model analytics_analytics.fct_daily_metrics ............. [RUN]
[0m15:39:36.137175 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.social_analytics.stg_posts, now model.social_analytics.fct_daily_metrics)
[0m15:39:36.138132 [debug] [Thread-1 (]: Began compiling node model.social_analytics.fct_daily_metrics
[0m15:39:36.142511 [debug] [Thread-1 (]: Writing injected SQL for node "model.social_analytics.fct_daily_metrics"
[0m15:39:36.151843 [debug] [Thread-1 (]: Began executing node model.social_analytics.fct_daily_metrics
[0m15:39:36.176773 [debug] [Thread-1 (]: Writing runtime sql for node "model.social_analytics.fct_daily_metrics"
[0m15:39:36.185906 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.fct_daily_metrics"
[0m15:39:36.187076 [debug] [Thread-1 (]: On model.social_analytics.fct_daily_metrics: BEGIN
[0m15:39:36.188157 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:39:36.194918 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m15:39:36.196291 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.fct_daily_metrics"
[0m15:39:36.197424 [debug] [Thread-1 (]: On model.social_analytics.fct_daily_metrics: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.fct_daily_metrics"} */

  
    

  create  table "social_analytics"."analytics_analytics"."fct_daily_metrics__dbt_tmp"
  
  
    as
  
  (
    

select
    platform,
    date_trunc('day', posted_at_utc) as post_date,
    count(*) as total_posts,
    sum(like_count) as total_likes,
    sum(comment_count) as total_comments,
    sum(share_count) as total_shares
from "social_analytics"."analytics_analytics"."stg_posts"
group by platform, date_trunc('day', posted_at_utc)
  );
  
[0m15:39:36.211022 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.012 seconds
[0m15:39:36.218972 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.fct_daily_metrics"
[0m15:39:36.220183 [debug] [Thread-1 (]: On model.social_analytics.fct_daily_metrics: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.fct_daily_metrics"} */
alter table "social_analytics"."analytics_analytics"."fct_daily_metrics" rename to "fct_daily_metrics__dbt_backup"
[0m15:39:36.222261 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:39:36.225774 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.fct_daily_metrics"
[0m15:39:36.227159 [debug] [Thread-1 (]: On model.social_analytics.fct_daily_metrics: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.fct_daily_metrics"} */
alter table "social_analytics"."analytics_analytics"."fct_daily_metrics__dbt_tmp" rename to "fct_daily_metrics"
[0m15:39:36.228931 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:39:36.230872 [debug] [Thread-1 (]: On model.social_analytics.fct_daily_metrics: COMMIT
[0m15:39:36.231765 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.fct_daily_metrics"
[0m15:39:36.232844 [debug] [Thread-1 (]: On model.social_analytics.fct_daily_metrics: COMMIT
[0m15:39:36.236189 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m15:39:36.239492 [debug] [Thread-1 (]: Applying DROP to: "social_analytics"."analytics_analytics"."fct_daily_metrics__dbt_backup"
[0m15:39:36.243039 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.fct_daily_metrics"
[0m15:39:36.244108 [debug] [Thread-1 (]: On model.social_analytics.fct_daily_metrics: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.fct_daily_metrics"} */
drop table if exists "social_analytics"."analytics_analytics"."fct_daily_metrics__dbt_backup" cascade
[0m15:39:36.258531 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.013 seconds
[0m15:39:36.260946 [debug] [Thread-1 (]: On model.social_analytics.fct_daily_metrics: Close
[0m15:39:36.262638 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '39b6dea4-4fc2-47d0-8115-05ec908dd47e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0518bb73d0>]}
[0m15:39:36.264506 [info ] [Thread-1 (]: 2 of 3 OK created sql table model analytics_analytics.fct_daily_metrics ........ [[32mSELECT 8[0m in 0.13s]
[0m15:39:36.266197 [debug] [Thread-1 (]: Finished running node model.social_analytics.fct_daily_metrics
[0m15:39:36.267598 [debug] [Thread-1 (]: Began running node model.social_analytics.top_posts
[0m15:39:36.269026 [info ] [Thread-1 (]: 3 of 3 START sql table model analytics_analytics.top_posts ..................... [RUN]
[0m15:39:36.270586 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.social_analytics.fct_daily_metrics, now model.social_analytics.top_posts)
[0m15:39:36.271723 [debug] [Thread-1 (]: Began compiling node model.social_analytics.top_posts
[0m15:39:36.275734 [debug] [Thread-1 (]: Writing injected SQL for node "model.social_analytics.top_posts"
[0m15:39:36.287082 [debug] [Thread-1 (]: Began executing node model.social_analytics.top_posts
[0m15:39:36.292456 [debug] [Thread-1 (]: Writing runtime sql for node "model.social_analytics.top_posts"
[0m15:39:36.303933 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.top_posts"
[0m15:39:36.305563 [debug] [Thread-1 (]: On model.social_analytics.top_posts: BEGIN
[0m15:39:36.306817 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:39:36.313808 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m15:39:36.315266 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.top_posts"
[0m15:39:36.316375 [debug] [Thread-1 (]: On model.social_analytics.top_posts: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.top_posts"} */

  
    

  create  table "social_analytics"."analytics_analytics"."top_posts__dbt_tmp"
  
  
    as
  
  (
    

with ranked as (
    select
        id,
        platform,
        author_name,
        content_text,
        content_url,
        (like_count + comment_count + share_count) as engagement_score,
        row_number() over (order by (like_count + comment_count + share_count) desc) as overall_rank,
        row_number() over (partition by platform order by (like_count + comment_count + share_count) desc) as platform_rank
    from "social_analytics"."analytics_analytics"."stg_posts"
)
select *
from ranked
where overall_rank <= 5
   or platform_rank <= 3
  );
  
[0m15:39:36.327621 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.010 seconds
[0m15:39:36.332197 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.top_posts"
[0m15:39:36.333578 [debug] [Thread-1 (]: On model.social_analytics.top_posts: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.top_posts"} */
alter table "social_analytics"."analytics_analytics"."top_posts" rename to "top_posts__dbt_backup"
[0m15:39:36.335328 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m15:39:36.339129 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.top_posts"
[0m15:39:36.340294 [debug] [Thread-1 (]: On model.social_analytics.top_posts: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.top_posts"} */
alter table "social_analytics"."analytics_analytics"."top_posts__dbt_tmp" rename to "top_posts"
[0m15:39:36.341743 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m15:39:36.344364 [debug] [Thread-1 (]: On model.social_analytics.top_posts: COMMIT
[0m15:39:36.345598 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.top_posts"
[0m15:39:36.346733 [debug] [Thread-1 (]: On model.social_analytics.top_posts: COMMIT
[0m15:39:36.349765 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m15:39:36.353123 [debug] [Thread-1 (]: Applying DROP to: "social_analytics"."analytics_analytics"."top_posts__dbt_backup"
[0m15:39:36.354721 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.top_posts"
[0m15:39:36.355910 [debug] [Thread-1 (]: On model.social_analytics.top_posts: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.top_posts"} */
drop table if exists "social_analytics"."analytics_analytics"."top_posts__dbt_backup" cascade
[0m15:39:36.360321 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m15:39:36.362838 [debug] [Thread-1 (]: On model.social_analytics.top_posts: Close
[0m15:39:36.364441 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '39b6dea4-4fc2-47d0-8115-05ec908dd47e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0515026350>]}
[0m15:39:36.366122 [info ] [Thread-1 (]: 3 of 3 OK created sql table model analytics_analytics.top_posts ................ [[32mSELECT 8[0m in 0.09s]
[0m15:39:36.367982 [debug] [Thread-1 (]: Finished running node model.social_analytics.top_posts
[0m15:39:36.370512 [debug] [MainThread]: Using postgres connection "master"
[0m15:39:36.371794 [debug] [MainThread]: On master: BEGIN
[0m15:39:36.372981 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:39:36.380529 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m15:39:36.381954 [debug] [MainThread]: On master: COMMIT
[0m15:39:36.383025 [debug] [MainThread]: Using postgres connection "master"
[0m15:39:36.384114 [debug] [MainThread]: On master: COMMIT
[0m15:39:36.385400 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m15:39:36.386334 [debug] [MainThread]: On master: Close
[0m15:39:36.387695 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:39:36.389060 [debug] [MainThread]: Connection 'model.social_analytics.top_posts' was properly closed.
[0m15:39:36.390639 [info ] [MainThread]: 
[0m15:39:36.392245 [info ] [MainThread]: Finished running 2 table models, 1 view model in 0 hours 0 minutes and 0.76 seconds (0.76s).
[0m15:39:36.394934 [debug] [MainThread]: Command end result
[0m15:39:36.436768 [debug] [MainThread]: Wrote artifact WritableManifest to /app/dbt_project/target/manifest.json
[0m15:39:36.443594 [debug] [MainThread]: Wrote artifact SemanticManifest to /app/dbt_project/target/semantic_manifest.json
[0m15:39:36.455015 [debug] [MainThread]: Wrote artifact RunExecutionResult to /app/dbt_project/target/run_results.json
[0m15:39:36.456152 [info ] [MainThread]: 
[0m15:39:36.457728 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:39:36.459122 [info ] [MainThread]: 
[0m15:39:36.460370 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m15:39:36.463305 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.9051031, "process_in_blocks": "95360", "process_kernel_time": 1.841154, "process_mem_max_rss": "128692", "process_out_blocks": "8", "process_user_time": 2.891756}
[0m15:39:36.464832 [debug] [MainThread]: Command `dbt run` succeeded at 15:39:36.464690 after 1.91 seconds
[0m15:39:36.466412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f051df53d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f051df851d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f051df85050>]}
[0m15:39:36.468049 [debug] [MainThread]: Flushing usage events
[0m15:39:39.501087 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:15:31.742377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c8e5c9910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c8b9f62d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c8b9f67d0>]}


============================== 16:15:31.751894 | 2afe2c08-b772-4401-b015-0da985a435a9 ==============================
[0m16:15:31.751894 [info ] [MainThread]: Running with dbt=1.10.9
[0m16:15:31.754011 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'log_format': 'default', 'debug': 'False', 'version_check': 'True', 'indirect_selection': 'eager', 'target_path': 'None', 'static_parser': 'True', 'cache_selected_only': 'False', 'use_colors': 'True', 'write_json': 'True', 'partial_parse': 'True', 'quiet': 'False', 'printer_width': '80', 'log_path': 'dbt_project/logs', 'introspect': 'True', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'profiles_dir': '/root/.dbt', 'empty': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run --project-dir dbt_project', 'warn_error': 'None'}
[0m16:15:31.765131 [info ] [MainThread]: Error importing adapter: No module named 'dbt.adapters.postgres'
[0m16:15:31.767044 [error] [MainThread]: Encountered an error:
Runtime Error
  Credentials in profile "social_analytics", target "dev" invalid: Runtime Error
    Could not find adapter type postgres!
[0m16:15:31.770315 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.11072982, "process_in_blocks": "40", "process_kernel_time": 0.91679, "process_mem_max_rss": "101548", "process_out_blocks": "1272", "process_user_time": 1.531343}
[0m16:15:31.772337 [debug] [MainThread]: Command `dbt run` failed at 16:15:31.772104 after 0.11 seconds
[0m16:15:31.773704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c8b85ae50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c8b85af10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c8b85ae90>]}
[0m16:15:31.775240 [debug] [MainThread]: Flushing usage events
[0m16:15:33.065724 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:16:20.311666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3908b0ead0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3908b0f290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3908b0ee90>]}


============================== 16:16:20.315641 | 5f2428a2-5fb8-4e83-b0e1-514fa832322b ==============================
[0m16:16:20.315641 [info ] [MainThread]: Running with dbt=1.10.9
[0m16:16:20.317116 [debug] [MainThread]: running dbt with arguments {'target_path': 'None', 'write_json': 'True', 'log_path': 'dbt_project/logs', 'indirect_selection': 'eager', 'partial_parse': 'True', 'log_cache_events': 'False', 'use_colors': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/root/.dbt', 'warn_error': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True', 'empty': 'False', 'printer_width': '80', 'fail_fast': 'False', 'invocation_command': 'dbt run --project-dir dbt_project', 'static_parser': 'True', 'version_check': 'True', 'debug': 'False', 'use_experimental_parser': 'False', 'introspect': 'True', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])'}
[0m16:16:20.326415 [info ] [MainThread]: Error importing adapter: No module named 'dbt.adapters.postgres'
[0m16:16:20.327902 [error] [MainThread]: Encountered an error:
Runtime Error
  Credentials in profile "social_analytics", target "dev" invalid: Runtime Error
    Could not find adapter type postgres!
[0m16:16:20.329409 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.089626916, "process_in_blocks": "0", "process_kernel_time": 0.475807, "process_mem_max_rss": "101668", "process_out_blocks": "1272", "process_user_time": 1.387771}
[0m16:16:20.330721 [debug] [MainThread]: Command `dbt run` failed at 16:16:20.330539 after 0.09 seconds
[0m16:16:20.331795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3908abb810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3908ac3e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3908ac3fd0>]}
[0m16:16:20.332912 [debug] [MainThread]: Flushing usage events
[0m16:16:21.090177 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:56:27.844061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa83541d3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa835578150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa83541d2d0>]}


============================== 16:56:27.849297 | 87672e18-9491-4b72-aabe-f7f5ab2e7213 ==============================
[0m16:56:27.849297 [info ] [MainThread]: Running with dbt=1.10.9
[0m16:56:27.850934 [debug] [MainThread]: running dbt with arguments {'static_parser': 'True', 'write_json': 'True', 'log_path': 'dbt_project/logs', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'introspect': 'True', 'use_experimental_parser': 'False', 'debug': 'False', 'use_colors': 'True', 'profiles_dir': '/root/.dbt', 'partial_parse': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'target_path': 'None', 'indirect_selection': 'eager', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'empty': 'False', 'printer_width': '80', 'invocation_command': 'dbt run --project-dir dbt_project', 'cache_selected_only': 'False', 'log_format': 'default', 'quiet': 'False'}
[0m16:56:27.860520 [info ] [MainThread]: Error importing adapter: No module named 'dbt.adapters.postgres'
[0m16:56:27.861780 [error] [MainThread]: Encountered an error:
Runtime Error
  Credentials in profile "social_analytics", target "dev" invalid: Runtime Error
    Could not find adapter type postgres!
[0m16:56:27.864750 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.10426339, "process_in_blocks": "47808", "process_kernel_time": 0.519045, "process_mem_max_rss": "100744", "process_out_blocks": "0", "process_user_time": 1.33189}
[0m16:56:27.865836 [debug] [MainThread]: Command `dbt run` failed at 16:56:27.865727 after 0.11 seconds
[0m16:56:27.866723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa835426410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8352a7a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8352a7d10>]}
[0m16:56:27.867868 [debug] [MainThread]: Flushing usage events
[0m16:56:28.681469 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m16:58:59.466720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c5d076a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c5ced7f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c5fba11d0>]}


============================== 16:58:59.472183 | 3b1947de-b6fd-41d5-b851-46e8c327bbd3 ==============================
[0m16:58:59.472183 [info ] [MainThread]: Running with dbt=1.10.9
[0m16:58:59.474084 [debug] [MainThread]: running dbt with arguments {'log_path': 'dbt_project/logs', 'version_check': 'True', 'log_format': 'default', 'log_cache_events': 'False', 'no_print': 'None', 'write_json': 'True', 'static_parser': 'True', 'quiet': 'False', 'introspect': 'True', 'cache_selected_only': 'False', 'debug': 'False', 'printer_width': '80', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'send_anonymous_usage_stats': 'True', 'invocation_command': 'dbt run --project-dir dbt_project', 'indirect_selection': 'eager', 'empty': 'False', 'target_path': 'None', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'profiles_dir': '/root/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True'}
[0m16:58:59.483631 [info ] [MainThread]: Error importing adapter: No module named 'dbt.adapters.postgres'
[0m16:58:59.484890 [error] [MainThread]: Encountered an error:
Runtime Error
  Credentials in profile "social_analytics", target "dev" invalid: Runtime Error
    Could not find adapter type postgres!
[0m16:58:59.487904 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.09702176, "process_in_blocks": "47616", "process_kernel_time": 0.333178, "process_mem_max_rss": "101492", "process_out_blocks": "1272", "process_user_time": 1.5287}
[0m16:58:59.489509 [debug] [MainThread]: Command `dbt run` failed at 16:58:59.489332 after 0.10 seconds
[0m16:58:59.490648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c5ceae3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c5cea1110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2c5cea0dd0>]}
[0m16:58:59.491823 [debug] [MainThread]: Flushing usage events
[0m16:59:00.258856 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:03:21.197286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0ef0edf90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0ef0edcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0ef0edad0>]}


============================== 17:03:21.202227 | 98042cd0-e073-4464-b7b8-3fa83c3fb11b ==============================
[0m17:03:21.202227 [info ] [MainThread]: Running with dbt=1.10.9
[0m17:03:21.203869 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'use_colors': 'True', 'log_format': 'default', 'introspect': 'True', 'no_print': 'None', 'write_json': 'True', 'printer_width': '80', 'partial_parse': 'True', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'empty': 'False', 'warn_error': 'None', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'profiles_dir': '/root/.dbt', 'send_anonymous_usage_stats': 'True', 'static_parser': 'True', 'quiet': 'False', 'version_check': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --project-dir dbt_project', 'debug': 'False', 'log_path': 'dbt_project/logs', 'log_cache_events': 'False'}
[0m17:03:21.382162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '98042cd0-e073-4464-b7b8-3fa83c3fb11b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0ee7fa6d0>]}
[0m17:03:21.442853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '98042cd0-e073-4464-b7b8-3fa83c3fb11b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0f1cf0d90>]}
[0m17:03:21.444803 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m17:03:21.520361 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m17:03:21.763079 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:03:21.764844 [debug] [MainThread]: Partial parsing: updated file: social_analytics://models/fct_daily_metrics.sql
[0m17:03:22.022740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '98042cd0-e073-4464-b7b8-3fa83c3fb11b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0ef0234d0>]}
[0m17:03:22.095849 [debug] [MainThread]: Wrote artifact WritableManifest to dbt_project/target/manifest.json
[0m17:03:22.102644 [debug] [MainThread]: Wrote artifact SemanticManifest to dbt_project/target/semantic_manifest.json
[0m17:03:22.134143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '98042cd0-e073-4464-b7b8-3fa83c3fb11b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0ecf3bf50>]}
[0m17:03:22.135900 [info ] [MainThread]: Found 3 models, 434 macros
[0m17:03:22.137438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '98042cd0-e073-4464-b7b8-3fa83c3fb11b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0f1501010>]}
[0m17:03:22.140452 [info ] [MainThread]: 
[0m17:03:22.142068 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:03:22.143542 [info ] [MainThread]: 
[0m17:03:22.145134 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:03:22.150908 [debug] [ThreadPool]: Acquiring new postgres connection 'list_social_analytics'
[0m17:03:22.266795 [debug] [ThreadPool]: Using postgres connection "list_social_analytics"
[0m17:03:22.268048 [debug] [ThreadPool]: On list_social_analytics: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "connection_name": "list_social_analytics"} */

    select distinct nspname from pg_namespace
  
[0m17:03:22.269217 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:03:22.291301 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.022 seconds
[0m17:03:22.293738 [debug] [ThreadPool]: On list_social_analytics: Close
[0m17:03:22.296503 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_social_analytics, now list_social_analytics_analytics_analytics)
[0m17:03:22.303706 [debug] [ThreadPool]: Using postgres connection "list_social_analytics_analytics_analytics"
[0m17:03:22.305081 [debug] [ThreadPool]: On list_social_analytics_analytics_analytics: BEGIN
[0m17:03:22.306271 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:03:22.315316 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m17:03:22.316978 [debug] [ThreadPool]: Using postgres connection "list_social_analytics_analytics_analytics"
[0m17:03:22.318259 [debug] [ThreadPool]: On list_social_analytics_analytics_analytics: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "connection_name": "list_social_analytics_analytics_analytics"} */
select
      'social_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'social_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'social_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics'
  
[0m17:03:22.335056 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.016 seconds
[0m17:03:22.337512 [debug] [ThreadPool]: On list_social_analytics_analytics_analytics: ROLLBACK
[0m17:03:22.338755 [debug] [ThreadPool]: On list_social_analytics_analytics_analytics: Close
[0m17:03:22.344925 [debug] [MainThread]: Using postgres connection "master"
[0m17:03:22.346051 [debug] [MainThread]: On master: BEGIN
[0m17:03:22.347033 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:03:22.355230 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m17:03:22.356652 [debug] [MainThread]: Using postgres connection "master"
[0m17:03:22.357763 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:03:22.375761 [debug] [MainThread]: SQL status: SELECT 1 in 0.017 seconds
[0m17:03:22.378092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '98042cd0-e073-4464-b7b8-3fa83c3fb11b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0ed343d10>]}
[0m17:03:22.379314 [debug] [MainThread]: On master: ROLLBACK
[0m17:03:22.380474 [debug] [MainThread]: Using postgres connection "master"
[0m17:03:22.381469 [debug] [MainThread]: On master: BEGIN
[0m17:03:22.382667 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m17:03:22.383790 [debug] [MainThread]: On master: COMMIT
[0m17:03:22.384920 [debug] [MainThread]: Using postgres connection "master"
[0m17:03:22.386056 [debug] [MainThread]: On master: COMMIT
[0m17:03:22.387398 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:03:22.388357 [debug] [MainThread]: On master: Close
[0m17:03:22.395105 [debug] [Thread-1 (]: Began running node model.social_analytics.stg_posts
[0m17:03:22.396802 [info ] [Thread-1 (]: 1 of 3 START sql view model analytics_analytics.stg_posts ...................... [RUN]
[0m17:03:22.397879 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_social_analytics_analytics_analytics, now model.social_analytics.stg_posts)
[0m17:03:22.398826 [debug] [Thread-1 (]: Began compiling node model.social_analytics.stg_posts
[0m17:03:22.406748 [debug] [Thread-1 (]: Writing injected SQL for node "model.social_analytics.stg_posts"
[0m17:03:22.414470 [debug] [Thread-1 (]: Began executing node model.social_analytics.stg_posts
[0m17:03:22.452299 [debug] [Thread-1 (]: Writing runtime sql for node "model.social_analytics.stg_posts"
[0m17:03:22.459696 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.stg_posts"
[0m17:03:22.460786 [debug] [Thread-1 (]: On model.social_analytics.stg_posts: BEGIN
[0m17:03:22.461712 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:03:22.468582 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m17:03:22.470154 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.stg_posts"
[0m17:03:22.471261 [debug] [Thread-1 (]: On model.social_analytics.stg_posts: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.stg_posts"} */

  create view "social_analytics"."analytics_analytics"."stg_posts__dbt_tmp"
    
    
  as (
    

select
    id,
    platform,
    platform_post_id,
    author_name,
    content_text,
    content_url,
    coalesce(like_count, 0) as like_count,
    coalesce(comment_count, 0) as comment_count,
    coalesce(share_count, 0) as share_count,
    posted_at_utc,
    collected_at_utc
from public.posts
  );
[0m17:03:22.497109 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.025 seconds
[0m17:03:22.504846 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.stg_posts"
[0m17:03:22.505971 [debug] [Thread-1 (]: On model.social_analytics.stg_posts: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.stg_posts"} */
alter table "social_analytics"."analytics_analytics"."stg_posts" rename to "stg_posts__dbt_backup"
[0m17:03:22.509188 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m17:03:22.512802 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.stg_posts"
[0m17:03:22.513828 [debug] [Thread-1 (]: On model.social_analytics.stg_posts: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.stg_posts"} */
alter table "social_analytics"."analytics_analytics"."stg_posts__dbt_tmp" rename to "stg_posts"
[0m17:03:22.515073 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:03:22.531423 [debug] [Thread-1 (]: On model.social_analytics.stg_posts: COMMIT
[0m17:03:22.532696 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.stg_posts"
[0m17:03:22.533769 [debug] [Thread-1 (]: On model.social_analytics.stg_posts: COMMIT
[0m17:03:22.538535 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m17:03:22.545733 [debug] [Thread-1 (]: Applying DROP to: "social_analytics"."analytics_analytics"."stg_posts__dbt_backup"
[0m17:03:22.551270 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.stg_posts"
[0m17:03:22.552227 [debug] [Thread-1 (]: On model.social_analytics.stg_posts: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.stg_posts"} */
drop view if exists "social_analytics"."analytics_analytics"."stg_posts__dbt_backup" cascade
[0m17:03:22.563969 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.011 seconds
[0m17:03:22.567860 [debug] [Thread-1 (]: On model.social_analytics.stg_posts: Close
[0m17:03:22.570795 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '98042cd0-e073-4464-b7b8-3fa83c3fb11b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0ed751190>]}
[0m17:03:22.572381 [info ] [Thread-1 (]: 1 of 3 OK created sql view model analytics_analytics.stg_posts ................. [[32mCREATE VIEW[0m in 0.17s]
[0m17:03:22.573620 [debug] [Thread-1 (]: Finished running node model.social_analytics.stg_posts
[0m17:03:22.575542 [debug] [Thread-1 (]: Began running node model.social_analytics.fct_daily_metrics
[0m17:03:22.576520 [info ] [Thread-1 (]: 2 of 3 START sql table model analytics_analytics.fct_daily_metrics ............. [RUN]
[0m17:03:22.577668 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.social_analytics.stg_posts, now model.social_analytics.fct_daily_metrics)
[0m17:03:22.578774 [debug] [Thread-1 (]: Began compiling node model.social_analytics.fct_daily_metrics
[0m17:03:22.583287 [debug] [Thread-1 (]: Writing injected SQL for node "model.social_analytics.fct_daily_metrics"
[0m17:03:22.589884 [debug] [Thread-1 (]: Began executing node model.social_analytics.fct_daily_metrics
[0m17:03:22.614930 [debug] [Thread-1 (]: Writing runtime sql for node "model.social_analytics.fct_daily_metrics"
[0m17:03:22.621783 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.fct_daily_metrics"
[0m17:03:22.622946 [debug] [Thread-1 (]: On model.social_analytics.fct_daily_metrics: BEGIN
[0m17:03:22.623892 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:03:22.630329 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m17:03:22.631649 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.fct_daily_metrics"
[0m17:03:22.632629 [debug] [Thread-1 (]: On model.social_analytics.fct_daily_metrics: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.fct_daily_metrics"} */

  
    

  create  table "social_analytics"."analytics_analytics"."fct_daily_metrics__dbt_tmp"
  
  
    as
  
  (
    

select
    platform,
    date_trunc('day', posted_at_utc) as post_date,
    count(*) as total_posts,
    sum(like_count) as total_likes,
    sum(comment_count) as total_comments,
    sum(share_count) as total_shares,
    sum(like_count + comment_count + share_count) as engagement_score
from "social_analytics"."analytics_analytics"."stg_posts"
group by platform, date_trunc('day', posted_at_utc)
  );
  
[0m17:03:22.657035 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.023 seconds
[0m17:03:22.665642 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.fct_daily_metrics"
[0m17:03:22.667007 [debug] [Thread-1 (]: On model.social_analytics.fct_daily_metrics: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.fct_daily_metrics"} */
alter table "social_analytics"."analytics_analytics"."fct_daily_metrics" rename to "fct_daily_metrics__dbt_backup"
[0m17:03:22.668875 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:03:22.672634 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.fct_daily_metrics"
[0m17:03:22.673614 [debug] [Thread-1 (]: On model.social_analytics.fct_daily_metrics: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.fct_daily_metrics"} */
alter table "social_analytics"."analytics_analytics"."fct_daily_metrics__dbt_tmp" rename to "fct_daily_metrics"
[0m17:03:22.674769 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:03:22.676603 [debug] [Thread-1 (]: On model.social_analytics.fct_daily_metrics: COMMIT
[0m17:03:22.677410 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.fct_daily_metrics"
[0m17:03:22.678272 [debug] [Thread-1 (]: On model.social_analytics.fct_daily_metrics: COMMIT
[0m17:03:22.680965 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m17:03:22.683955 [debug] [Thread-1 (]: Applying DROP to: "social_analytics"."analytics_analytics"."fct_daily_metrics__dbt_backup"
[0m17:03:22.687269 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.fct_daily_metrics"
[0m17:03:22.688447 [debug] [Thread-1 (]: On model.social_analytics.fct_daily_metrics: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.fct_daily_metrics"} */
drop table if exists "social_analytics"."analytics_analytics"."fct_daily_metrics__dbt_backup" cascade
[0m17:03:22.717843 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.028 seconds
[0m17:03:22.721490 [debug] [Thread-1 (]: On model.social_analytics.fct_daily_metrics: Close
[0m17:03:22.723014 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '98042cd0-e073-4464-b7b8-3fa83c3fb11b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0de82e690>]}
[0m17:03:22.724379 [info ] [Thread-1 (]: 2 of 3 OK created sql table model analytics_analytics.fct_daily_metrics ........ [[32mSELECT 8[0m in 0.15s]
[0m17:03:22.725702 [debug] [Thread-1 (]: Finished running node model.social_analytics.fct_daily_metrics
[0m17:03:22.726894 [debug] [Thread-1 (]: Began running node model.social_analytics.top_posts
[0m17:03:22.728575 [info ] [Thread-1 (]: 3 of 3 START sql table model analytics_analytics.top_posts ..................... [RUN]
[0m17:03:22.730495 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.social_analytics.fct_daily_metrics, now model.social_analytics.top_posts)
[0m17:03:22.731626 [debug] [Thread-1 (]: Began compiling node model.social_analytics.top_posts
[0m17:03:22.736075 [debug] [Thread-1 (]: Writing injected SQL for node "model.social_analytics.top_posts"
[0m17:03:22.745048 [debug] [Thread-1 (]: Began executing node model.social_analytics.top_posts
[0m17:03:22.753088 [debug] [Thread-1 (]: Writing runtime sql for node "model.social_analytics.top_posts"
[0m17:03:22.761497 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.top_posts"
[0m17:03:22.762778 [debug] [Thread-1 (]: On model.social_analytics.top_posts: BEGIN
[0m17:03:22.763872 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:03:22.772456 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m17:03:22.774476 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.top_posts"
[0m17:03:22.775814 [debug] [Thread-1 (]: On model.social_analytics.top_posts: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.top_posts"} */

  
    

  create  table "social_analytics"."analytics_analytics"."top_posts__dbt_tmp"
  
  
    as
  
  (
    

with ranked as (
    select
        id,
        platform,
        author_name,
        content_text,
        content_url,
        (like_count + comment_count + share_count) as engagement_score,
        row_number() over (order by (like_count + comment_count + share_count) desc) as overall_rank,
        row_number() over (partition by platform order by (like_count + comment_count + share_count) desc) as platform_rank
    from "social_analytics"."analytics_analytics"."stg_posts"
)
select *
from ranked
where overall_rank <= 5
   or platform_rank <= 3
  );
  
[0m17:03:22.789273 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.012 seconds
[0m17:03:22.794527 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.top_posts"
[0m17:03:22.795846 [debug] [Thread-1 (]: On model.social_analytics.top_posts: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.top_posts"} */
alter table "social_analytics"."analytics_analytics"."top_posts" rename to "top_posts__dbt_backup"
[0m17:03:22.797781 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:03:22.802225 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.top_posts"
[0m17:03:22.803734 [debug] [Thread-1 (]: On model.social_analytics.top_posts: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.top_posts"} */
alter table "social_analytics"."analytics_analytics"."top_posts__dbt_tmp" rename to "top_posts"
[0m17:03:22.805695 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:03:22.808667 [debug] [Thread-1 (]: On model.social_analytics.top_posts: COMMIT
[0m17:03:22.810113 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.top_posts"
[0m17:03:22.811332 [debug] [Thread-1 (]: On model.social_analytics.top_posts: COMMIT
[0m17:03:22.814864 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m17:03:22.819382 [debug] [Thread-1 (]: Applying DROP to: "social_analytics"."analytics_analytics"."top_posts__dbt_backup"
[0m17:03:22.821092 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.top_posts"
[0m17:03:22.822336 [debug] [Thread-1 (]: On model.social_analytics.top_posts: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.top_posts"} */
drop table if exists "social_analytics"."analytics_analytics"."top_posts__dbt_backup" cascade
[0m17:03:22.827389 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m17:03:22.830279 [debug] [Thread-1 (]: On model.social_analytics.top_posts: Close
[0m17:03:22.832184 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '98042cd0-e073-4464-b7b8-3fa83c3fb11b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0de8ece10>]}
[0m17:03:22.834192 [info ] [Thread-1 (]: 3 of 3 OK created sql table model analytics_analytics.top_posts ................ [[32mSELECT 8[0m in 0.10s]
[0m17:03:22.835825 [debug] [Thread-1 (]: Finished running node model.social_analytics.top_posts
[0m17:03:22.838246 [debug] [MainThread]: Using postgres connection "master"
[0m17:03:22.839510 [debug] [MainThread]: On master: BEGIN
[0m17:03:22.840523 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:03:22.848125 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m17:03:22.849724 [debug] [MainThread]: On master: COMMIT
[0m17:03:22.850941 [debug] [MainThread]: Using postgres connection "master"
[0m17:03:22.852047 [debug] [MainThread]: On master: COMMIT
[0m17:03:22.853436 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:03:22.855137 [debug] [MainThread]: On master: Close
[0m17:03:22.857089 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:03:22.858636 [debug] [MainThread]: Connection 'model.social_analytics.top_posts' was properly closed.
[0m17:03:22.860174 [info ] [MainThread]: 
[0m17:03:22.861567 [info ] [MainThread]: Finished running 2 table models, 1 view model in 0 hours 0 minutes and 0.72 seconds (0.72s).
[0m17:03:22.863820 [debug] [MainThread]: Command end result
[0m17:03:22.900612 [debug] [MainThread]: Wrote artifact WritableManifest to dbt_project/target/manifest.json
[0m17:03:22.907663 [debug] [MainThread]: Wrote artifact SemanticManifest to dbt_project/target/semantic_manifest.json
[0m17:03:22.919823 [debug] [MainThread]: Wrote artifact RunExecutionResult to dbt_project/target/run_results.json
[0m17:03:22.920935 [info ] [MainThread]: 
[0m17:03:22.922143 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:03:22.923242 [info ] [MainThread]: 
[0m17:03:22.924324 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m17:03:22.927005 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.8001664, "process_in_blocks": "1496", "process_kernel_time": 0.427573, "process_mem_max_rss": "130248", "process_out_blocks": "1424", "process_user_time": 2.287021}
[0m17:03:22.928427 [debug] [MainThread]: Command `dbt run` succeeded at 17:03:22.928244 after 1.80 seconds
[0m17:03:22.929608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0f3949950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0f3948ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe0f3949f10>]}
[0m17:03:22.930652 [debug] [MainThread]: Flushing usage events
[0m17:03:23.801572 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:12:39.799282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0e36f6a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0e36f6450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0e3866910>]}


============================== 17:12:39.809069 | e0254d05-52e2-4cc0-a38b-119eedfcee6a ==============================
[0m17:12:39.809069 [info ] [MainThread]: Running with dbt=1.10.9
[0m17:12:39.810753 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'log_cache_events': 'False', 'write_json': 'True', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'indirect_selection': 'eager', 'warn_error': 'None', 'log_path': 'dbt_project/logs', 'use_experimental_parser': 'False', 'printer_width': '80', 'empty': 'False', 'invocation_command': 'dbt run --project-dir dbt_project', 'use_colors': 'True', 'debug': 'False', 'introspect': 'True', 'profiles_dir': '/root/.dbt', 'no_print': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'fail_fast': 'False', 'target_path': 'None', 'quiet': 'False', 'version_check': 'True', 'partial_parse': 'True'}
[0m17:12:40.028820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e0254d05-52e2-4cc0-a38b-119eedfcee6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0e2df6590>]}
[0m17:12:40.093323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e0254d05-52e2-4cc0-a38b-119eedfcee6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0e62a5a10>]}
[0m17:12:40.095861 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m17:12:40.186722 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m17:12:40.381615 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:12:40.383518 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:12:40.415462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e0254d05-52e2-4cc0-a38b-119eedfcee6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0e25edc50>]}
[0m17:12:40.507472 [debug] [MainThread]: Wrote artifact WritableManifest to dbt_project/target/manifest.json
[0m17:12:40.515033 [debug] [MainThread]: Wrote artifact SemanticManifest to dbt_project/target/semantic_manifest.json
[0m17:12:40.560121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e0254d05-52e2-4cc0-a38b-119eedfcee6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0e2d33350>]}
[0m17:12:40.561929 [info ] [MainThread]: Found 3 models, 434 macros
[0m17:12:40.563661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e0254d05-52e2-4cc0-a38b-119eedfcee6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0e2945010>]}
[0m17:12:40.567141 [info ] [MainThread]: 
[0m17:12:40.568759 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:12:40.570248 [info ] [MainThread]: 
[0m17:12:40.572079 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:12:40.581955 [debug] [ThreadPool]: Acquiring new postgres connection 'list_social_analytics'
[0m17:12:40.695739 [debug] [ThreadPool]: Using postgres connection "list_social_analytics"
[0m17:12:40.697167 [debug] [ThreadPool]: On list_social_analytics: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "connection_name": "list_social_analytics"} */

    select distinct nspname from pg_namespace
  
[0m17:12:40.698413 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:12:40.717111 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.019 seconds
[0m17:12:40.719216 [debug] [ThreadPool]: On list_social_analytics: Close
[0m17:12:40.722139 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_social_analytics, now list_social_analytics_analytics_analytics)
[0m17:12:40.729950 [debug] [ThreadPool]: Using postgres connection "list_social_analytics_analytics_analytics"
[0m17:12:40.731207 [debug] [ThreadPool]: On list_social_analytics_analytics_analytics: BEGIN
[0m17:12:40.732194 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:12:40.741434 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m17:12:40.743044 [debug] [ThreadPool]: Using postgres connection "list_social_analytics_analytics_analytics"
[0m17:12:40.744434 [debug] [ThreadPool]: On list_social_analytics_analytics_analytics: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "connection_name": "list_social_analytics_analytics_analytics"} */
select
      'social_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'social_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'social_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics'
  
[0m17:12:40.763470 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.018 seconds
[0m17:12:40.766159 [debug] [ThreadPool]: On list_social_analytics_analytics_analytics: ROLLBACK
[0m17:12:40.767444 [debug] [ThreadPool]: On list_social_analytics_analytics_analytics: Close
[0m17:12:40.774372 [debug] [MainThread]: Using postgres connection "master"
[0m17:12:40.775895 [debug] [MainThread]: On master: BEGIN
[0m17:12:40.777439 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:12:40.784858 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m17:12:40.786152 [debug] [MainThread]: Using postgres connection "master"
[0m17:12:40.787568 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:12:40.802033 [debug] [MainThread]: SQL status: SELECT 1 in 0.013 seconds
[0m17:12:40.804370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e0254d05-52e2-4cc0-a38b-119eedfcee6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0e36a9250>]}
[0m17:12:40.805778 [debug] [MainThread]: On master: ROLLBACK
[0m17:12:40.807524 [debug] [MainThread]: Using postgres connection "master"
[0m17:12:40.808788 [debug] [MainThread]: On master: BEGIN
[0m17:12:40.810147 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m17:12:40.811357 [debug] [MainThread]: On master: COMMIT
[0m17:12:40.812535 [debug] [MainThread]: Using postgres connection "master"
[0m17:12:40.813726 [debug] [MainThread]: On master: COMMIT
[0m17:12:40.815050 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:12:40.816082 [debug] [MainThread]: On master: Close
[0m17:12:40.825254 [debug] [Thread-1 (]: Began running node model.social_analytics.stg_posts
[0m17:12:40.827766 [info ] [Thread-1 (]: 1 of 3 START sql view model analytics_analytics.stg_posts ...................... [RUN]
[0m17:12:40.829257 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_social_analytics_analytics_analytics, now model.social_analytics.stg_posts)
[0m17:12:40.830513 [debug] [Thread-1 (]: Began compiling node model.social_analytics.stg_posts
[0m17:12:40.840604 [debug] [Thread-1 (]: Writing injected SQL for node "model.social_analytics.stg_posts"
[0m17:12:40.850816 [debug] [Thread-1 (]: Began executing node model.social_analytics.stg_posts
[0m17:12:40.888761 [debug] [Thread-1 (]: Writing runtime sql for node "model.social_analytics.stg_posts"
[0m17:12:40.897618 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.stg_posts"
[0m17:12:40.898929 [debug] [Thread-1 (]: On model.social_analytics.stg_posts: BEGIN
[0m17:12:40.900018 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:12:40.908790 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m17:12:40.910212 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.stg_posts"
[0m17:12:40.911262 [debug] [Thread-1 (]: On model.social_analytics.stg_posts: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.stg_posts"} */

  create view "social_analytics"."analytics_analytics"."stg_posts__dbt_tmp"
    
    
  as (
    

select
    id,
    platform,
    platform_post_id,
    author_name,
    content_text,
    content_url,
    coalesce(like_count, 0) as like_count,
    coalesce(comment_count, 0) as comment_count,
    coalesce(share_count, 0) as share_count,
    posted_at_utc,
    collected_at_utc
from public.posts
  );
[0m17:12:40.930607 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.018 seconds
[0m17:12:40.938751 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.stg_posts"
[0m17:12:40.940354 [debug] [Thread-1 (]: On model.social_analytics.stg_posts: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.stg_posts"} */
alter table "social_analytics"."analytics_analytics"."stg_posts" rename to "stg_posts__dbt_backup"
[0m17:12:40.944261 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.003 seconds
[0m17:12:40.948547 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.stg_posts"
[0m17:12:40.949685 [debug] [Thread-1 (]: On model.social_analytics.stg_posts: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.stg_posts"} */
alter table "social_analytics"."analytics_analytics"."stg_posts__dbt_tmp" rename to "stg_posts"
[0m17:12:40.951509 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:12:40.968519 [debug] [Thread-1 (]: On model.social_analytics.stg_posts: COMMIT
[0m17:12:40.969988 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.stg_posts"
[0m17:12:40.971306 [debug] [Thread-1 (]: On model.social_analytics.stg_posts: COMMIT
[0m17:12:40.975652 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m17:12:40.982803 [debug] [Thread-1 (]: Applying DROP to: "social_analytics"."analytics_analytics"."stg_posts__dbt_backup"
[0m17:12:40.988682 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.stg_posts"
[0m17:12:40.989837 [debug] [Thread-1 (]: On model.social_analytics.stg_posts: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.stg_posts"} */
drop view if exists "social_analytics"."analytics_analytics"."stg_posts__dbt_backup" cascade
[0m17:12:40.997706 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.007 seconds
[0m17:12:41.001687 [debug] [Thread-1 (]: On model.social_analytics.stg_posts: Close
[0m17:12:41.005025 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0254d05-52e2-4cc0-a38b-119eedfcee6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0e099ac50>]}
[0m17:12:41.007126 [info ] [Thread-1 (]: 1 of 3 OK created sql view model analytics_analytics.stg_posts ................. [[32mCREATE VIEW[0m in 0.17s]
[0m17:12:41.008846 [debug] [Thread-1 (]: Finished running node model.social_analytics.stg_posts
[0m17:12:41.010813 [debug] [Thread-1 (]: Began running node model.social_analytics.fct_daily_metrics
[0m17:12:41.012086 [info ] [Thread-1 (]: 2 of 3 START sql table model analytics_analytics.fct_daily_metrics ............. [RUN]
[0m17:12:41.013740 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.social_analytics.stg_posts, now model.social_analytics.fct_daily_metrics)
[0m17:12:41.014996 [debug] [Thread-1 (]: Began compiling node model.social_analytics.fct_daily_metrics
[0m17:12:41.019160 [debug] [Thread-1 (]: Writing injected SQL for node "model.social_analytics.fct_daily_metrics"
[0m17:12:41.027006 [debug] [Thread-1 (]: Began executing node model.social_analytics.fct_daily_metrics
[0m17:12:41.050909 [debug] [Thread-1 (]: Writing runtime sql for node "model.social_analytics.fct_daily_metrics"
[0m17:12:41.060447 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.fct_daily_metrics"
[0m17:12:41.062004 [debug] [Thread-1 (]: On model.social_analytics.fct_daily_metrics: BEGIN
[0m17:12:41.063264 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:12:41.070353 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m17:12:41.071653 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.fct_daily_metrics"
[0m17:12:41.072613 [debug] [Thread-1 (]: On model.social_analytics.fct_daily_metrics: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.fct_daily_metrics"} */

  
    

  create  table "social_analytics"."analytics_analytics"."fct_daily_metrics__dbt_tmp"
  
  
    as
  
  (
    

select
    platform,
    date_trunc('day', posted_at_utc) as post_date,
    count(*) as total_posts,
    sum(like_count) as total_likes,
    sum(comment_count) as total_comments,
    sum(share_count) as total_shares,
    sum(like_count + comment_count + share_count) as engagement_score
from "social_analytics"."analytics_analytics"."stg_posts"
group by platform, date_trunc('day', posted_at_utc)
  );
  
[0m17:12:41.091953 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.018 seconds
[0m17:12:41.101039 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.fct_daily_metrics"
[0m17:12:41.102458 [debug] [Thread-1 (]: On model.social_analytics.fct_daily_metrics: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.fct_daily_metrics"} */
alter table "social_analytics"."analytics_analytics"."fct_daily_metrics" rename to "fct_daily_metrics__dbt_backup"
[0m17:12:41.105611 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.002 seconds
[0m17:12:41.168820 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.fct_daily_metrics"
[0m17:12:41.170758 [debug] [Thread-1 (]: On model.social_analytics.fct_daily_metrics: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.fct_daily_metrics"} */
alter table "social_analytics"."analytics_analytics"."fct_daily_metrics__dbt_tmp" rename to "fct_daily_metrics"
[0m17:12:41.172568 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:12:41.174940 [debug] [Thread-1 (]: On model.social_analytics.fct_daily_metrics: COMMIT
[0m17:12:41.176260 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.fct_daily_metrics"
[0m17:12:41.177466 [debug] [Thread-1 (]: On model.social_analytics.fct_daily_metrics: COMMIT
[0m17:12:41.183060 [debug] [Thread-1 (]: SQL status: COMMIT in 0.004 seconds
[0m17:12:41.186929 [debug] [Thread-1 (]: Applying DROP to: "social_analytics"."analytics_analytics"."fct_daily_metrics__dbt_backup"
[0m17:12:41.190922 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.fct_daily_metrics"
[0m17:12:41.192122 [debug] [Thread-1 (]: On model.social_analytics.fct_daily_metrics: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.fct_daily_metrics"} */
drop table if exists "social_analytics"."analytics_analytics"."fct_daily_metrics__dbt_backup" cascade
[0m17:12:41.218287 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.025 seconds
[0m17:12:41.220732 [debug] [Thread-1 (]: On model.social_analytics.fct_daily_metrics: Close
[0m17:12:41.222668 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0254d05-52e2-4cc0-a38b-119eedfcee6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0e3cfac50>]}
[0m17:12:41.224085 [info ] [Thread-1 (]: 2 of 3 OK created sql table model analytics_analytics.fct_daily_metrics ........ [[32mSELECT 8[0m in 0.21s]
[0m17:12:41.225345 [debug] [Thread-1 (]: Finished running node model.social_analytics.fct_daily_metrics
[0m17:12:41.226508 [debug] [Thread-1 (]: Began running node model.social_analytics.top_posts
[0m17:12:41.227537 [info ] [Thread-1 (]: 3 of 3 START sql table model analytics_analytics.top_posts ..................... [RUN]
[0m17:12:41.228838 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.social_analytics.fct_daily_metrics, now model.social_analytics.top_posts)
[0m17:12:41.230079 [debug] [Thread-1 (]: Began compiling node model.social_analytics.top_posts
[0m17:12:41.234037 [debug] [Thread-1 (]: Writing injected SQL for node "model.social_analytics.top_posts"
[0m17:12:41.241533 [debug] [Thread-1 (]: Began executing node model.social_analytics.top_posts
[0m17:12:41.246657 [debug] [Thread-1 (]: Writing runtime sql for node "model.social_analytics.top_posts"
[0m17:12:41.254168 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.top_posts"
[0m17:12:41.255278 [debug] [Thread-1 (]: On model.social_analytics.top_posts: BEGIN
[0m17:12:41.256325 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:12:41.262854 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m17:12:41.264362 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.top_posts"
[0m17:12:41.265366 [debug] [Thread-1 (]: On model.social_analytics.top_posts: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.top_posts"} */

  
    

  create  table "social_analytics"."analytics_analytics"."top_posts__dbt_tmp"
  
  
    as
  
  (
    

with ranked as (
    select
        id,
        platform,
        author_name,
        content_text,
        content_url,
        (like_count + comment_count + share_count) as engagement_score,
        row_number() over (order by (like_count + comment_count + share_count) desc) as overall_rank,
        row_number() over (partition by platform order by (like_count + comment_count + share_count) desc) as platform_rank
    from "social_analytics"."analytics_analytics"."stg_posts"
)
select *
from ranked
where overall_rank <= 5
   or platform_rank <= 3
  );
  
[0m17:12:41.276565 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.010 seconds
[0m17:12:41.281003 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.top_posts"
[0m17:12:41.282023 [debug] [Thread-1 (]: On model.social_analytics.top_posts: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.top_posts"} */
alter table "social_analytics"."analytics_analytics"."top_posts" rename to "top_posts__dbt_backup"
[0m17:12:41.283809 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:12:41.288053 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.top_posts"
[0m17:12:41.289259 [debug] [Thread-1 (]: On model.social_analytics.top_posts: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.top_posts"} */
alter table "social_analytics"."analytics_analytics"."top_posts__dbt_tmp" rename to "top_posts"
[0m17:12:41.290743 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:12:41.293259 [debug] [Thread-1 (]: On model.social_analytics.top_posts: COMMIT
[0m17:12:41.294305 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.top_posts"
[0m17:12:41.295302 [debug] [Thread-1 (]: On model.social_analytics.top_posts: COMMIT
[0m17:12:41.298066 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m17:12:41.301550 [debug] [Thread-1 (]: Applying DROP to: "social_analytics"."analytics_analytics"."top_posts__dbt_backup"
[0m17:12:41.303038 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.top_posts"
[0m17:12:41.304404 [debug] [Thread-1 (]: On model.social_analytics.top_posts: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.top_posts"} */
drop table if exists "social_analytics"."analytics_analytics"."top_posts__dbt_backup" cascade
[0m17:12:41.309408 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m17:12:41.312258 [debug] [Thread-1 (]: On model.social_analytics.top_posts: Close
[0m17:12:41.313922 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e0254d05-52e2-4cc0-a38b-119eedfcee6a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0e63a1810>]}
[0m17:12:41.315564 [info ] [Thread-1 (]: 3 of 3 OK created sql table model analytics_analytics.top_posts ................ [[32mSELECT 8[0m in 0.09s]
[0m17:12:41.317081 [debug] [Thread-1 (]: Finished running node model.social_analytics.top_posts
[0m17:12:41.319983 [debug] [MainThread]: Using postgres connection "master"
[0m17:12:41.321217 [debug] [MainThread]: On master: BEGIN
[0m17:12:41.322257 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:12:41.331023 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m17:12:41.332455 [debug] [MainThread]: On master: COMMIT
[0m17:12:41.334038 [debug] [MainThread]: Using postgres connection "master"
[0m17:12:41.336014 [debug] [MainThread]: On master: COMMIT
[0m17:12:41.337466 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:12:41.338683 [debug] [MainThread]: On master: Close
[0m17:12:41.340109 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:12:41.341588 [debug] [MainThread]: Connection 'model.social_analytics.top_posts' was properly closed.
[0m17:12:41.342801 [info ] [MainThread]: 
[0m17:12:41.343923 [info ] [MainThread]: Finished running 2 table models, 1 view model in 0 hours 0 minutes and 0.77 seconds (0.77s).
[0m17:12:41.345707 [debug] [MainThread]: Command end result
[0m17:12:41.388552 [debug] [MainThread]: Wrote artifact WritableManifest to dbt_project/target/manifest.json
[0m17:12:41.395194 [debug] [MainThread]: Wrote artifact SemanticManifest to dbt_project/target/semantic_manifest.json
[0m17:12:41.407652 [debug] [MainThread]: Wrote artifact RunExecutionResult to dbt_project/target/run_results.json
[0m17:12:41.409063 [info ] [MainThread]: 
[0m17:12:41.410865 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:12:41.412151 [info ] [MainThread]: 
[0m17:12:41.413544 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=3
[0m17:12:41.417305 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.7122055, "process_in_blocks": "0", "process_kernel_time": 1.498776, "process_mem_max_rss": "125044", "process_out_blocks": "1424", "process_user_time": 2.343723}
[0m17:12:41.418671 [debug] [MainThread]: Command `dbt run` succeeded at 17:12:41.418487 after 1.71 seconds
[0m17:12:41.420028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0e214f690>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0e7efced0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd0e0739750>]}
[0m17:12:41.421249 [debug] [MainThread]: Flushing usage events
[0m17:12:42.713011 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:15:53.264608 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b89f760d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b8ac75290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b8c9c2b50>]}


============================== 17:15:53.271832 | 22da8901-5579-4889-bb54-aec713548375 ==============================
[0m17:15:53.271832 [info ] [MainThread]: Running with dbt=1.10.9
[0m17:15:53.273395 [debug] [MainThread]: running dbt with arguments {'indirect_selection': 'eager', 'cache_selected_only': 'False', 'log_format': 'default', 'warn_error': 'None', 'quiet': 'False', 'send_anonymous_usage_stats': 'True', 'printer_width': '80', 'introspect': 'True', 'write_json': 'True', 'profiles_dir': '/root/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'empty': 'False', 'target_path': 'None', 'log_path': 'dbt_project/logs', 'no_print': 'None', 'log_cache_events': 'False', 'fail_fast': 'False', 'static_parser': 'True', 'version_check': 'True', 'debug': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'invocation_command': 'dbt run --project-dir dbt_project'}
[0m17:15:53.488922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '22da8901-5579-4889-bb54-aec713548375', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b8c523550>]}
[0m17:15:53.556695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '22da8901-5579-4889-bb54-aec713548375', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b8c9f8850>]}
[0m17:15:53.559393 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m17:15:53.646741 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m17:15:53.870980 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m17:15:53.872468 [debug] [MainThread]: Partial parsing: added file: social_analytics://models/moving_avg.sql
[0m17:15:54.143678 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '22da8901-5579-4889-bb54-aec713548375', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b88943390>]}
[0m17:15:54.214690 [debug] [MainThread]: Wrote artifact WritableManifest to dbt_project/target/manifest.json
[0m17:15:54.221650 [debug] [MainThread]: Wrote artifact SemanticManifest to dbt_project/target/semantic_manifest.json
[0m17:15:54.265948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '22da8901-5579-4889-bb54-aec713548375', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b88583fd0>]}
[0m17:15:54.267450 [info ] [MainThread]: Found 4 models, 434 macros
[0m17:15:54.268632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '22da8901-5579-4889-bb54-aec713548375', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b88903d10>]}
[0m17:15:54.271759 [info ] [MainThread]: 
[0m17:15:54.273139 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:15:54.274301 [info ] [MainThread]: 
[0m17:15:54.275663 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:15:54.281188 [debug] [ThreadPool]: Acquiring new postgres connection 'list_social_analytics'
[0m17:15:54.530867 [debug] [ThreadPool]: Using postgres connection "list_social_analytics"
[0m17:15:54.532534 [debug] [ThreadPool]: On list_social_analytics: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "connection_name": "list_social_analytics"} */

    select distinct nspname from pg_namespace
  
[0m17:15:54.533701 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:15:54.552835 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.019 seconds
[0m17:15:54.555213 [debug] [ThreadPool]: On list_social_analytics: Close
[0m17:15:54.558982 [debug] [ThreadPool]: Using postgres connection "list_social_analytics"
[0m17:15:54.560372 [debug] [ThreadPool]: On list_social_analytics: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "connection_name": "list_social_analytics"} */

    select distinct nspname from pg_namespace
  
[0m17:15:54.561359 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:15:54.573844 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.012 seconds
[0m17:15:54.575997 [debug] [ThreadPool]: On list_social_analytics: Close
[0m17:15:54.578046 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_social_analytics, now create_social_analytics_analytics_analytics_analytics)
[0m17:15:54.580027 [debug] [ThreadPool]: Creating schema "database: "social_analytics"
schema: "analytics_analytics_analytics"
"
[0m17:15:54.587517 [debug] [ThreadPool]: Using postgres connection "create_social_analytics_analytics_analytics_analytics"
[0m17:15:54.588715 [debug] [ThreadPool]: On create_social_analytics_analytics_analytics_analytics: BEGIN
[0m17:15:54.589675 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:15:54.600539 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m17:15:54.601844 [debug] [ThreadPool]: Using postgres connection "create_social_analytics_analytics_analytics_analytics"
[0m17:15:54.602694 [debug] [ThreadPool]: On create_social_analytics_analytics_analytics_analytics: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "connection_name": "create_social_analytics_analytics_analytics_analytics"} */
create schema if not exists "analytics_analytics_analytics"
[0m17:15:54.607962 [debug] [ThreadPool]: SQL status: CREATE SCHEMA in 0.004 seconds
[0m17:15:54.609815 [debug] [ThreadPool]: On create_social_analytics_analytics_analytics_analytics: COMMIT
[0m17:15:54.611124 [debug] [ThreadPool]: Using postgres connection "create_social_analytics_analytics_analytics_analytics"
[0m17:15:54.612710 [debug] [ThreadPool]: On create_social_analytics_analytics_analytics_analytics: COMMIT
[0m17:15:54.616601 [debug] [ThreadPool]: SQL status: COMMIT in 0.002 seconds
[0m17:15:54.618066 [debug] [ThreadPool]: On create_social_analytics_analytics_analytics_analytics: Close
[0m17:15:54.622239 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_social_analytics_analytics_analytics_analytics, now list_social_analytics_analytics_analytics)
[0m17:15:54.630243 [debug] [ThreadPool]: Using postgres connection "list_social_analytics_analytics_analytics"
[0m17:15:54.631532 [debug] [ThreadPool]: On list_social_analytics_analytics_analytics: BEGIN
[0m17:15:54.633089 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:15:54.640249 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m17:15:54.641289 [debug] [ThreadPool]: Using postgres connection "list_social_analytics_analytics_analytics"
[0m17:15:54.642587 [debug] [ThreadPool]: On list_social_analytics_analytics_analytics: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "connection_name": "list_social_analytics_analytics_analytics"} */
select
      'social_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'social_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'social_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics'
  
[0m17:15:54.651950 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.008 seconds
[0m17:15:54.654822 [debug] [ThreadPool]: On list_social_analytics_analytics_analytics: ROLLBACK
[0m17:15:54.656513 [debug] [ThreadPool]: On list_social_analytics_analytics_analytics: Close
[0m17:15:54.657996 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_social_analytics_analytics_analytics, now list_social_analytics_analytics_analytics_analytics)
[0m17:15:54.662443 [debug] [ThreadPool]: Using postgres connection "list_social_analytics_analytics_analytics_analytics"
[0m17:15:54.663761 [debug] [ThreadPool]: On list_social_analytics_analytics_analytics_analytics: BEGIN
[0m17:15:54.664962 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:15:54.675154 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m17:15:54.676461 [debug] [ThreadPool]: Using postgres connection "list_social_analytics_analytics_analytics_analytics"
[0m17:15:54.677479 [debug] [ThreadPool]: On list_social_analytics_analytics_analytics_analytics: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "connection_name": "list_social_analytics_analytics_analytics_analytics"} */
select
      'social_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics_analytics'
    union all
    select
      'social_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics_analytics'
    union all
    select
      'social_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics_analytics'
  
[0m17:15:54.682483 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.004 seconds
[0m17:15:54.684893 [debug] [ThreadPool]: On list_social_analytics_analytics_analytics_analytics: ROLLBACK
[0m17:15:54.686293 [debug] [ThreadPool]: On list_social_analytics_analytics_analytics_analytics: Close
[0m17:15:54.693796 [debug] [MainThread]: Using postgres connection "master"
[0m17:15:54.695609 [debug] [MainThread]: On master: BEGIN
[0m17:15:54.696995 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:15:54.709776 [debug] [MainThread]: SQL status: BEGIN in 0.013 seconds
[0m17:15:54.711194 [debug] [MainThread]: Using postgres connection "master"
[0m17:15:54.712774 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:15:54.721514 [debug] [MainThread]: SQL status: SELECT 1 in 0.007 seconds
[0m17:15:54.724445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '22da8901-5579-4889-bb54-aec713548375', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b89102590>]}
[0m17:15:54.726083 [debug] [MainThread]: On master: ROLLBACK
[0m17:15:54.727496 [debug] [MainThread]: Using postgres connection "master"
[0m17:15:54.728543 [debug] [MainThread]: On master: BEGIN
[0m17:15:54.730297 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m17:15:54.731410 [debug] [MainThread]: On master: COMMIT
[0m17:15:54.732353 [debug] [MainThread]: Using postgres connection "master"
[0m17:15:54.733476 [debug] [MainThread]: On master: COMMIT
[0m17:15:54.734630 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:15:54.735786 [debug] [MainThread]: On master: Close
[0m17:15:54.746180 [debug] [Thread-1 (]: Began running node model.social_analytics.stg_posts
[0m17:15:54.747840 [info ] [Thread-1 (]: 1 of 4 START sql view model analytics_analytics.stg_posts ...................... [RUN]
[0m17:15:54.749096 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_social_analytics_analytics_analytics_analytics, now model.social_analytics.stg_posts)
[0m17:15:54.750307 [debug] [Thread-1 (]: Began compiling node model.social_analytics.stg_posts
[0m17:15:54.759524 [debug] [Thread-1 (]: Writing injected SQL for node "model.social_analytics.stg_posts"
[0m17:15:54.770028 [debug] [Thread-1 (]: Began executing node model.social_analytics.stg_posts
[0m17:15:54.814758 [debug] [Thread-1 (]: Writing runtime sql for node "model.social_analytics.stg_posts"
[0m17:15:54.827517 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.stg_posts"
[0m17:15:54.829233 [debug] [Thread-1 (]: On model.social_analytics.stg_posts: BEGIN
[0m17:15:54.830833 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:15:54.843732 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m17:15:54.845422 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.stg_posts"
[0m17:15:54.846874 [debug] [Thread-1 (]: On model.social_analytics.stg_posts: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.stg_posts"} */

  create view "social_analytics"."analytics_analytics"."stg_posts__dbt_tmp"
    
    
  as (
    

select
    id,
    platform,
    platform_post_id,
    author_name,
    content_text,
    content_url,
    coalesce(like_count, 0) as like_count,
    coalesce(comment_count, 0) as comment_count,
    coalesce(share_count, 0) as share_count,
    posted_at_utc,
    collected_at_utc
from public.posts
  );
[0m17:15:54.855752 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.007 seconds
[0m17:15:54.865015 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.stg_posts"
[0m17:15:54.866584 [debug] [Thread-1 (]: On model.social_analytics.stg_posts: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.stg_posts"} */
alter table "social_analytics"."analytics_analytics"."stg_posts" rename to "stg_posts__dbt_backup"
[0m17:15:54.869535 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:15:54.874072 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.stg_posts"
[0m17:15:54.875830 [debug] [Thread-1 (]: On model.social_analytics.stg_posts: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.stg_posts"} */
alter table "social_analytics"."analytics_analytics"."stg_posts__dbt_tmp" rename to "stg_posts"
[0m17:15:54.877903 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:15:54.898197 [debug] [Thread-1 (]: On model.social_analytics.stg_posts: COMMIT
[0m17:15:54.900022 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.stg_posts"
[0m17:15:54.901812 [debug] [Thread-1 (]: On model.social_analytics.stg_posts: COMMIT
[0m17:15:54.906057 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m17:15:54.914493 [debug] [Thread-1 (]: Applying DROP to: "social_analytics"."analytics_analytics"."stg_posts__dbt_backup"
[0m17:15:54.921611 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.stg_posts"
[0m17:15:54.923165 [debug] [Thread-1 (]: On model.social_analytics.stg_posts: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.stg_posts"} */
drop view if exists "social_analytics"."analytics_analytics"."stg_posts__dbt_backup" cascade
[0m17:15:54.929347 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.004 seconds
[0m17:15:54.933456 [debug] [Thread-1 (]: On model.social_analytics.stg_posts: Close
[0m17:15:54.937043 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22da8901-5579-4889-bb54-aec713548375', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b895c1890>]}
[0m17:15:54.938969 [info ] [Thread-1 (]: 1 of 4 OK created sql view model analytics_analytics.stg_posts ................. [[32mCREATE VIEW[0m in 0.19s]
[0m17:15:54.940776 [debug] [Thread-1 (]: Finished running node model.social_analytics.stg_posts
[0m17:15:54.943572 [debug] [Thread-1 (]: Began running node model.social_analytics.fct_daily_metrics
[0m17:15:54.945716 [info ] [Thread-1 (]: 2 of 4 START sql table model analytics_analytics.fct_daily_metrics ............. [RUN]
[0m17:15:54.947008 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.social_analytics.stg_posts, now model.social_analytics.fct_daily_metrics)
[0m17:15:54.948312 [debug] [Thread-1 (]: Began compiling node model.social_analytics.fct_daily_metrics
[0m17:15:54.953890 [debug] [Thread-1 (]: Writing injected SQL for node "model.social_analytics.fct_daily_metrics"
[0m17:15:54.964991 [debug] [Thread-1 (]: Began executing node model.social_analytics.fct_daily_metrics
[0m17:15:54.988891 [debug] [Thread-1 (]: Writing runtime sql for node "model.social_analytics.fct_daily_metrics"
[0m17:15:54.999476 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.fct_daily_metrics"
[0m17:15:55.001040 [debug] [Thread-1 (]: On model.social_analytics.fct_daily_metrics: BEGIN
[0m17:15:55.002400 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:15:55.012372 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m17:15:55.014018 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.fct_daily_metrics"
[0m17:15:55.015330 [debug] [Thread-1 (]: On model.social_analytics.fct_daily_metrics: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.fct_daily_metrics"} */

  
    

  create  table "social_analytics"."analytics_analytics"."fct_daily_metrics__dbt_tmp"
  
  
    as
  
  (
    

select
    platform,
    date_trunc('day', posted_at_utc) as post_date,
    count(*) as total_posts,
    sum(like_count) as total_likes,
    sum(comment_count) as total_comments,
    sum(share_count) as total_shares,
    sum(like_count + comment_count + share_count) as engagement_score
from "social_analytics"."analytics_analytics"."stg_posts"
group by platform, date_trunc('day', posted_at_utc)
  );
  
[0m17:15:55.027173 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.011 seconds
[0m17:15:55.038926 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.fct_daily_metrics"
[0m17:15:55.040451 [debug] [Thread-1 (]: On model.social_analytics.fct_daily_metrics: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.fct_daily_metrics"} */
alter table "social_analytics"."analytics_analytics"."fct_daily_metrics" rename to "fct_daily_metrics__dbt_backup"
[0m17:15:55.042837 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:15:55.048487 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.fct_daily_metrics"
[0m17:15:55.050413 [debug] [Thread-1 (]: On model.social_analytics.fct_daily_metrics: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.fct_daily_metrics"} */
alter table "social_analytics"."analytics_analytics"."fct_daily_metrics__dbt_tmp" rename to "fct_daily_metrics"
[0m17:15:55.052152 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:15:55.054991 [debug] [Thread-1 (]: On model.social_analytics.fct_daily_metrics: COMMIT
[0m17:15:55.056866 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.fct_daily_metrics"
[0m17:15:55.058251 [debug] [Thread-1 (]: On model.social_analytics.fct_daily_metrics: COMMIT
[0m17:15:55.061570 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m17:15:55.065176 [debug] [Thread-1 (]: Applying DROP to: "social_analytics"."analytics_analytics"."fct_daily_metrics__dbt_backup"
[0m17:15:55.068964 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.fct_daily_metrics"
[0m17:15:55.070374 [debug] [Thread-1 (]: On model.social_analytics.fct_daily_metrics: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.fct_daily_metrics"} */
drop table if exists "social_analytics"."analytics_analytics"."fct_daily_metrics__dbt_backup" cascade
[0m17:15:55.074882 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m17:15:55.077308 [debug] [Thread-1 (]: On model.social_analytics.fct_daily_metrics: Close
[0m17:15:55.078896 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22da8901-5579-4889-bb54-aec713548375', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b857a5b90>]}
[0m17:15:55.080527 [info ] [Thread-1 (]: 2 of 4 OK created sql table model analytics_analytics.fct_daily_metrics ........ [[32mSELECT 8[0m in 0.13s]
[0m17:15:55.082147 [debug] [Thread-1 (]: Finished running node model.social_analytics.fct_daily_metrics
[0m17:15:55.083589 [debug] [Thread-1 (]: Began running node model.social_analytics.moving_avg
[0m17:15:55.085969 [info ] [Thread-1 (]: 3 of 4 START sql table model analytics_analytics_analytics.moving_avg .......... [RUN]
[0m17:15:55.087729 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.social_analytics.fct_daily_metrics, now model.social_analytics.moving_avg)
[0m17:15:55.088976 [debug] [Thread-1 (]: Began compiling node model.social_analytics.moving_avg
[0m17:15:55.094429 [debug] [Thread-1 (]: Writing injected SQL for node "model.social_analytics.moving_avg"
[0m17:15:55.103116 [debug] [Thread-1 (]: Began executing node model.social_analytics.moving_avg
[0m17:15:55.108200 [debug] [Thread-1 (]: Writing runtime sql for node "model.social_analytics.moving_avg"
[0m17:15:55.119105 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.moving_avg"
[0m17:15:55.120587 [debug] [Thread-1 (]: On model.social_analytics.moving_avg: BEGIN
[0m17:15:55.121766 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:15:55.131553 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m17:15:55.133119 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.moving_avg"
[0m17:15:55.134308 [debug] [Thread-1 (]: On model.social_analytics.moving_avg: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.moving_avg"} */

  
    

  create  table "social_analytics"."analytics_analytics_analytics"."moving_avg__dbt_tmp"
  
  
    as
  
  (
    

with base as (
    select
        platform,
        date_trunc('day', posted_at_utc) as post_date,
        (like_count + comment_count + share_count) as engagement
    from "social_analytics"."analytics_analytics"."stg_posts"
),

daily as (
    select
        platform,
        post_date,
        sum(engagement) as daily_engagement
    from base
    group by platform, post_date
)

select
    platform,
    post_date,
    daily_engagement,
    avg(daily_engagement) over (
        partition by platform
        order by post_date
        rows between 6 preceding and current row
    ) as engagement_7d_moving_avg
from daily
order by platform, post_date
  );
  
[0m17:15:55.147865 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.012 seconds
[0m17:15:55.152209 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.moving_avg"
[0m17:15:55.153614 [debug] [Thread-1 (]: On model.social_analytics.moving_avg: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.moving_avg"} */
alter table "social_analytics"."analytics_analytics_analytics"."moving_avg__dbt_tmp" rename to "moving_avg"
[0m17:15:55.155149 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:15:55.157174 [debug] [Thread-1 (]: On model.social_analytics.moving_avg: COMMIT
[0m17:15:55.158440 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.moving_avg"
[0m17:15:55.159643 [debug] [Thread-1 (]: On model.social_analytics.moving_avg: COMMIT
[0m17:15:55.163043 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m17:15:55.167479 [debug] [Thread-1 (]: Applying DROP to: "social_analytics"."analytics_analytics_analytics"."moving_avg__dbt_backup"
[0m17:15:55.169265 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.moving_avg"
[0m17:15:55.170527 [debug] [Thread-1 (]: On model.social_analytics.moving_avg: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.moving_avg"} */
drop table if exists "social_analytics"."analytics_analytics_analytics"."moving_avg__dbt_backup" cascade
[0m17:15:55.173248 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m17:15:55.175957 [debug] [Thread-1 (]: On model.social_analytics.moving_avg: Close
[0m17:15:55.177361 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22da8901-5579-4889-bb54-aec713548375', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b858beed0>]}
[0m17:15:55.178992 [info ] [Thread-1 (]: 3 of 4 OK created sql table model analytics_analytics_analytics.moving_avg ..... [[32mSELECT 8[0m in 0.09s]
[0m17:15:55.180454 [debug] [Thread-1 (]: Finished running node model.social_analytics.moving_avg
[0m17:15:55.181594 [debug] [Thread-1 (]: Began running node model.social_analytics.top_posts
[0m17:15:55.182938 [info ] [Thread-1 (]: 4 of 4 START sql table model analytics_analytics.top_posts ..................... [RUN]
[0m17:15:55.184011 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.social_analytics.moving_avg, now model.social_analytics.top_posts)
[0m17:15:55.184916 [debug] [Thread-1 (]: Began compiling node model.social_analytics.top_posts
[0m17:15:55.190161 [debug] [Thread-1 (]: Writing injected SQL for node "model.social_analytics.top_posts"
[0m17:15:55.199462 [debug] [Thread-1 (]: Began executing node model.social_analytics.top_posts
[0m17:15:55.204314 [debug] [Thread-1 (]: Writing runtime sql for node "model.social_analytics.top_posts"
[0m17:15:55.212527 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.top_posts"
[0m17:15:55.213828 [debug] [Thread-1 (]: On model.social_analytics.top_posts: BEGIN
[0m17:15:55.214943 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:15:55.224420 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m17:15:55.226013 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.top_posts"
[0m17:15:55.227177 [debug] [Thread-1 (]: On model.social_analytics.top_posts: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.top_posts"} */

  
    

  create  table "social_analytics"."analytics_analytics"."top_posts__dbt_tmp"
  
  
    as
  
  (
    

with ranked as (
    select
        id,
        platform,
        author_name,
        content_text,
        content_url,
        (like_count + comment_count + share_count) as engagement_score,
        row_number() over (order by (like_count + comment_count + share_count) desc) as overall_rank,
        row_number() over (partition by platform order by (like_count + comment_count + share_count) desc) as platform_rank
    from "social_analytics"."analytics_analytics"."stg_posts"
)
select *
from ranked
where overall_rank <= 5
   or platform_rank <= 3
  );
  
[0m17:15:55.236136 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.008 seconds
[0m17:15:55.241330 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.top_posts"
[0m17:15:55.242855 [debug] [Thread-1 (]: On model.social_analytics.top_posts: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.top_posts"} */
alter table "social_analytics"."analytics_analytics"."top_posts" rename to "top_posts__dbt_backup"
[0m17:15:55.244719 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:15:55.248679 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.top_posts"
[0m17:15:55.250026 [debug] [Thread-1 (]: On model.social_analytics.top_posts: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.top_posts"} */
alter table "social_analytics"."analytics_analytics"."top_posts__dbt_tmp" rename to "top_posts"
[0m17:15:55.251754 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:15:55.254092 [debug] [Thread-1 (]: On model.social_analytics.top_posts: COMMIT
[0m17:15:55.255315 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.top_posts"
[0m17:15:55.256642 [debug] [Thread-1 (]: On model.social_analytics.top_posts: COMMIT
[0m17:15:55.259919 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m17:15:55.265837 [debug] [Thread-1 (]: Applying DROP to: "social_analytics"."analytics_analytics"."top_posts__dbt_backup"
[0m17:15:55.267533 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.top_posts"
[0m17:15:55.268782 [debug] [Thread-1 (]: On model.social_analytics.top_posts: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.top_posts"} */
drop table if exists "social_analytics"."analytics_analytics"."top_posts__dbt_backup" cascade
[0m17:15:55.273022 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m17:15:55.275852 [debug] [Thread-1 (]: On model.social_analytics.top_posts: Close
[0m17:15:55.277445 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '22da8901-5579-4889-bb54-aec713548375', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b857da0d0>]}
[0m17:15:55.279180 [info ] [Thread-1 (]: 4 of 4 OK created sql table model analytics_analytics.top_posts ................ [[32mSELECT 8[0m in 0.09s]
[0m17:15:55.280717 [debug] [Thread-1 (]: Finished running node model.social_analytics.top_posts
[0m17:15:55.283085 [debug] [MainThread]: Using postgres connection "master"
[0m17:15:55.284438 [debug] [MainThread]: On master: BEGIN
[0m17:15:55.285907 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:15:55.295765 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m17:15:55.297092 [debug] [MainThread]: On master: COMMIT
[0m17:15:55.298140 [debug] [MainThread]: Using postgres connection "master"
[0m17:15:55.299516 [debug] [MainThread]: On master: COMMIT
[0m17:15:55.300810 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:15:55.301934 [debug] [MainThread]: On master: Close
[0m17:15:55.303475 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:15:55.304559 [debug] [MainThread]: Connection 'model.social_analytics.top_posts' was properly closed.
[0m17:15:55.305814 [info ] [MainThread]: 
[0m17:15:55.307072 [info ] [MainThread]: Finished running 3 table models, 1 view model in 0 hours 0 minutes and 1.03 seconds (1.03s).
[0m17:15:55.308970 [debug] [MainThread]: Command end result
[0m17:15:55.348769 [debug] [MainThread]: Wrote artifact WritableManifest to dbt_project/target/manifest.json
[0m17:15:55.357482 [debug] [MainThread]: Wrote artifact SemanticManifest to dbt_project/target/semantic_manifest.json
[0m17:15:55.370958 [debug] [MainThread]: Wrote artifact RunExecutionResult to dbt_project/target/run_results.json
[0m17:15:55.372528 [info ] [MainThread]: 
[0m17:15:55.374084 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:15:55.375321 [info ] [MainThread]: 
[0m17:15:55.376863 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m17:15:55.379703 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.1977305, "process_in_blocks": "0", "process_kernel_time": 1.410989, "process_mem_max_rss": "128836", "process_out_blocks": "0", "process_user_time": 2.420239}
[0m17:15:55.381175 [debug] [MainThread]: Command `dbt run` succeeded at 17:15:55.381010 after 2.20 seconds
[0m17:15:55.382740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b8e659d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b8e658ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8b858ca290>]}
[0m17:15:55.384701 [debug] [MainThread]: Flushing usage events
[0m17:15:56.370842 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:17:15.989319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe452e3af90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe452e70650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe452e39190>]}


============================== 17:17:15.994047 | b1635484-69d9-4dc6-a853-ffe097aa735c ==============================
[0m17:17:15.994047 [info ] [MainThread]: Running with dbt=1.10.9
[0m17:17:15.995690 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'use_colors': 'True', 'target_path': 'None', 'debug': 'False', 'profiles_dir': '/root/.dbt', 'introspect': 'True', 'log_path': 'dbt_project/logs', 'printer_width': '80', 'log_format': 'default', 'static_parser': 'True', 'warn_error': 'None', 'partial_parse': 'True', 'fail_fast': 'False', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'empty': 'False', 'no_print': 'None', 'invocation_command': 'dbt run --project-dir dbt_project', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'write_json': 'True', 'log_cache_events': 'False'}
[0m17:17:16.185268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b1635484-69d9-4dc6-a853-ffe097aa735c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe452553ad0>]}
[0m17:17:16.253381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b1635484-69d9-4dc6-a853-ffe097aa735c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe455a25290>]}
[0m17:17:16.255967 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m17:17:16.335357 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m17:17:16.339399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab40cb9150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab40f85210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab40cb92d0>]}


============================== 17:17:16.345064 | c0d0ee98-5bb9-42ec-88f8-36f1f80b9ffb ==============================
[0m17:17:16.345064 [info ] [MainThread]: Running with dbt=1.10.9
[0m17:17:16.347129 [debug] [MainThread]: running dbt with arguments {'debug': 'False', 'warn_error': 'None', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'log_path': 'dbt_project/logs', 'fail_fast': 'False', 'version_check': 'True', 'introspect': 'True', 'use_experimental_parser': 'False', 'profiles_dir': '/root/.dbt', 'cache_selected_only': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'printer_width': '80', 'empty': 'False', 'log_format': 'default', 'write_json': 'True', 'static_parser': 'True', 'quiet': 'False', 'use_colors': 'True', 'target_path': 'None', 'partial_parse': 'True', 'invocation_command': 'dbt run --project-dir dbt_project', 'no_print': 'None', 'indirect_selection': 'eager'}
[0m17:17:16.534828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c0d0ee98-5bb9-42ec-88f8-36f1f80b9ffb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab4039e790>]}
[0m17:17:16.537630 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:17:16.539045 [debug] [MainThread]: Partial parsing: updated file: social_analytics://models/moving_avg.sql
[0m17:17:16.605865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c0d0ee98-5bb9-42ec-88f8-36f1f80b9ffb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab438e0910>]}
[0m17:17:16.607919 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m17:17:16.698534 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m17:17:16.827912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b1635484-69d9-4dc6-a853-ffe097aa735c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe45344c850>]}
[0m17:17:16.845043 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:17:16.846959 [debug] [MainThread]: Partial parsing: updated file: social_analytics://models/moving_avg.sql
[0m17:17:16.901106 [debug] [MainThread]: Wrote artifact WritableManifest to dbt_project/target/manifest.json
[0m17:17:16.908429 [debug] [MainThread]: Wrote artifact SemanticManifest to dbt_project/target/semantic_manifest.json
[0m17:17:16.944826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b1635484-69d9-4dc6-a853-ffe097aa735c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe450d38fd0>]}
[0m17:17:16.946749 [info ] [MainThread]: Found 4 models, 434 macros
[0m17:17:16.948385 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b1635484-69d9-4dc6-a853-ffe097aa735c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4511f4610>]}
[0m17:17:16.951971 [info ] [MainThread]: 
[0m17:17:16.953780 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:17:16.955306 [info ] [MainThread]: 
[0m17:17:16.956790 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:17:16.963526 [debug] [ThreadPool]: Acquiring new postgres connection 'list_social_analytics'
[0m17:17:17.125264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c0d0ee98-5bb9-42ec-88f8-36f1f80b9ffb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab3ef11b10>]}
[0m17:17:17.153177 [debug] [ThreadPool]: Using postgres connection "list_social_analytics"
[0m17:17:17.154556 [debug] [ThreadPool]: On list_social_analytics: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "connection_name": "list_social_analytics"} */

    select distinct nspname from pg_namespace
  
[0m17:17:17.156029 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:17:17.166328 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.010 seconds
[0m17:17:17.169224 [debug] [ThreadPool]: On list_social_analytics: Close
[0m17:17:17.172864 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_social_analytics, now list_social_analytics_analytics_analytics)
[0m17:17:17.180449 [debug] [ThreadPool]: Using postgres connection "list_social_analytics_analytics_analytics"
[0m17:17:17.181640 [debug] [ThreadPool]: On list_social_analytics_analytics_analytics: BEGIN
[0m17:17:17.182587 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:17:17.193625 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m17:17:17.194962 [debug] [ThreadPool]: Using postgres connection "list_social_analytics_analytics_analytics"
[0m17:17:17.196176 [debug] [ThreadPool]: On list_social_analytics_analytics_analytics: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "connection_name": "list_social_analytics_analytics_analytics"} */
select
      'social_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'social_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'social_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics'
  
[0m17:17:17.201670 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.004 seconds
[0m17:17:17.204845 [debug] [ThreadPool]: On list_social_analytics_analytics_analytics: ROLLBACK
[0m17:17:17.206409 [debug] [ThreadPool]: On list_social_analytics_analytics_analytics: Close
[0m17:17:17.211945 [debug] [MainThread]: Wrote artifact WritableManifest to dbt_project/target/manifest.json
[0m17:17:17.214384 [debug] [MainThread]: Using postgres connection "master"
[0m17:17:17.215684 [debug] [MainThread]: On master: BEGIN
[0m17:17:17.216959 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:17:17.219888 [debug] [MainThread]: Wrote artifact SemanticManifest to dbt_project/target/semantic_manifest.json
[0m17:17:17.227275 [debug] [MainThread]: SQL status: BEGIN in 0.010 seconds
[0m17:17:17.228917 [debug] [MainThread]: Using postgres connection "master"
[0m17:17:17.230204 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:17:17.237838 [debug] [MainThread]: SQL status: SELECT 1 in 0.006 seconds
[0m17:17:17.240198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b1635484-69d9-4dc6-a853-ffe097aa735c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe451dd3d10>]}
[0m17:17:17.241441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c0d0ee98-5bb9-42ec-88f8-36f1f80b9ffb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab3eb0e050>]}
[0m17:17:17.241538 [debug] [MainThread]: On master: ROLLBACK
[0m17:17:17.243012 [info ] [MainThread]: Found 4 models, 434 macros
[0m17:17:17.243140 [debug] [MainThread]: Using postgres connection "master"
[0m17:17:17.244526 [debug] [MainThread]: On master: BEGIN
[0m17:17:17.244535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c0d0ee98-5bb9-42ec-88f8-36f1f80b9ffb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab403fffd0>]}
[0m17:17:17.246485 [debug] [MainThread]: SQL status: BEGIN in 0.001 seconds
[0m17:17:17.247772 [debug] [MainThread]: On master: COMMIT
[0m17:17:17.247678 [info ] [MainThread]: 
[0m17:17:17.249104 [debug] [MainThread]: Using postgres connection "master"
[0m17:17:17.249115 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:17:17.250568 [debug] [MainThread]: On master: COMMIT
[0m17:17:17.250515 [info ] [MainThread]: 
[0m17:17:17.252382 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:17:17.252381 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:17:17.254047 [debug] [MainThread]: On master: Close
[0m17:17:17.258993 [debug] [ThreadPool]: Acquiring new postgres connection 'list_social_analytics'
[0m17:17:17.262598 [debug] [Thread-1 (]: Began running node model.social_analytics.stg_posts
[0m17:17:17.264188 [info ] [Thread-1 (]: 1 of 4 START sql view model analytics_analytics.stg_posts ...................... [RUN]
[0m17:17:17.265848 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_social_analytics_analytics_analytics, now model.social_analytics.stg_posts)
[0m17:17:17.267193 [debug] [Thread-1 (]: Began compiling node model.social_analytics.stg_posts
[0m17:17:17.277727 [debug] [Thread-1 (]: Writing injected SQL for node "model.social_analytics.stg_posts"
[0m17:17:17.289500 [debug] [Thread-1 (]: Began executing node model.social_analytics.stg_posts
[0m17:17:17.334711 [debug] [Thread-1 (]: Writing runtime sql for node "model.social_analytics.stg_posts"
[0m17:17:17.344729 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.stg_posts"
[0m17:17:17.346512 [debug] [Thread-1 (]: On model.social_analytics.stg_posts: BEGIN
[0m17:17:17.348037 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:17:17.354733 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m17:17:17.356260 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.stg_posts"
[0m17:17:17.357676 [debug] [Thread-1 (]: On model.social_analytics.stg_posts: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.stg_posts"} */

  create view "social_analytics"."analytics_analytics"."stg_posts__dbt_tmp"
    
    
  as (
    

select
    id,
    platform,
    platform_post_id,
    author_name,
    content_text,
    content_url,
    coalesce(like_count, 0) as like_count,
    coalesce(comment_count, 0) as comment_count,
    coalesce(share_count, 0) as share_count,
    posted_at_utc,
    collected_at_utc
from public.posts
  );
[0m17:17:17.361739 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m17:17:17.369937 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.stg_posts"
[0m17:17:17.371503 [debug] [Thread-1 (]: On model.social_analytics.stg_posts: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.stg_posts"} */
alter table "social_analytics"."analytics_analytics"."stg_posts" rename to "stg_posts__dbt_backup"
[0m17:17:17.373155 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:17:17.377465 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.stg_posts"
[0m17:17:17.378996 [debug] [Thread-1 (]: On model.social_analytics.stg_posts: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.stg_posts"} */
alter table "social_analytics"."analytics_analytics"."stg_posts__dbt_tmp" rename to "stg_posts"
[0m17:17:17.380862 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:17:17.386168 [debug] [ThreadPool]: Using postgres connection "list_social_analytics"
[0m17:17:17.387480 [debug] [ThreadPool]: On list_social_analytics: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "connection_name": "list_social_analytics"} */

    select distinct nspname from pg_namespace
  
[0m17:17:17.388493 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:17:17.398354 [debug] [Thread-1 (]: On model.social_analytics.stg_posts: COMMIT
[0m17:17:17.398988 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.010 seconds
[0m17:17:17.400093 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.stg_posts"
[0m17:17:17.401156 [debug] [ThreadPool]: On list_social_analytics: Close
[0m17:17:17.401327 [debug] [Thread-1 (]: On model.social_analytics.stg_posts: COMMIT
[0m17:17:17.403872 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_social_analytics, now list_social_analytics_analytics_analytics)
[0m17:17:17.404333 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m17:17:17.411114 [debug] [ThreadPool]: Using postgres connection "list_social_analytics_analytics_analytics"
[0m17:17:17.411947 [debug] [Thread-1 (]: Applying DROP to: "social_analytics"."analytics_analytics"."stg_posts__dbt_backup"
[0m17:17:17.412561 [debug] [ThreadPool]: On list_social_analytics_analytics_analytics: BEGIN
[0m17:17:17.413807 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:17:17.417863 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.stg_posts"
[0m17:17:17.419221 [debug] [Thread-1 (]: On model.social_analytics.stg_posts: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.stg_posts"} */
drop view if exists "social_analytics"."analytics_analytics"."stg_posts__dbt_backup" cascade
[0m17:17:17.423182 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m17:17:17.424455 [debug] [ThreadPool]: SQL status: BEGIN in 0.011 seconds
[0m17:17:17.425591 [debug] [ThreadPool]: Using postgres connection "list_social_analytics_analytics_analytics"
[0m17:17:17.426677 [debug] [ThreadPool]: On list_social_analytics_analytics_analytics: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "connection_name": "list_social_analytics_analytics_analytics"} */
select
      'social_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'social_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'social_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics'
  
[0m17:17:17.426697 [debug] [Thread-1 (]: On model.social_analytics.stg_posts: Close
[0m17:17:17.429795 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b1635484-69d9-4dc6-a853-ffe097aa735c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe450d74c10>]}
[0m17:17:17.431417 [info ] [Thread-1 (]: 1 of 4 OK created sql view model analytics_analytics.stg_posts ................. [[32mCREATE VIEW[0m in 0.16s]
[0m17:17:17.431345 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.003 seconds
[0m17:17:17.432828 [debug] [Thread-1 (]: Finished running node model.social_analytics.stg_posts
[0m17:17:17.433839 [debug] [ThreadPool]: On list_social_analytics_analytics_analytics: ROLLBACK
[0m17:17:17.434969 [debug] [Thread-1 (]: Began running node model.social_analytics.fct_daily_metrics
[0m17:17:17.435123 [debug] [ThreadPool]: On list_social_analytics_analytics_analytics: Close
[0m17:17:17.436238 [info ] [Thread-1 (]: 2 of 4 START sql table model analytics_analytics.fct_daily_metrics ............. [RUN]
[0m17:17:17.437943 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.social_analytics.stg_posts, now model.social_analytics.fct_daily_metrics)
[0m17:17:17.439241 [debug] [Thread-1 (]: Began compiling node model.social_analytics.fct_daily_metrics
[0m17:17:17.442402 [debug] [MainThread]: Using postgres connection "master"
[0m17:17:17.443946 [debug] [MainThread]: On master: BEGIN
[0m17:17:17.444395 [debug] [Thread-1 (]: Writing injected SQL for node "model.social_analytics.fct_daily_metrics"
[0m17:17:17.445327 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:17:17.453590 [debug] [Thread-1 (]: Began executing node model.social_analytics.fct_daily_metrics
[0m17:17:17.453805 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m17:17:17.455085 [debug] [MainThread]: Using postgres connection "master"
[0m17:17:17.456209 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:17:17.462079 [debug] [MainThread]: SQL status: SELECT 1 in 0.005 seconds
[0m17:17:17.464382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c0d0ee98-5bb9-42ec-88f8-36f1f80b9ffb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab3ef22590>]}
[0m17:17:17.465715 [debug] [MainThread]: On master: ROLLBACK
[0m17:17:17.467093 [debug] [MainThread]: Using postgres connection "master"
[0m17:17:17.468488 [debug] [MainThread]: On master: BEGIN
[0m17:17:17.470168 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m17:17:17.471262 [debug] [MainThread]: On master: COMMIT
[0m17:17:17.472303 [debug] [MainThread]: Using postgres connection "master"
[0m17:17:17.473398 [debug] [MainThread]: On master: COMMIT
[0m17:17:17.474532 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:17:17.475828 [debug] [MainThread]: On master: Close
[0m17:17:17.477830 [debug] [Thread-1 (]: Writing runtime sql for node "model.social_analytics.fct_daily_metrics"
[0m17:17:17.482429 [debug] [Thread-1 (]: Began running node model.social_analytics.stg_posts
[0m17:17:17.484023 [info ] [Thread-1 (]: 1 of 4 START sql view model analytics_analytics.stg_posts ...................... [RUN]
[0m17:17:17.485478 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_social_analytics_analytics_analytics, now model.social_analytics.stg_posts)
[0m17:17:17.486791 [debug] [Thread-1 (]: Began compiling node model.social_analytics.stg_posts
[0m17:17:17.488001 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.fct_daily_metrics"
[0m17:17:17.489456 [debug] [Thread-1 (]: On model.social_analytics.fct_daily_metrics: BEGIN
[0m17:17:17.490729 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:17:17.496816 [debug] [Thread-1 (]: Writing injected SQL for node "model.social_analytics.stg_posts"
[0m17:17:17.500298 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m17:17:17.501618 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.fct_daily_metrics"
[0m17:17:17.503245 [debug] [Thread-1 (]: On model.social_analytics.fct_daily_metrics: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.fct_daily_metrics"} */

  
    

  create  table "social_analytics"."analytics_analytics"."fct_daily_metrics__dbt_tmp"
  
  
    as
  
  (
    

select
    platform,
    date_trunc('day', posted_at_utc) as post_date,
    count(*) as total_posts,
    sum(like_count) as total_likes,
    sum(comment_count) as total_comments,
    sum(share_count) as total_shares,
    sum(like_count + comment_count + share_count) as engagement_score
from "social_analytics"."analytics_analytics"."stg_posts"
group by platform, date_trunc('day', posted_at_utc)
  );
  
[0m17:17:17.506791 [debug] [Thread-1 (]: Began executing node model.social_analytics.stg_posts
[0m17:17:17.514554 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.010 seconds
[0m17:17:17.522229 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.fct_daily_metrics"
[0m17:17:17.523445 [debug] [Thread-1 (]: On model.social_analytics.fct_daily_metrics: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.fct_daily_metrics"} */
alter table "social_analytics"."analytics_analytics"."fct_daily_metrics" rename to "fct_daily_metrics__dbt_backup"
[0m17:17:17.525130 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:17:17.528870 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.fct_daily_metrics"
[0m17:17:17.529998 [debug] [Thread-1 (]: On model.social_analytics.fct_daily_metrics: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.fct_daily_metrics"} */
alter table "social_analytics"."analytics_analytics"."fct_daily_metrics__dbt_tmp" rename to "fct_daily_metrics"
[0m17:17:17.531510 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:17:17.534040 [debug] [Thread-1 (]: On model.social_analytics.fct_daily_metrics: COMMIT
[0m17:17:17.535007 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.fct_daily_metrics"
[0m17:17:17.535927 [debug] [Thread-1 (]: On model.social_analytics.fct_daily_metrics: COMMIT
[0m17:17:17.538803 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m17:17:17.542259 [debug] [Thread-1 (]: Applying DROP to: "social_analytics"."analytics_analytics"."fct_daily_metrics__dbt_backup"
[0m17:17:17.544269 [debug] [Thread-1 (]: Writing runtime sql for node "model.social_analytics.stg_posts"
[0m17:17:17.546193 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.fct_daily_metrics"
[0m17:17:17.547323 [debug] [Thread-1 (]: On model.social_analytics.fct_daily_metrics: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.fct_daily_metrics"} */
drop table if exists "social_analytics"."analytics_analytics"."fct_daily_metrics__dbt_backup" cascade
[0m17:17:17.552003 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m17:17:17.552379 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.stg_posts"
[0m17:17:17.553521 [debug] [Thread-1 (]: On model.social_analytics.stg_posts: BEGIN
[0m17:17:17.554334 [debug] [Thread-1 (]: On model.social_analytics.fct_daily_metrics: Close
[0m17:17:17.554472 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:17:17.555713 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b1635484-69d9-4dc6-a853-ffe097aa735c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe442627ad0>]}
[0m17:17:17.557272 [info ] [Thread-1 (]: 2 of 4 OK created sql table model analytics_analytics.fct_daily_metrics ........ [[32mSELECT 8[0m in 0.12s]
[0m17:17:17.558711 [debug] [Thread-1 (]: Finished running node model.social_analytics.fct_daily_metrics
[0m17:17:17.559966 [debug] [Thread-1 (]: Began running node model.social_analytics.moving_avg
[0m17:17:17.561165 [info ] [Thread-1 (]: 3 of 4 START sql table model analytics_analytics.moving_avg .................... [RUN]
[0m17:17:17.561908 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m17:17:17.562337 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.social_analytics.fct_daily_metrics, now model.social_analytics.moving_avg)
[0m17:17:17.563009 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.stg_posts"
[0m17:17:17.563293 [debug] [Thread-1 (]: Began compiling node model.social_analytics.moving_avg
[0m17:17:17.563977 [debug] [Thread-1 (]: On model.social_analytics.stg_posts: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.stg_posts"} */

  create view "social_analytics"."analytics_analytics"."stg_posts__dbt_tmp"
    
    
  as (
    

select
    id,
    platform,
    platform_post_id,
    author_name,
    content_text,
    content_url,
    coalesce(like_count, 0) as like_count,
    coalesce(comment_count, 0) as comment_count,
    coalesce(share_count, 0) as share_count,
    posted_at_utc,
    collected_at_utc
from public.posts
  );
[0m17:17:17.566922 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.002 seconds
[0m17:17:17.569430 [debug] [Thread-1 (]: Writing injected SQL for node "model.social_analytics.moving_avg"
[0m17:17:17.574340 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.stg_posts"
[0m17:17:17.575696 [debug] [Thread-1 (]: On model.social_analytics.stg_posts: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.stg_posts"} */
alter table "social_analytics"."analytics_analytics"."stg_posts" rename to "stg_posts__dbt_backup"
[0m17:17:17.577723 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:17:17.577663 [debug] [Thread-1 (]: Began executing node model.social_analytics.moving_avg
[0m17:17:17.582145 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.stg_posts"
[0m17:17:17.582962 [debug] [Thread-1 (]: Writing runtime sql for node "model.social_analytics.moving_avg"
[0m17:17:17.583572 [debug] [Thread-1 (]: On model.social_analytics.stg_posts: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.stg_posts"} */
alter table "social_analytics"."analytics_analytics"."stg_posts__dbt_tmp" rename to "stg_posts"
[0m17:17:17.585029 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:17:17.591591 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.moving_avg"
[0m17:17:17.593036 [debug] [Thread-1 (]: On model.social_analytics.moving_avg: BEGIN
[0m17:17:17.594249 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:17:17.602244 [debug] [Thread-1 (]: On model.social_analytics.stg_posts: COMMIT
[0m17:17:17.603790 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.stg_posts"
[0m17:17:17.604143 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m17:17:17.605059 [debug] [Thread-1 (]: On model.social_analytics.stg_posts: COMMIT
[0m17:17:17.605219 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.moving_avg"
[0m17:17:17.606349 [debug] [Thread-1 (]: On model.social_analytics.moving_avg: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.moving_avg"} */

  
    

  create  table "social_analytics"."analytics_analytics"."moving_avg__dbt_tmp"
  
  
    as
  
  (
    


with base as (
    select
        platform,
        date_trunc('day', posted_at_utc) as post_date,
        (like_count + comment_count + share_count) as engagement
    from "social_analytics"."analytics_analytics"."stg_posts"
),

daily as (
    select
        platform,
        post_date,
        sum(engagement) as daily_engagement
    from base
    group by platform, post_date
)

select
    platform,
    post_date,
    daily_engagement,
    avg(daily_engagement) over (
        partition by platform
        order by post_date
        rows between 6 preceding and current row
    ) as engagement_7d_moving_avg
from daily
order by platform, post_date
  );
  
[0m17:17:17.608675 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m17:17:17.615860 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.008 seconds
[0m17:17:17.616757 [debug] [Thread-1 (]: Applying DROP to: "social_analytics"."analytics_analytics"."stg_posts__dbt_backup"
[0m17:17:17.620546 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.moving_avg"
[0m17:17:17.621766 [debug] [Thread-1 (]: On model.social_analytics.moving_avg: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.moving_avg"} */
alter table "social_analytics"."analytics_analytics"."moving_avg__dbt_tmp" rename to "moving_avg"
[0m17:17:17.622572 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.stg_posts"
[0m17:17:17.623182 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:17:17.623478 [debug] [Thread-1 (]: On model.social_analytics.stg_posts: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.stg_posts"} */
drop view if exists "social_analytics"."analytics_analytics"."stg_posts__dbt_backup" cascade
[0m17:17:17.625079 [debug] [Thread-1 (]: On model.social_analytics.moving_avg: COMMIT
[0m17:17:17.626066 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.moving_avg"
[0m17:17:17.626765 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m17:17:17.627017 [debug] [Thread-1 (]: On model.social_analytics.moving_avg: COMMIT
[0m17:17:17.629805 [debug] [Thread-1 (]: On model.social_analytics.stg_posts: Close
[0m17:17:17.629874 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m17:17:17.632503 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c0d0ee98-5bb9-42ec-88f8-36f1f80b9ffb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab3f3efb50>]}
[0m17:17:17.633521 [debug] [Thread-1 (]: Applying DROP to: "social_analytics"."analytics_analytics"."moving_avg__dbt_backup"
[0m17:17:17.633877 [info ] [Thread-1 (]: 1 of 4 OK created sql view model analytics_analytics.stg_posts ................. [[32mCREATE VIEW[0m in 0.15s]
[0m17:17:17.635009 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.moving_avg"
[0m17:17:17.635344 [debug] [Thread-1 (]: Finished running node model.social_analytics.stg_posts
[0m17:17:17.636227 [debug] [Thread-1 (]: On model.social_analytics.moving_avg: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.moving_avg"} */
drop table if exists "social_analytics"."analytics_analytics"."moving_avg__dbt_backup" cascade
[0m17:17:17.637346 [debug] [Thread-1 (]: Began running node model.social_analytics.fct_daily_metrics
[0m17:17:17.637591 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.000 seconds
[0m17:17:17.638570 [info ] [Thread-1 (]: 2 of 4 START sql table model analytics_analytics.fct_daily_metrics ............. [RUN]
[0m17:17:17.639645 [debug] [Thread-1 (]: On model.social_analytics.moving_avg: Close
[0m17:17:17.639958 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.social_analytics.stg_posts, now model.social_analytics.fct_daily_metrics)
[0m17:17:17.640968 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b1635484-69d9-4dc6-a853-ffe097aa735c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4426ca210>]}
[0m17:17:17.640870 [debug] [Thread-1 (]: Began compiling node model.social_analytics.fct_daily_metrics
[0m17:17:17.642191 [info ] [Thread-1 (]: 3 of 4 OK created sql table model analytics_analytics.moving_avg ............... [[32mSELECT 8[0m in 0.08s]
[0m17:17:17.643594 [debug] [Thread-1 (]: Finished running node model.social_analytics.moving_avg
[0m17:17:17.644548 [debug] [Thread-1 (]: Began running node model.social_analytics.top_posts
[0m17:17:17.645008 [debug] [Thread-1 (]: Writing injected SQL for node "model.social_analytics.fct_daily_metrics"
[0m17:17:17.645625 [info ] [Thread-1 (]: 4 of 4 START sql table model analytics_analytics.top_posts ..................... [RUN]
[0m17:17:17.646794 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.social_analytics.moving_avg, now model.social_analytics.top_posts)
[0m17:17:17.647805 [debug] [Thread-1 (]: Began compiling node model.social_analytics.top_posts
[0m17:17:17.652239 [debug] [Thread-1 (]: Writing injected SQL for node "model.social_analytics.top_posts"
[0m17:17:17.652798 [debug] [Thread-1 (]: Began executing node model.social_analytics.fct_daily_metrics
[0m17:17:17.660548 [debug] [Thread-1 (]: Began executing node model.social_analytics.top_posts
[0m17:17:17.665918 [debug] [Thread-1 (]: Writing runtime sql for node "model.social_analytics.top_posts"
[0m17:17:17.674808 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.top_posts"
[0m17:17:17.676138 [debug] [Thread-1 (]: On model.social_analytics.top_posts: BEGIN
[0m17:17:17.677268 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:17:17.678293 [debug] [Thread-1 (]: Writing runtime sql for node "model.social_analytics.fct_daily_metrics"
[0m17:17:17.685998 [debug] [Thread-1 (]: SQL status: BEGIN in 0.009 seconds
[0m17:17:17.687211 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.top_posts"
[0m17:17:17.687692 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.fct_daily_metrics"
[0m17:17:17.688233 [debug] [Thread-1 (]: On model.social_analytics.top_posts: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.top_posts"} */

  
    

  create  table "social_analytics"."analytics_analytics"."top_posts__dbt_tmp"
  
  
    as
  
  (
    

with ranked as (
    select
        id,
        platform,
        author_name,
        content_text,
        content_url,
        (like_count + comment_count + share_count) as engagement_score,
        row_number() over (order by (like_count + comment_count + share_count) desc) as overall_rank,
        row_number() over (partition by platform order by (like_count + comment_count + share_count) desc) as platform_rank
    from "social_analytics"."analytics_analytics"."stg_posts"
)
select *
from ranked
where overall_rank <= 5
   or platform_rank <= 3
  );
  
[0m17:17:17.688870 [debug] [Thread-1 (]: On model.social_analytics.fct_daily_metrics: BEGIN
[0m17:17:17.689850 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:17:17.695592 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.006 seconds
[0m17:17:17.700117 [debug] [Thread-1 (]: SQL status: BEGIN in 0.010 seconds
[0m17:17:17.700100 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.top_posts"
[0m17:17:17.701412 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.fct_daily_metrics"
[0m17:17:17.701425 [debug] [Thread-1 (]: On model.social_analytics.top_posts: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.top_posts"} */
alter table "social_analytics"."analytics_analytics"."top_posts" rename to "top_posts__dbt_backup"
[0m17:17:17.702504 [debug] [Thread-1 (]: On model.social_analytics.fct_daily_metrics: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.fct_daily_metrics"} */

  
    

  create  table "social_analytics"."analytics_analytics"."fct_daily_metrics__dbt_tmp"
  
  
    as
  
  (
    

select
    platform,
    date_trunc('day', posted_at_utc) as post_date,
    count(*) as total_posts,
    sum(like_count) as total_likes,
    sum(comment_count) as total_comments,
    sum(share_count) as total_shares,
    sum(like_count + comment_count + share_count) as engagement_score
from "social_analytics"."analytics_analytics"."stg_posts"
group by platform, date_trunc('day', posted_at_utc)
  );
  
[0m17:17:17.702966 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:17:17.707077 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.top_posts"
[0m17:17:17.708311 [debug] [Thread-1 (]: On model.social_analytics.top_posts: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.top_posts"} */
alter table "social_analytics"."analytics_analytics"."top_posts__dbt_tmp" rename to "top_posts"
[0m17:17:17.709524 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:17:17.710820 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.007 seconds
[0m17:17:17.711557 [debug] [Thread-1 (]: On model.social_analytics.top_posts: COMMIT
[0m17:17:17.712544 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.top_posts"
[0m17:17:17.713626 [debug] [Thread-1 (]: On model.social_analytics.top_posts: COMMIT
[0m17:17:17.717411 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m17:17:17.720558 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.fct_daily_metrics"
[0m17:17:17.721376 [debug] [Thread-1 (]: Applying DROP to: "social_analytics"."analytics_analytics"."top_posts__dbt_backup"
[0m17:17:17.722032 [debug] [Thread-1 (]: On model.social_analytics.fct_daily_metrics: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.fct_daily_metrics"} */
alter table "social_analytics"."analytics_analytics"."fct_daily_metrics" rename to "fct_daily_metrics__dbt_backup"
[0m17:17:17.722861 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.top_posts"
[0m17:17:17.723680 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:17:17.723895 [debug] [Thread-1 (]: On model.social_analytics.top_posts: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.top_posts"} */
drop table if exists "social_analytics"."analytics_analytics"."top_posts__dbt_backup" cascade
[0m17:17:17.727770 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.fct_daily_metrics"
[0m17:17:17.729223 [debug] [Thread-1 (]: On model.social_analytics.fct_daily_metrics: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.fct_daily_metrics"} */
alter table "social_analytics"."analytics_analytics"."fct_daily_metrics__dbt_tmp" rename to "fct_daily_metrics"
[0m17:17:17.729185 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m17:17:17.731009 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:17:17.731898 [debug] [Thread-1 (]: On model.social_analytics.top_posts: Close
[0m17:17:17.733166 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b1635484-69d9-4dc6-a853-ffe097aa735c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4426eab90>]}
[0m17:17:17.733348 [debug] [Thread-1 (]: On model.social_analytics.fct_daily_metrics: COMMIT
[0m17:17:17.734385 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.fct_daily_metrics"
[0m17:17:17.734473 [info ] [Thread-1 (]: 4 of 4 OK created sql table model analytics_analytics.top_posts ................ [[32mSELECT 8[0m in 0.09s]
[0m17:17:17.735411 [debug] [Thread-1 (]: On model.social_analytics.fct_daily_metrics: COMMIT
[0m17:17:17.735700 [debug] [Thread-1 (]: Finished running node model.social_analytics.top_posts
[0m17:17:17.737861 [debug] [MainThread]: Using postgres connection "master"
[0m17:17:17.738100 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m17:17:17.739060 [debug] [MainThread]: On master: BEGIN
[0m17:17:17.740141 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:17:17.742147 [debug] [Thread-1 (]: Applying DROP to: "social_analytics"."analytics_analytics"."fct_daily_metrics__dbt_backup"
[0m17:17:17.746462 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.fct_daily_metrics"
[0m17:17:17.747652 [debug] [Thread-1 (]: On model.social_analytics.fct_daily_metrics: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.fct_daily_metrics"} */
drop table if exists "social_analytics"."analytics_analytics"."fct_daily_metrics__dbt_backup" cascade
[0m17:17:17.749415 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m17:17:17.750885 [debug] [MainThread]: On master: COMMIT
[0m17:17:17.752033 [debug] [MainThread]: Using postgres connection "master"
[0m17:17:17.752767 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m17:17:17.753203 [debug] [MainThread]: On master: COMMIT
[0m17:17:17.754321 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:17:17.754975 [debug] [Thread-1 (]: On model.social_analytics.fct_daily_metrics: Close
[0m17:17:17.755492 [debug] [MainThread]: On master: Close
[0m17:17:17.756459 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c0d0ee98-5bb9-42ec-88f8-36f1f80b9ffb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab3c4f4e10>]}
[0m17:17:17.756947 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:17:17.758269 [debug] [MainThread]: Connection 'model.social_analytics.top_posts' was properly closed.
[0m17:17:17.758498 [info ] [Thread-1 (]: 2 of 4 OK created sql table model analytics_analytics.fct_daily_metrics ........ [[32mSELECT 8[0m in 0.12s]
[0m17:17:17.760014 [info ] [MainThread]: 
[0m17:17:17.760529 [debug] [Thread-1 (]: Finished running node model.social_analytics.fct_daily_metrics
[0m17:17:17.761543 [info ] [MainThread]: Finished running 3 table models, 1 view model in 0 hours 0 minutes and 0.80 seconds (0.80s).
[0m17:17:17.761991 [debug] [Thread-1 (]: Began running node model.social_analytics.moving_avg
[0m17:17:17.763138 [info ] [Thread-1 (]: 3 of 4 START sql table model analytics_analytics.moving_avg .................... [RUN]
[0m17:17:17.763436 [debug] [MainThread]: Command end result
[0m17:17:17.764452 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.social_analytics.fct_daily_metrics, now model.social_analytics.moving_avg)
[0m17:17:17.765488 [debug] [Thread-1 (]: Began compiling node model.social_analytics.moving_avg
[0m17:17:17.771729 [debug] [Thread-1 (]: Writing injected SQL for node "model.social_analytics.moving_avg"
[0m17:17:17.779289 [debug] [Thread-1 (]: Began executing node model.social_analytics.moving_avg
[0m17:17:17.785711 [debug] [Thread-1 (]: Writing runtime sql for node "model.social_analytics.moving_avg"
[0m17:17:17.793666 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.moving_avg"
[0m17:17:17.795269 [debug] [Thread-1 (]: On model.social_analytics.moving_avg: BEGIN
[0m17:17:17.796536 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:17:17.802926 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m17:17:17.804588 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.moving_avg"
[0m17:17:17.804273 [debug] [MainThread]: Wrote artifact WritableManifest to dbt_project/target/manifest.json
[0m17:17:17.805977 [debug] [Thread-1 (]: On model.social_analytics.moving_avg: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.moving_avg"} */

  
    

  create  table "social_analytics"."analytics_analytics"."moving_avg__dbt_tmp"
  
  
    as
  
  (
    


with base as (
    select
        platform,
        date_trunc('day', posted_at_utc) as post_date,
        (like_count + comment_count + share_count) as engagement
    from "social_analytics"."analytics_analytics"."stg_posts"
),

daily as (
    select
        platform,
        post_date,
        sum(engagement) as daily_engagement
    from base
    group by platform, post_date
)

select
    platform,
    post_date,
    daily_engagement,
    avg(daily_engagement) over (
        partition by platform
        order by post_date
        rows between 6 preceding and current row
    ) as engagement_7d_moving_avg
from daily
order by platform, post_date
  );
  
[0m17:17:17.811654 [debug] [MainThread]: Wrote artifact SemanticManifest to dbt_project/target/semantic_manifest.json
[0m17:17:17.815942 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.008 seconds
[0m17:17:17.821087 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.moving_avg"
[0m17:17:17.822394 [debug] [Thread-1 (]: On model.social_analytics.moving_avg: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.moving_avg"} */
alter table "social_analytics"."analytics_analytics"."moving_avg__dbt_tmp" rename to "moving_avg"
[0m17:17:17.822887 [debug] [MainThread]: Wrote artifact RunExecutionResult to dbt_project/target/run_results.json
[0m17:17:17.823941 [info ] [MainThread]: 
[0m17:17:17.825239 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:17:17.825769 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "moving_avg" already exists

[0m17:17:17.826656 [info ] [MainThread]: 
[0m17:17:17.827038 [debug] [Thread-1 (]: On model.social_analytics.moving_avg: ROLLBACK
[0m17:17:17.827802 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m17:17:17.828487 [debug] [Thread-1 (]: Postgres adapter: Error running SQL: macro rename_relation
[0m17:17:17.829496 [debug] [Thread-1 (]: Postgres adapter: Rolling back transaction.
[0m17:17:17.830460 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.9147493, "process_in_blocks": "0", "process_kernel_time": 0.79575, "process_mem_max_rss": "129396", "process_out_blocks": "0", "process_user_time": 2.477905}
[0m17:17:17.830685 [debug] [Thread-1 (]: On model.social_analytics.moving_avg: Close
[0m17:17:17.831736 [debug] [MainThread]: Command `dbt run` succeeded at 17:17:17.831594 after 1.92 seconds
[0m17:17:17.832913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe4577fd850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe45768db90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe45768d910>]}
[0m17:17:17.834198 [debug] [MainThread]: Flushing usage events
[0m17:17:17.845554 [debug] [Thread-1 (]: Database Error in model moving_avg (models/moving_avg.sql)
  relation "moving_avg" already exists
  compiled code at target/run/social_analytics/models/moving_avg.sql
[0m17:17:17.847077 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c0d0ee98-5bb9-42ec-88f8-36f1f80b9ffb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab3c5a5b50>]}
[0m17:17:17.848608 [error] [Thread-1 (]: 3 of 4 ERROR creating sql table model analytics_analytics.moving_avg ........... [[31mERROR[0m in 0.08s]
[0m17:17:17.850100 [debug] [Thread-1 (]: Finished running node model.social_analytics.moving_avg
[0m17:17:17.851260 [debug] [Thread-1 (]: Began running node model.social_analytics.top_posts
[0m17:17:17.851810 [debug] [Thread-4 (]: Marking all children of 'model.social_analytics.moving_avg' to be skipped because of status 'error'.  Reason: Database Error in model moving_avg (models/moving_avg.sql)
  relation "moving_avg" already exists
  compiled code at target/run/social_analytics/models/moving_avg.sql.
[0m17:17:17.852631 [info ] [Thread-1 (]: 4 of 4 START sql table model analytics_analytics.top_posts ..................... [RUN]
[0m17:17:17.855387 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.social_analytics.moving_avg, now model.social_analytics.top_posts)
[0m17:17:17.856391 [debug] [Thread-1 (]: Began compiling node model.social_analytics.top_posts
[0m17:17:17.860439 [debug] [Thread-1 (]: Writing injected SQL for node "model.social_analytics.top_posts"
[0m17:17:17.867243 [debug] [Thread-1 (]: Began executing node model.social_analytics.top_posts
[0m17:17:17.872550 [debug] [Thread-1 (]: Writing runtime sql for node "model.social_analytics.top_posts"
[0m17:17:17.880900 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.top_posts"
[0m17:17:17.882163 [debug] [Thread-1 (]: On model.social_analytics.top_posts: BEGIN
[0m17:17:17.883146 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:17:17.889569 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m17:17:17.890884 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.top_posts"
[0m17:17:17.892098 [debug] [Thread-1 (]: On model.social_analytics.top_posts: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.top_posts"} */

  
    

  create  table "social_analytics"."analytics_analytics"."top_posts__dbt_tmp"
  
  
    as
  
  (
    

with ranked as (
    select
        id,
        platform,
        author_name,
        content_text,
        content_url,
        (like_count + comment_count + share_count) as engagement_score,
        row_number() over (order by (like_count + comment_count + share_count) desc) as overall_rank,
        row_number() over (partition by platform order by (like_count + comment_count + share_count) desc) as platform_rank
    from "social_analytics"."analytics_analytics"."stg_posts"
)
select *
from ranked
where overall_rank <= 5
   or platform_rank <= 3
  );
  
[0m17:17:17.900150 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.007 seconds
[0m17:17:17.904800 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.top_posts"
[0m17:17:17.905863 [debug] [Thread-1 (]: On model.social_analytics.top_posts: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.top_posts"} */
alter table "social_analytics"."analytics_analytics"."top_posts" rename to "top_posts__dbt_backup"
[0m17:17:17.907273 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:17:17.910901 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.top_posts"
[0m17:17:17.911990 [debug] [Thread-1 (]: On model.social_analytics.top_posts: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.top_posts"} */
alter table "social_analytics"."analytics_analytics"."top_posts__dbt_tmp" rename to "top_posts"
[0m17:17:17.913463 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:17:17.915410 [debug] [Thread-1 (]: On model.social_analytics.top_posts: COMMIT
[0m17:17:17.916455 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.top_posts"
[0m17:17:17.917428 [debug] [Thread-1 (]: On model.social_analytics.top_posts: COMMIT
[0m17:17:17.920067 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m17:17:17.923137 [debug] [Thread-1 (]: Applying DROP to: "social_analytics"."analytics_analytics"."top_posts__dbt_backup"
[0m17:17:17.924415 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.top_posts"
[0m17:17:17.925340 [debug] [Thread-1 (]: On model.social_analytics.top_posts: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.top_posts"} */
drop table if exists "social_analytics"."analytics_analytics"."top_posts__dbt_backup" cascade
[0m17:17:17.929070 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m17:17:17.931521 [debug] [Thread-1 (]: On model.social_analytics.top_posts: Close
[0m17:17:17.932936 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c0d0ee98-5bb9-42ec-88f8-36f1f80b9ffb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab3c5a4410>]}
[0m17:17:17.934589 [info ] [Thread-1 (]: 4 of 4 OK created sql table model analytics_analytics.top_posts ................ [[32mSELECT 8[0m in 0.08s]
[0m17:17:17.936156 [debug] [Thread-1 (]: Finished running node model.social_analytics.top_posts
[0m17:17:17.938336 [debug] [MainThread]: Using postgres connection "master"
[0m17:17:17.939334 [debug] [MainThread]: On master: BEGIN
[0m17:17:17.940376 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:17:17.946966 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m17:17:17.948433 [debug] [MainThread]: On master: COMMIT
[0m17:17:17.949583 [debug] [MainThread]: Using postgres connection "master"
[0m17:17:17.950506 [debug] [MainThread]: On master: COMMIT
[0m17:17:17.951956 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:17:17.953472 [debug] [MainThread]: On master: Close
[0m17:17:17.954799 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:17:17.955873 [debug] [MainThread]: Connection 'model.social_analytics.top_posts' was properly closed.
[0m17:17:17.956961 [info ] [MainThread]: 
[0m17:17:17.958066 [info ] [MainThread]: Finished running 3 table models, 1 view model in 0 hours 0 minutes and 0.70 seconds (0.70s).
[0m17:17:17.959994 [debug] [MainThread]: Command end result
[0m17:17:17.999149 [debug] [MainThread]: Wrote artifact WritableManifest to dbt_project/target/manifest.json
[0m17:17:18.005974 [debug] [MainThread]: Wrote artifact SemanticManifest to dbt_project/target/semantic_manifest.json
[0m17:17:18.018464 [debug] [MainThread]: Wrote artifact RunExecutionResult to dbt_project/target/run_results.json
[0m17:17:18.019739 [info ] [MainThread]: 
[0m17:17:18.021096 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m17:17:18.022516 [info ] [MainThread]: 
[0m17:17:18.023914 [error] [MainThread]: [31mFailure in model moving_avg (models/moving_avg.sql)[0m
[0m17:17:18.025596 [error] [MainThread]:   Database Error in model moving_avg (models/moving_avg.sql)
  relation "moving_avg" already exists
  compiled code at target/run/social_analytics/models/moving_avg.sql
[0m17:17:18.026789 [info ] [MainThread]: 
[0m17:17:18.028258 [info ] [MainThread]:   compiled code at target/compiled/social_analytics/models/moving_avg.sql
[0m17:17:18.029786 [info ] [MainThread]: 
[0m17:17:18.031161 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=4
[0m17:17:18.033403 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.7668631, "process_in_blocks": "32", "process_kernel_time": 0.392068, "process_mem_max_rss": "129376", "process_out_blocks": "0", "process_user_time": 2.412728}
[0m17:17:18.034770 [debug] [MainThread]: Command `dbt run` failed at 17:17:18.034643 after 1.77 seconds
[0m17:17:18.036130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab439ec6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab455499d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fab40cbbe50>]}
[0m17:17:18.037775 [debug] [MainThread]: Flushing usage events
[0m17:17:18.904420 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:17:18.907127 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:18:34.439039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0224f35d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb022759250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0224c4550>]}


============================== 17:18:34.446280 | d390ddd0-adad-4fae-8cca-74e9b56cf5ab ==============================
[0m17:18:34.446280 [info ] [MainThread]: Running with dbt=1.10.9
[0m17:18:34.448377 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'debug': 'False', 'no_print': 'None', 'warn_error': 'None', 'target_path': 'None', 'quiet': 'False', 'empty': 'False', 'printer_width': '80', 'log_cache_events': 'False', 'use_colors': 'True', 'invocation_command': 'dbt run --project-dir dbt_project', 'indirect_selection': 'eager', 'partial_parse': 'True', 'static_parser': 'True', 'use_experimental_parser': 'False', 'write_json': 'True', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'introspect': 'True', 'profiles_dir': '/root/.dbt', 'log_path': 'dbt_project/logs', 'log_format': 'default', 'fail_fast': 'False'}
[0m17:18:34.655599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd390ddd0-adad-4fae-8cca-74e9b56cf5ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb021bd88d0>]}
[0m17:18:34.723235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd390ddd0-adad-4fae-8cca-74e9b56cf5ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0250b05d0>]}
[0m17:18:34.726700 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m17:18:34.772019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f299c3ee0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f299c3ed250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f299c158310>]}


============================== 17:18:34.776291 | e8c9357b-7bdc-495b-9dd2-bd5968f99313 ==============================
[0m17:18:34.776291 [info ] [MainThread]: Running with dbt=1.10.9
[0m17:18:34.778283 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'empty': 'False', 'quiet': 'False', 'log_path': 'dbt_project/logs', 'partial_parse': 'True', 'log_cache_events': 'False', 'write_json': 'True', 'fail_fast': 'False', 'invocation_command': 'dbt run --project-dir dbt_project', 'profiles_dir': '/root/.dbt', 'target_path': 'None', 'cache_selected_only': 'False', 'use_colors': 'True', 'log_format': 'default', 'warn_error': 'None', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'version_check': 'True', 'static_parser': 'True', 'use_experimental_parser': 'False', 'debug': 'False', 'printer_width': '80', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:18:34.814912 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m17:18:34.943943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e8c9357b-7bdc-495b-9dd2-bd5968f99313', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f299c18ae50>]}
[0m17:18:34.997595 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:18:34.999132 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:18:35.006250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e8c9357b-7bdc-495b-9dd2-bd5968f99313', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f299ed5c650>]}
[0m17:18:35.008559 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m17:18:35.030470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd390ddd0-adad-4fae-8cca-74e9b56cf5ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0213de790>]}
[0m17:18:35.089999 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m17:18:35.110726 [debug] [MainThread]: Wrote artifact WritableManifest to dbt_project/target/manifest.json
[0m17:18:35.118571 [debug] [MainThread]: Wrote artifact SemanticManifest to dbt_project/target/semantic_manifest.json
[0m17:18:35.164194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd390ddd0-adad-4fae-8cca-74e9b56cf5ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb020f3f8d0>]}
[0m17:18:35.166072 [info ] [MainThread]: Found 4 models, 434 macros
[0m17:18:35.167685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd390ddd0-adad-4fae-8cca-74e9b56cf5ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0248c5ad0>]}
[0m17:18:35.171823 [info ] [MainThread]: 
[0m17:18:35.173406 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:18:35.174892 [info ] [MainThread]: 
[0m17:18:35.176766 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:18:35.186546 [debug] [ThreadPool]: Acquiring new postgres connection 'list_social_analytics'
[0m17:18:35.272849 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:18:35.274341 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:18:35.304244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e8c9357b-7bdc-495b-9dd2-bd5968f99313', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f299bba97d0>]}
[0m17:18:35.365444 [debug] [ThreadPool]: Using postgres connection "list_social_analytics"
[0m17:18:35.366751 [debug] [ThreadPool]: On list_social_analytics: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "connection_name": "list_social_analytics"} */

    select distinct nspname from pg_namespace
  
[0m17:18:35.367780 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:18:35.380364 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.012 seconds
[0m17:18:35.382510 [debug] [ThreadPool]: On list_social_analytics: Close
[0m17:18:35.384353 [debug] [MainThread]: Wrote artifact WritableManifest to dbt_project/target/manifest.json
[0m17:18:35.385403 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_social_analytics, now list_social_analytics_analytics_analytics)
[0m17:18:35.391519 [debug] [MainThread]: Wrote artifact SemanticManifest to dbt_project/target/semantic_manifest.json
[0m17:18:35.394206 [debug] [ThreadPool]: Using postgres connection "list_social_analytics_analytics_analytics"
[0m17:18:35.395708 [debug] [ThreadPool]: On list_social_analytics_analytics_analytics: BEGIN
[0m17:18:35.396866 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:18:35.406586 [debug] [ThreadPool]: SQL status: BEGIN in 0.010 seconds
[0m17:18:35.408139 [debug] [ThreadPool]: Using postgres connection "list_social_analytics_analytics_analytics"
[0m17:18:35.409308 [debug] [ThreadPool]: On list_social_analytics_analytics_analytics: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "connection_name": "list_social_analytics_analytics_analytics"} */
select
      'social_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'social_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'social_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics'
  
[0m17:18:35.413578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e8c9357b-7bdc-495b-9dd2-bd5968f99313', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f299b39de10>]}
[0m17:18:35.415568 [info ] [MainThread]: Found 4 models, 434 macros
[0m17:18:35.417008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e8c9357b-7bdc-495b-9dd2-bd5968f99313', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f299c121390>]}
[0m17:18:35.418317 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.008 seconds
[0m17:18:35.419996 [info ] [MainThread]: 
[0m17:18:35.421227 [debug] [ThreadPool]: On list_social_analytics_analytics_analytics: ROLLBACK
[0m17:18:35.421752 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:18:35.422662 [debug] [ThreadPool]: On list_social_analytics_analytics_analytics: Close
[0m17:18:35.422932 [info ] [MainThread]: 
[0m17:18:35.424181 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:18:35.429100 [debug] [MainThread]: Using postgres connection "master"
[0m17:18:35.430448 [debug] [MainThread]: On master: BEGIN
[0m17:18:35.431574 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:18:35.431552 [debug] [ThreadPool]: Acquiring new postgres connection 'list_social_analytics'
[0m17:18:35.440191 [debug] [MainThread]: SQL status: BEGIN in 0.009 seconds
[0m17:18:35.441625 [debug] [MainThread]: Using postgres connection "master"
[0m17:18:35.442974 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:18:35.450806 [debug] [MainThread]: SQL status: SELECT 1 in 0.007 seconds
[0m17:18:35.453458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd390ddd0-adad-4fae-8cca-74e9b56cf5ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb02134a910>]}
[0m17:18:35.455221 [debug] [MainThread]: On master: ROLLBACK
[0m17:18:35.457184 [debug] [MainThread]: Using postgres connection "master"
[0m17:18:35.458537 [debug] [MainThread]: On master: BEGIN
[0m17:18:35.460131 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m17:18:35.461174 [debug] [MainThread]: On master: COMMIT
[0m17:18:35.462142 [debug] [MainThread]: Using postgres connection "master"
[0m17:18:35.463347 [debug] [MainThread]: On master: COMMIT
[0m17:18:35.464688 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:18:35.465693 [debug] [MainThread]: On master: Close
[0m17:18:35.472201 [debug] [Thread-1 (]: Began running node model.social_analytics.stg_posts
[0m17:18:35.473809 [info ] [Thread-1 (]: 1 of 4 START sql view model analytics_analytics.stg_posts ...................... [RUN]
[0m17:18:35.475298 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_social_analytics_analytics_analytics, now model.social_analytics.stg_posts)
[0m17:18:35.476679 [debug] [Thread-1 (]: Began compiling node model.social_analytics.stg_posts
[0m17:18:35.480100 [debug] [ThreadPool]: Using postgres connection "list_social_analytics"
[0m17:18:35.481218 [debug] [ThreadPool]: On list_social_analytics: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "connection_name": "list_social_analytics"} */

    select distinct nspname from pg_namespace
  
[0m17:18:35.482403 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:18:35.487104 [debug] [Thread-1 (]: Writing injected SQL for node "model.social_analytics.stg_posts"
[0m17:18:35.490779 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.008 seconds
[0m17:18:35.493548 [debug] [ThreadPool]: On list_social_analytics: Close
[0m17:18:35.498754 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_social_analytics, now list_social_analytics_analytics_analytics)
[0m17:18:35.500142 [debug] [Thread-1 (]: Began executing node model.social_analytics.stg_posts
[0m17:18:35.509781 [debug] [ThreadPool]: Using postgres connection "list_social_analytics_analytics_analytics"
[0m17:18:35.511563 [debug] [ThreadPool]: On list_social_analytics_analytics_analytics: BEGIN
[0m17:18:35.513075 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:18:35.521915 [debug] [ThreadPool]: SQL status: BEGIN in 0.009 seconds
[0m17:18:35.523993 [debug] [ThreadPool]: Using postgres connection "list_social_analytics_analytics_analytics"
[0m17:18:35.525233 [debug] [ThreadPool]: On list_social_analytics_analytics_analytics: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "connection_name": "list_social_analytics_analytics_analytics"} */
select
      'social_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'social_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'social_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics'
  
[0m17:18:35.530882 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.004 seconds
[0m17:18:35.534243 [debug] [ThreadPool]: On list_social_analytics_analytics_analytics: ROLLBACK
[0m17:18:35.536135 [debug] [ThreadPool]: On list_social_analytics_analytics_analytics: Close
[0m17:18:35.544204 [debug] [MainThread]: Using postgres connection "master"
[0m17:18:35.545799 [debug] [MainThread]: On master: BEGIN
[0m17:18:35.547096 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:18:35.549373 [debug] [Thread-1 (]: Writing runtime sql for node "model.social_analytics.stg_posts"
[0m17:18:35.559132 [debug] [MainThread]: SQL status: BEGIN in 0.012 seconds
[0m17:18:35.560677 [debug] [MainThread]: Using postgres connection "master"
[0m17:18:35.560923 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.stg_posts"
[0m17:18:35.562480 [debug] [Thread-1 (]: On model.social_analytics.stg_posts: BEGIN
[0m17:18:35.562494 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:18:35.564085 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:18:35.569885 [debug] [MainThread]: SQL status: SELECT 1 in 0.006 seconds
[0m17:18:35.572849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e8c9357b-7bdc-495b-9dd2-bd5968f99313', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f299a3d3f90>]}
[0m17:18:35.574779 [debug] [Thread-1 (]: SQL status: BEGIN in 0.011 seconds
[0m17:18:35.574733 [debug] [MainThread]: On master: ROLLBACK
[0m17:18:35.576634 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.stg_posts"
[0m17:18:35.576926 [debug] [MainThread]: Using postgres connection "master"
[0m17:18:35.578065 [debug] [MainThread]: On master: BEGIN
[0m17:18:35.578078 [debug] [Thread-1 (]: On model.social_analytics.stg_posts: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.stg_posts"} */

  create view "social_analytics"."analytics_analytics"."stg_posts__dbt_tmp"
    
    
  as (
    

select
    id,
    platform,
    platform_post_id,
    author_name,
    content_text,
    content_url,
    coalesce(like_count, 0) as like_count,
    coalesce(comment_count, 0) as comment_count,
    coalesce(share_count, 0) as share_count,
    posted_at_utc,
    collected_at_utc
from public.posts
  );
[0m17:18:35.580038 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m17:18:35.582137 [debug] [MainThread]: On master: COMMIT
[0m17:18:35.584089 [debug] [MainThread]: Using postgres connection "master"
[0m17:18:35.585469 [debug] [MainThread]: On master: COMMIT
[0m17:18:35.587597 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:18:35.587412 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.008 seconds
[0m17:18:35.589158 [debug] [MainThread]: On master: Close
[0m17:18:35.597331 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.stg_posts"
[0m17:18:35.597393 [debug] [Thread-1 (]: Began running node model.social_analytics.stg_posts
[0m17:18:35.599245 [debug] [Thread-1 (]: On model.social_analytics.stg_posts: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.stg_posts"} */
alter table "social_analytics"."analytics_analytics"."stg_posts" rename to "stg_posts__dbt_backup"
[0m17:18:35.599443 [info ] [Thread-1 (]: 1 of 4 START sql view model analytics_analytics.stg_posts ...................... [RUN]
[0m17:18:35.600882 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_social_analytics_analytics_analytics, now model.social_analytics.stg_posts)
[0m17:18:35.601935 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:18:35.602490 [debug] [Thread-1 (]: Began compiling node model.social_analytics.stg_posts
[0m17:18:35.607994 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.stg_posts"
[0m17:18:35.610001 [debug] [Thread-1 (]: On model.social_analytics.stg_posts: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.stg_posts"} */
alter table "social_analytics"."analytics_analytics"."stg_posts__dbt_tmp" rename to "stg_posts"
[0m17:18:35.612280 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:18:35.615588 [debug] [Thread-1 (]: Writing injected SQL for node "model.social_analytics.stg_posts"
[0m17:18:35.628651 [debug] [Thread-1 (]: Began executing node model.social_analytics.stg_posts
[0m17:18:35.635609 [debug] [Thread-1 (]: On model.social_analytics.stg_posts: COMMIT
[0m17:18:35.637708 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.stg_posts"
[0m17:18:35.639252 [debug] [Thread-1 (]: On model.social_analytics.stg_posts: COMMIT
[0m17:18:35.642808 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m17:18:35.652013 [debug] [Thread-1 (]: Applying DROP to: "social_analytics"."analytics_analytics"."stg_posts__dbt_backup"
[0m17:18:35.659253 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.stg_posts"
[0m17:18:35.660861 [debug] [Thread-1 (]: On model.social_analytics.stg_posts: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.stg_posts"} */
drop view if exists "social_analytics"."analytics_analytics"."stg_posts__dbt_backup" cascade
[0m17:18:35.664608 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.002 seconds
[0m17:18:35.668591 [debug] [Thread-1 (]: On model.social_analytics.stg_posts: Close
[0m17:18:35.671053 [debug] [Thread-1 (]: Writing runtime sql for node "model.social_analytics.stg_posts"
[0m17:18:35.671562 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd390ddd0-adad-4fae-8cca-74e9b56cf5ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb021b41e50>]}
[0m17:18:35.673118 [info ] [Thread-1 (]: 1 of 4 OK created sql view model analytics_analytics.stg_posts ................. [[32mCREATE VIEW[0m in 0.20s]
[0m17:18:35.674778 [debug] [Thread-1 (]: Finished running node model.social_analytics.stg_posts
[0m17:18:35.676653 [debug] [Thread-1 (]: Began running node model.social_analytics.fct_daily_metrics
[0m17:18:35.677881 [info ] [Thread-1 (]: 2 of 4 START sql table model analytics_analytics.fct_daily_metrics ............. [RUN]
[0m17:18:35.679434 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.social_analytics.stg_posts, now model.social_analytics.fct_daily_metrics)
[0m17:18:35.680873 [debug] [Thread-1 (]: Began compiling node model.social_analytics.fct_daily_metrics
[0m17:18:35.681499 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.stg_posts"
[0m17:18:35.682808 [debug] [Thread-1 (]: On model.social_analytics.stg_posts: BEGIN
[0m17:18:35.684432 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:18:35.687607 [debug] [Thread-1 (]: Writing injected SQL for node "model.social_analytics.fct_daily_metrics"
[0m17:18:35.697133 [debug] [Thread-1 (]: SQL status: BEGIN in 0.013 seconds
[0m17:18:35.698415 [debug] [Thread-1 (]: Began executing node model.social_analytics.fct_daily_metrics
[0m17:18:35.698645 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.stg_posts"
[0m17:18:35.700588 [debug] [Thread-1 (]: On model.social_analytics.stg_posts: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.stg_posts"} */

  create view "social_analytics"."analytics_analytics"."stg_posts__dbt_tmp"
    
    
  as (
    

select
    id,
    platform,
    platform_post_id,
    author_name,
    content_text,
    content_url,
    coalesce(like_count, 0) as like_count,
    coalesce(comment_count, 0) as comment_count,
    coalesce(share_count, 0) as share_count,
    posted_at_utc,
    collected_at_utc
from public.posts
  );
[0m17:18:35.705670 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.003 seconds
[0m17:18:35.714963 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.stg_posts"
[0m17:18:35.717054 [debug] [Thread-1 (]: On model.social_analytics.stg_posts: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.stg_posts"} */
alter table "social_analytics"."analytics_analytics"."stg_posts" rename to "stg_posts__dbt_backup"
[0m17:18:35.719461 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:18:35.724051 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.stg_posts"
[0m17:18:35.725588 [debug] [Thread-1 (]: On model.social_analytics.stg_posts: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.stg_posts"} */
alter table "social_analytics"."analytics_analytics"."stg_posts__dbt_tmp" rename to "stg_posts"
[0m17:18:35.727371 [debug] [Thread-1 (]: Writing runtime sql for node "model.social_analytics.fct_daily_metrics"
[0m17:18:35.727469 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:18:35.737921 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.fct_daily_metrics"
[0m17:18:35.739357 [debug] [Thread-1 (]: On model.social_analytics.fct_daily_metrics: BEGIN
[0m17:18:35.740916 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:18:35.747355 [debug] [Thread-1 (]: On model.social_analytics.stg_posts: COMMIT
[0m17:18:35.748976 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.stg_posts"
[0m17:18:35.750274 [debug] [Thread-1 (]: On model.social_analytics.stg_posts: COMMIT
[0m17:18:35.753351 [debug] [Thread-1 (]: SQL status: BEGIN in 0.012 seconds
[0m17:18:35.754174 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m17:18:35.754715 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.fct_daily_metrics"
[0m17:18:35.755843 [debug] [Thread-1 (]: On model.social_analytics.fct_daily_metrics: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.fct_daily_metrics"} */

  
    

  create  table "social_analytics"."analytics_analytics"."fct_daily_metrics__dbt_tmp"
  
  
    as
  
  (
    

select
    platform,
    date_trunc('day', posted_at_utc) as post_date,
    count(*) as total_posts,
    sum(like_count) as total_likes,
    sum(comment_count) as total_comments,
    sum(share_count) as total_shares,
    sum(like_count + comment_count + share_count) as engagement_score
from "social_analytics"."analytics_analytics"."stg_posts"
group by platform, date_trunc('day', posted_at_utc)
  );
  
[0m17:18:35.762034 [debug] [Thread-1 (]: Applying DROP to: "social_analytics"."analytics_analytics"."stg_posts__dbt_backup"
[0m17:18:35.768499 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.011 seconds
[0m17:18:35.769138 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.stg_posts"
[0m17:18:35.770386 [debug] [Thread-1 (]: On model.social_analytics.stg_posts: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.stg_posts"} */
drop view if exists "social_analytics"."analytics_analytics"."stg_posts__dbt_backup" cascade
[0m17:18:35.774317 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m17:18:35.778273 [debug] [Thread-1 (]: On model.social_analytics.stg_posts: Close
[0m17:18:35.778655 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.fct_daily_metrics"
[0m17:18:35.779928 [debug] [Thread-1 (]: On model.social_analytics.fct_daily_metrics: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.fct_daily_metrics"} */
alter table "social_analytics"."analytics_analytics"."fct_daily_metrics" rename to "fct_daily_metrics__dbt_backup"
[0m17:18:35.781317 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8c9357b-7bdc-495b-9dd2-bd5968f99313', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2999fabc10>]}
[0m17:18:35.781937 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:18:35.783291 [info ] [Thread-1 (]: 1 of 4 OK created sql view model analytics_analytics.stg_posts ................. [[32mCREATE VIEW[0m in 0.18s]
[0m17:18:35.785049 [debug] [Thread-1 (]: Finished running node model.social_analytics.stg_posts
[0m17:18:35.787176 [debug] [Thread-1 (]: Began running node model.social_analytics.fct_daily_metrics
[0m17:18:35.788913 [info ] [Thread-1 (]: 2 of 4 START sql table model analytics_analytics.fct_daily_metrics ............. [RUN]
[0m17:18:35.790586 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.social_analytics.stg_posts, now model.social_analytics.fct_daily_metrics)
[0m17:18:35.792015 [debug] [Thread-1 (]: Began compiling node model.social_analytics.fct_daily_metrics
[0m17:18:35.797371 [debug] [Thread-1 (]: Writing injected SQL for node "model.social_analytics.fct_daily_metrics"
[0m17:18:35.808878 [debug] [Thread-1 (]: Began executing node model.social_analytics.fct_daily_metrics
[0m17:18:35.836028 [debug] [Thread-1 (]: Writing runtime sql for node "model.social_analytics.fct_daily_metrics"
[0m17:18:35.845886 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.fct_daily_metrics"
[0m17:18:35.847124 [debug] [Thread-1 (]: On model.social_analytics.fct_daily_metrics: BEGIN
[0m17:18:35.848268 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:18:35.853983 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.fct_daily_metrics"
[0m17:18:35.855264 [debug] [Thread-1 (]: On model.social_analytics.fct_daily_metrics: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.fct_daily_metrics"} */
alter table "social_analytics"."analytics_analytics"."fct_daily_metrics__dbt_tmp" rename to "fct_daily_metrics"
[0m17:18:35.856382 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m17:18:35.857101 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:18:35.857542 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.fct_daily_metrics"
[0m17:18:35.858504 [debug] [Thread-1 (]: On model.social_analytics.fct_daily_metrics: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.fct_daily_metrics"} */

  
    

  create  table "social_analytics"."analytics_analytics"."fct_daily_metrics__dbt_tmp"
  
  
    as
  
  (
    

select
    platform,
    date_trunc('day', posted_at_utc) as post_date,
    count(*) as total_posts,
    sum(like_count) as total_likes,
    sum(comment_count) as total_comments,
    sum(share_count) as total_shares,
    sum(like_count + comment_count + share_count) as engagement_score
from "social_analytics"."analytics_analytics"."stg_posts"
group by platform, date_trunc('day', posted_at_utc)
  );
  
[0m17:18:35.859804 [debug] [Thread-1 (]: On model.social_analytics.fct_daily_metrics: COMMIT
[0m17:18:35.861003 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.fct_daily_metrics"
[0m17:18:35.861950 [debug] [Thread-1 (]: On model.social_analytics.fct_daily_metrics: COMMIT
[0m17:18:35.865011 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m17:18:35.868462 [debug] [Thread-1 (]: Applying DROP to: "social_analytics"."analytics_analytics"."fct_daily_metrics__dbt_backup"
[0m17:18:35.870828 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.011 seconds
[0m17:18:35.872382 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.fct_daily_metrics"
[0m17:18:35.873550 [debug] [Thread-1 (]: On model.social_analytics.fct_daily_metrics: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.fct_daily_metrics"} */
drop table if exists "social_analytics"."analytics_analytics"."fct_daily_metrics__dbt_backup" cascade
[0m17:18:35.878699 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m17:18:35.880340 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.fct_daily_metrics"
[0m17:18:35.881461 [debug] [Thread-1 (]: On model.social_analytics.fct_daily_metrics: Close
[0m17:18:35.881786 [debug] [Thread-1 (]: On model.social_analytics.fct_daily_metrics: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.fct_daily_metrics"} */
alter table "social_analytics"."analytics_analytics"."fct_daily_metrics" rename to "fct_daily_metrics__dbt_backup"
[0m17:18:35.883138 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd390ddd0-adad-4fae-8cca-74e9b56cf5ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb022b11810>]}
[0m17:18:35.883623 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:18:35.884601 [info ] [Thread-1 (]: 2 of 4 OK created sql table model analytics_analytics.fct_daily_metrics ........ [[32mSELECT 8[0m in 0.20s]
[0m17:18:35.886372 [debug] [Thread-1 (]: Finished running node model.social_analytics.fct_daily_metrics
[0m17:18:35.887730 [debug] [Thread-1 (]: Began running node model.social_analytics.moving_avg
[0m17:18:35.889184 [info ] [Thread-1 (]: 3 of 4 START sql table model analytics_analytics.moving_avg .................... [RUN]
[0m17:18:35.890859 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.social_analytics.fct_daily_metrics, now model.social_analytics.moving_avg)
[0m17:18:35.892356 [debug] [Thread-1 (]: Began compiling node model.social_analytics.moving_avg
[0m17:18:35.897354 [debug] [Thread-1 (]: Writing injected SQL for node "model.social_analytics.moving_avg"
[0m17:18:35.908640 [debug] [Thread-1 (]: Began executing node model.social_analytics.moving_avg
[0m17:18:35.915022 [debug] [Thread-1 (]: Writing runtime sql for node "model.social_analytics.moving_avg"
[0m17:18:35.927098 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.moving_avg"
[0m17:18:35.929199 [debug] [Thread-1 (]: On model.social_analytics.moving_avg: BEGIN
[0m17:18:35.931167 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:18:35.939662 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m17:18:35.941470 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.moving_avg"
[0m17:18:35.942792 [debug] [Thread-1 (]: On model.social_analytics.moving_avg: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.moving_avg"} */

  
    

  create  table "social_analytics"."analytics_analytics"."moving_avg__dbt_tmp"
  
  
    as
  
  (
    


with base as (
    select
        platform,
        date_trunc('day', posted_at_utc) as post_date,
        (like_count + comment_count + share_count) as engagement
    from "social_analytics"."analytics_analytics"."stg_posts"
),

daily as (
    select
        platform,
        post_date,
        sum(engagement) as daily_engagement
    from base
    group by platform, post_date
)

select
    platform,
    post_date,
    daily_engagement,
    avg(daily_engagement) over (
        partition by platform
        order by post_date
        rows between 6 preceding and current row
    ) as engagement_7d_moving_avg
from daily
order by platform, post_date
  );
  
[0m17:18:35.955509 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.011 seconds
[0m17:18:35.960677 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.moving_avg"
[0m17:18:35.962147 [debug] [Thread-1 (]: On model.social_analytics.moving_avg: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.moving_avg"} */
alter table "social_analytics"."analytics_analytics"."moving_avg__dbt_tmp" rename to "moving_avg"
[0m17:18:35.963836 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:18:35.964625 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.fct_daily_metrics"
[0m17:18:35.965881 [debug] [Thread-1 (]: On model.social_analytics.fct_daily_metrics: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.fct_daily_metrics"} */
alter table "social_analytics"."analytics_analytics"."fct_daily_metrics__dbt_tmp" rename to "fct_daily_metrics"
[0m17:18:35.966020 [debug] [Thread-1 (]: On model.social_analytics.moving_avg: COMMIT
[0m17:18:35.967187 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.moving_avg"
[0m17:18:35.967366 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:18:35.968342 [debug] [Thread-1 (]: On model.social_analytics.moving_avg: COMMIT
[0m17:18:35.969503 [debug] [Thread-1 (]: On model.social_analytics.fct_daily_metrics: COMMIT
[0m17:18:35.970827 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.fct_daily_metrics"
[0m17:18:35.971873 [debug] [Thread-1 (]: On model.social_analytics.fct_daily_metrics: COMMIT
[0m17:18:35.972247 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m17:18:35.974691 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m17:18:35.975632 [debug] [Thread-1 (]: Applying DROP to: "social_analytics"."analytics_analytics"."moving_avg__dbt_backup"
[0m17:18:35.977089 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.moving_avg"
[0m17:18:35.978179 [debug] [Thread-1 (]: On model.social_analytics.moving_avg: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.moving_avg"} */
drop table if exists "social_analytics"."analytics_analytics"."moving_avg__dbt_backup" cascade
[0m17:18:35.978490 [debug] [Thread-1 (]: Applying DROP to: "social_analytics"."analytics_analytics"."fct_daily_metrics__dbt_backup"
[0m17:18:35.979833 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.001 seconds
[0m17:18:35.981984 [debug] [Thread-1 (]: On model.social_analytics.moving_avg: Close
[0m17:18:35.982291 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.fct_daily_metrics"
[0m17:18:35.983731 [debug] [Thread-1 (]: On model.social_analytics.fct_daily_metrics: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.fct_daily_metrics"} */
drop table if exists "social_analytics"."analytics_analytics"."fct_daily_metrics__dbt_backup" cascade
[0m17:18:35.983957 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd390ddd0-adad-4fae-8cca-74e9b56cf5ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb01dd0b990>]}
[0m17:18:35.985505 [info ] [Thread-1 (]: 3 of 4 OK created sql table model analytics_analytics.moving_avg ............... [[32mSELECT 8[0m in 0.09s]
[0m17:18:35.987107 [debug] [Thread-1 (]: Finished running node model.social_analytics.moving_avg
[0m17:18:35.988002 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m17:18:35.988560 [debug] [Thread-1 (]: Began running node model.social_analytics.top_posts
[0m17:18:35.989893 [info ] [Thread-1 (]: 4 of 4 START sql table model analytics_analytics.top_posts ..................... [RUN]
[0m17:18:35.990371 [debug] [Thread-1 (]: On model.social_analytics.fct_daily_metrics: Close
[0m17:18:35.992045 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8c9357b-7bdc-495b-9dd2-bd5968f99313', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f299b3bc490>]}
[0m17:18:35.991246 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.social_analytics.moving_avg, now model.social_analytics.top_posts)
[0m17:18:35.994629 [debug] [Thread-1 (]: Began compiling node model.social_analytics.top_posts
[0m17:18:35.994826 [info ] [Thread-1 (]: 2 of 4 OK created sql table model analytics_analytics.fct_daily_metrics ........ [[32mSELECT 8[0m in 0.20s]
[0m17:18:35.996074 [debug] [Thread-1 (]: Finished running node model.social_analytics.fct_daily_metrics
[0m17:18:35.997256 [debug] [Thread-1 (]: Began running node model.social_analytics.moving_avg
[0m17:18:35.998766 [info ] [Thread-1 (]: 3 of 4 START sql table model analytics_analytics.moving_avg .................... [RUN]
[0m17:18:35.999321 [debug] [Thread-1 (]: Writing injected SQL for node "model.social_analytics.top_posts"
[0m17:18:36.000707 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.social_analytics.fct_daily_metrics, now model.social_analytics.moving_avg)
[0m17:18:36.002101 [debug] [Thread-1 (]: Began compiling node model.social_analytics.moving_avg
[0m17:18:36.007805 [debug] [Thread-1 (]: Writing injected SQL for node "model.social_analytics.moving_avg"
[0m17:18:36.009227 [debug] [Thread-1 (]: Began executing node model.social_analytics.top_posts
[0m17:18:36.014296 [debug] [Thread-1 (]: Writing runtime sql for node "model.social_analytics.top_posts"
[0m17:18:36.017803 [debug] [Thread-1 (]: Began executing node model.social_analytics.moving_avg
[0m17:18:36.023544 [debug] [Thread-1 (]: Writing runtime sql for node "model.social_analytics.moving_avg"
[0m17:18:36.023918 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.top_posts"
[0m17:18:36.025170 [debug] [Thread-1 (]: On model.social_analytics.top_posts: BEGIN
[0m17:18:36.026262 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:18:36.033021 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.moving_avg"
[0m17:18:36.033962 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m17:18:36.034505 [debug] [Thread-1 (]: On model.social_analytics.moving_avg: BEGIN
[0m17:18:36.035186 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.top_posts"
[0m17:18:36.035511 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:18:36.036173 [debug] [Thread-1 (]: On model.social_analytics.top_posts: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.top_posts"} */

  
    

  create  table "social_analytics"."analytics_analytics"."top_posts__dbt_tmp"
  
  
    as
  
  (
    

with ranked as (
    select
        id,
        platform,
        author_name,
        content_text,
        content_url,
        (like_count + comment_count + share_count) as engagement_score,
        row_number() over (order by (like_count + comment_count + share_count) desc) as overall_rank,
        row_number() over (partition by platform order by (like_count + comment_count + share_count) desc) as platform_rank
    from "social_analytics"."analytics_analytics"."stg_posts"
)
select *
from ranked
where overall_rank <= 5
   or platform_rank <= 3
  );
  
[0m17:18:36.042607 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m17:18:36.043768 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.moving_avg"
[0m17:18:36.044709 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.007 seconds
[0m17:18:36.044899 [debug] [Thread-1 (]: On model.social_analytics.moving_avg: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.moving_avg"} */

  
    

  create  table "social_analytics"."analytics_analytics"."moving_avg__dbt_tmp"
  
  
    as
  
  (
    


with base as (
    select
        platform,
        date_trunc('day', posted_at_utc) as post_date,
        (like_count + comment_count + share_count) as engagement
    from "social_analytics"."analytics_analytics"."stg_posts"
),

daily as (
    select
        platform,
        post_date,
        sum(engagement) as daily_engagement
    from base
    group by platform, post_date
)

select
    platform,
    post_date,
    daily_engagement,
    avg(daily_engagement) over (
        partition by platform
        order by post_date
        rows between 6 preceding and current row
    ) as engagement_7d_moving_avg
from daily
order by platform, post_date
  );
  
[0m17:18:36.049133 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.top_posts"
[0m17:18:36.050308 [debug] [Thread-1 (]: On model.social_analytics.top_posts: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.top_posts"} */
alter table "social_analytics"."analytics_analytics"."top_posts" rename to "top_posts__dbt_backup"
[0m17:18:36.051594 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:18:36.053389 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.007 seconds
[0m17:18:36.055063 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.top_posts"
[0m17:18:36.056100 [debug] [Thread-1 (]: On model.social_analytics.top_posts: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.top_posts"} */
alter table "social_analytics"."analytics_analytics"."top_posts__dbt_tmp" rename to "top_posts"
[0m17:18:36.057689 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.moving_avg"
[0m17:18:36.057597 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:18:36.058974 [debug] [Thread-1 (]: On model.social_analytics.moving_avg: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.moving_avg"} */
alter table "social_analytics"."analytics_analytics"."moving_avg__dbt_tmp" rename to "moving_avg"
[0m17:18:36.060283 [debug] [Thread-1 (]: On model.social_analytics.top_posts: COMMIT
[0m17:18:36.061458 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.top_posts"
[0m17:18:36.061203 [debug] [Thread-1 (]: Postgres adapter: Postgres error: relation "moving_avg" already exists

[0m17:18:36.062460 [debug] [Thread-1 (]: On model.social_analytics.moving_avg: ROLLBACK
[0m17:18:36.062442 [debug] [Thread-1 (]: On model.social_analytics.top_posts: COMMIT
[0m17:18:36.063690 [debug] [Thread-1 (]: Postgres adapter: Error running SQL: macro rename_relation
[0m17:18:36.064606 [debug] [Thread-1 (]: Postgres adapter: Rolling back transaction.
[0m17:18:36.065548 [debug] [Thread-1 (]: On model.social_analytics.moving_avg: Close
[0m17:18:36.065792 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m17:18:36.072308 [debug] [Thread-1 (]: Applying DROP to: "social_analytics"."analytics_analytics"."top_posts__dbt_backup"
[0m17:18:36.073833 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.top_posts"
[0m17:18:36.074412 [debug] [Thread-1 (]: Database Error in model moving_avg (models/moving_avg.sql)
  relation "moving_avg" already exists
  compiled code at target/run/social_analytics/models/moving_avg.sql
[0m17:18:36.074785 [debug] [Thread-1 (]: On model.social_analytics.top_posts: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.top_posts"} */
drop table if exists "social_analytics"."analytics_analytics"."top_posts__dbt_backup" cascade
[0m17:18:36.075575 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8c9357b-7bdc-495b-9dd2-bd5968f99313', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29993c2890>]}
[0m17:18:36.077071 [error] [Thread-1 (]: 3 of 4 ERROR creating sql table model analytics_analytics.moving_avg ........... [[31mERROR[0m in 0.08s]
[0m17:18:36.078369 [debug] [Thread-1 (]: Finished running node model.social_analytics.moving_avg
[0m17:18:36.079337 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m17:18:36.079368 [debug] [Thread-1 (]: Began running node model.social_analytics.top_posts
[0m17:18:36.079801 [debug] [Thread-4 (]: Marking all children of 'model.social_analytics.moving_avg' to be skipped because of status 'error'.  Reason: Database Error in model moving_avg (models/moving_avg.sql)
  relation "moving_avg" already exists
  compiled code at target/run/social_analytics/models/moving_avg.sql.
[0m17:18:36.081496 [debug] [Thread-1 (]: On model.social_analytics.top_posts: Close
[0m17:18:36.080738 [info ] [Thread-1 (]: 4 of 4 START sql table model analytics_analytics.top_posts ..................... [RUN]
[0m17:18:36.083138 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd390ddd0-adad-4fae-8cca-74e9b56cf5ab', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb01f6b6d90>]}
[0m17:18:36.083339 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.social_analytics.moving_avg, now model.social_analytics.top_posts)
[0m17:18:36.084374 [debug] [Thread-1 (]: Began compiling node model.social_analytics.top_posts
[0m17:18:36.084626 [info ] [Thread-1 (]: 4 of 4 OK created sql table model analytics_analytics.top_posts ................ [[32mSELECT 8[0m in 0.09s]
[0m17:18:36.085974 [debug] [Thread-1 (]: Finished running node model.social_analytics.top_posts
[0m17:18:36.088180 [debug] [MainThread]: Using postgres connection "master"
[0m17:18:36.088689 [debug] [Thread-1 (]: Writing injected SQL for node "model.social_analytics.top_posts"
[0m17:18:36.089303 [debug] [MainThread]: On master: BEGIN
[0m17:18:36.090257 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:18:36.097425 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m17:18:36.097770 [debug] [Thread-1 (]: Began executing node model.social_analytics.top_posts
[0m17:18:36.098672 [debug] [MainThread]: On master: COMMIT
[0m17:18:36.099665 [debug] [MainThread]: Using postgres connection "master"
[0m17:18:36.100647 [debug] [MainThread]: On master: COMMIT
[0m17:18:36.101834 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:18:36.102360 [debug] [Thread-1 (]: Writing runtime sql for node "model.social_analytics.top_posts"
[0m17:18:36.102943 [debug] [MainThread]: On master: Close
[0m17:18:36.104126 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:18:36.105302 [debug] [MainThread]: Connection 'model.social_analytics.top_posts' was properly closed.
[0m17:18:36.106538 [info ] [MainThread]: 
[0m17:18:36.108055 [info ] [MainThread]: Finished running 3 table models, 1 view model in 0 hours 0 minutes and 0.93 seconds (0.93s).
[0m17:18:36.110263 [debug] [MainThread]: Command end result
[0m17:18:36.111888 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.top_posts"
[0m17:18:36.113468 [debug] [Thread-1 (]: On model.social_analytics.top_posts: BEGIN
[0m17:18:36.114832 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:18:36.121227 [debug] [Thread-1 (]: SQL status: BEGIN in 0.006 seconds
[0m17:18:36.122637 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.top_posts"
[0m17:18:36.124233 [debug] [Thread-1 (]: On model.social_analytics.top_posts: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.top_posts"} */

  
    

  create  table "social_analytics"."analytics_analytics"."top_posts__dbt_tmp"
  
  
    as
  
  (
    

with ranked as (
    select
        id,
        platform,
        author_name,
        content_text,
        content_url,
        (like_count + comment_count + share_count) as engagement_score,
        row_number() over (order by (like_count + comment_count + share_count) desc) as overall_rank,
        row_number() over (partition by platform order by (like_count + comment_count + share_count) desc) as platform_rank
    from "social_analytics"."analytics_analytics"."stg_posts"
)
select *
from ranked
where overall_rank <= 5
   or platform_rank <= 3
  );
  
[0m17:18:36.135060 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.009 seconds
[0m17:18:36.140096 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.top_posts"
[0m17:18:36.141645 [debug] [Thread-1 (]: On model.social_analytics.top_posts: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.top_posts"} */
alter table "social_analytics"."analytics_analytics"."top_posts" rename to "top_posts__dbt_backup"
[0m17:18:36.143122 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:18:36.147966 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.top_posts"
[0m17:18:36.148870 [debug] [MainThread]: Wrote artifact WritableManifest to dbt_project/target/manifest.json
[0m17:18:36.149228 [debug] [Thread-1 (]: On model.social_analytics.top_posts: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.top_posts"} */
alter table "social_analytics"."analytics_analytics"."top_posts__dbt_tmp" rename to "top_posts"
[0m17:18:36.151046 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:18:36.153707 [debug] [Thread-1 (]: On model.social_analytics.top_posts: COMMIT
[0m17:18:36.154979 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.top_posts"
[0m17:18:36.155505 [debug] [MainThread]: Wrote artifact SemanticManifest to dbt_project/target/semantic_manifest.json
[0m17:18:36.156306 [debug] [Thread-1 (]: On model.social_analytics.top_posts: COMMIT
[0m17:18:36.159849 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m17:18:36.164165 [debug] [Thread-1 (]: Applying DROP to: "social_analytics"."analytics_analytics"."top_posts__dbt_backup"
[0m17:18:36.165749 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.top_posts"
[0m17:18:36.166989 [debug] [MainThread]: Wrote artifact RunExecutionResult to dbt_project/target/run_results.json
[0m17:18:36.167058 [debug] [Thread-1 (]: On model.social_analytics.top_posts: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.top_posts"} */
drop table if exists "social_analytics"."analytics_analytics"."top_posts__dbt_backup" cascade
[0m17:18:36.168385 [info ] [MainThread]: 
[0m17:18:36.169894 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:18:36.171571 [info ] [MainThread]: 
[0m17:18:36.172986 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m17:18:36.173093 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m17:18:36.175906 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.815795, "process_in_blocks": "0", "process_kernel_time": 0.878323, "process_mem_max_rss": "124320", "process_out_blocks": "0", "process_user_time": 2.433056}
[0m17:18:36.175865 [debug] [Thread-1 (]: On model.social_analytics.top_posts: Close
[0m17:18:36.177852 [debug] [MainThread]: Command `dbt run` succeeded at 17:18:36.177644 after 1.82 seconds
[0m17:18:36.178171 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e8c9357b-7bdc-495b-9dd2-bd5968f99313', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2999f35890>]}
[0m17:18:36.179512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb026d15950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb026d14ed0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb021bf0150>]}
[0m17:18:36.180336 [info ] [Thread-1 (]: 4 of 4 OK created sql table model analytics_analytics.top_posts ................ [[32mSELECT 8[0m in 0.09s]
[0m17:18:36.181058 [debug] [MainThread]: Flushing usage events
[0m17:18:36.182207 [debug] [Thread-1 (]: Finished running node model.social_analytics.top_posts
[0m17:18:36.185991 [debug] [MainThread]: Using postgres connection "master"
[0m17:18:36.188193 [debug] [MainThread]: On master: BEGIN
[0m17:18:36.189891 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:18:36.198180 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m17:18:36.199693 [debug] [MainThread]: On master: COMMIT
[0m17:18:36.200765 [debug] [MainThread]: Using postgres connection "master"
[0m17:18:36.202276 [debug] [MainThread]: On master: COMMIT
[0m17:18:36.204161 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:18:36.205868 [debug] [MainThread]: On master: Close
[0m17:18:36.207765 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:18:36.209416 [debug] [MainThread]: Connection 'model.social_analytics.top_posts' was properly closed.
[0m17:18:36.211216 [info ] [MainThread]: 
[0m17:18:36.212707 [info ] [MainThread]: Finished running 3 table models, 1 view model in 0 hours 0 minutes and 0.79 seconds (0.79s).
[0m17:18:36.214579 [debug] [MainThread]: Command end result
[0m17:18:36.256163 [debug] [MainThread]: Wrote artifact WritableManifest to dbt_project/target/manifest.json
[0m17:18:36.263085 [debug] [MainThread]: Wrote artifact SemanticManifest to dbt_project/target/semantic_manifest.json
[0m17:18:36.274745 [debug] [MainThread]: Wrote artifact RunExecutionResult to dbt_project/target/run_results.json
[0m17:18:36.276063 [info ] [MainThread]: 
[0m17:18:36.277277 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m17:18:36.278501 [info ] [MainThread]: 
[0m17:18:36.279860 [error] [MainThread]: [31mFailure in model moving_avg (models/moving_avg.sql)[0m
[0m17:18:36.281059 [error] [MainThread]:   Database Error in model moving_avg (models/moving_avg.sql)
  relation "moving_avg" already exists
  compiled code at target/run/social_analytics/models/moving_avg.sql
[0m17:18:36.282296 [info ] [MainThread]: 
[0m17:18:36.283597 [info ] [MainThread]:   compiled code at target/compiled/social_analytics/models/moving_avg.sql
[0m17:18:36.284788 [info ] [MainThread]: 
[0m17:18:36.285947 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=4
[0m17:18:36.287947 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.5882713, "process_in_blocks": "0", "process_kernel_time": 0.364032, "process_mem_max_rss": "124424", "process_out_blocks": "0", "process_user_time": 2.223549}
[0m17:18:36.289081 [debug] [MainThread]: Command `dbt run` failed at 17:18:36.288970 after 1.59 seconds
[0m17:18:36.290169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f299ed2aa50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2999f7f6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29a09c1d10>]}
[0m17:18:36.291148 [debug] [MainThread]: Flushing usage events
[0m17:18:37.137239 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:18:37.137099 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:19:32.747906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff951812f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9526b8590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff953576810>]}


============================== 17:19:32.751775 | 41829da2-6e13-414d-b06b-9f26c83b1960 ==============================
[0m17:19:32.751775 [info ] [MainThread]: Running with dbt=1.10.9
[0m17:19:32.753140 [debug] [MainThread]: running dbt with arguments {'cache_selected_only': 'False', 'version_check': 'True', 'introspect': 'True', 'target_path': 'None', 'log_cache_events': 'False', 'indirect_selection': 'eager', 'invocation_command': 'dbt run --project-dir dbt_project', 'log_path': 'dbt_project/logs', 'printer_width': '80', 'send_anonymous_usage_stats': 'True', 'warn_error': 'None', 'static_parser': 'True', 'write_json': 'True', 'empty': 'False', 'log_format': 'default', 'profiles_dir': '/root/.dbt', 'no_print': 'None', 'quiet': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'debug': 'False', 'fail_fast': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True'}
[0m17:19:32.926800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '41829da2-6e13-414d-b06b-9f26c83b1960', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff951879a50>]}
[0m17:19:32.988230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '41829da2-6e13-414d-b06b-9f26c83b1960', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff954440290>]}
[0m17:19:32.991847 [info ] [MainThread]: Registered adapter: postgres=1.9.0
[0m17:19:33.077370 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m17:19:33.241318 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:19:33.242773 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:19:33.271108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '41829da2-6e13-414d-b06b-9f26c83b1960', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9507db750>]}
[0m17:19:33.345778 [debug] [MainThread]: Wrote artifact WritableManifest to dbt_project/target/manifest.json
[0m17:19:33.353104 [debug] [MainThread]: Wrote artifact SemanticManifest to dbt_project/target/semantic_manifest.json
[0m17:19:33.381107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '41829da2-6e13-414d-b06b-9f26c83b1960', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9507be450>]}
[0m17:19:33.382636 [info ] [MainThread]: Found 4 models, 434 macros
[0m17:19:33.383901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '41829da2-6e13-414d-b06b-9f26c83b1960', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff953c650d0>]}
[0m17:19:33.386544 [info ] [MainThread]: 
[0m17:19:33.387904 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:19:33.388921 [info ] [MainThread]: 
[0m17:19:33.390145 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m17:19:33.396447 [debug] [ThreadPool]: Acquiring new postgres connection 'list_social_analytics'
[0m17:19:33.509369 [debug] [ThreadPool]: Using postgres connection "list_social_analytics"
[0m17:19:33.511050 [debug] [ThreadPool]: On list_social_analytics: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "connection_name": "list_social_analytics"} */

    select distinct nspname from pg_namespace
  
[0m17:19:33.512603 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:19:33.521746 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.009 seconds
[0m17:19:33.524160 [debug] [ThreadPool]: On list_social_analytics: Close
[0m17:19:33.527085 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_social_analytics, now list_social_analytics_analytics_analytics)
[0m17:19:33.534025 [debug] [ThreadPool]: Using postgres connection "list_social_analytics_analytics_analytics"
[0m17:19:33.535154 [debug] [ThreadPool]: On list_social_analytics_analytics_analytics: BEGIN
[0m17:19:33.536058 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:19:33.542891 [debug] [ThreadPool]: SQL status: BEGIN in 0.007 seconds
[0m17:19:33.544144 [debug] [ThreadPool]: Using postgres connection "list_social_analytics_analytics_analytics"
[0m17:19:33.545092 [debug] [ThreadPool]: On list_social_analytics_analytics_analytics: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "connection_name": "list_social_analytics_analytics_analytics"} */
select
      'social_analytics' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'social_analytics' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'analytics_analytics'
    union all
    select
      'social_analytics' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'analytics_analytics'
  
[0m17:19:33.548645 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.002 seconds
[0m17:19:33.550923 [debug] [ThreadPool]: On list_social_analytics_analytics_analytics: ROLLBACK
[0m17:19:33.552173 [debug] [ThreadPool]: On list_social_analytics_analytics_analytics: Close
[0m17:19:33.559307 [debug] [MainThread]: Using postgres connection "master"
[0m17:19:33.560587 [debug] [MainThread]: On master: BEGIN
[0m17:19:33.561539 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:19:33.568496 [debug] [MainThread]: SQL status: BEGIN in 0.007 seconds
[0m17:19:33.569691 [debug] [MainThread]: Using postgres connection "master"
[0m17:19:33.570621 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m17:19:33.575495 [debug] [MainThread]: SQL status: SELECT 1 in 0.004 seconds
[0m17:19:33.577551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '41829da2-6e13-414d-b06b-9f26c83b1960', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff953f516d0>]}
[0m17:19:33.578628 [debug] [MainThread]: On master: ROLLBACK
[0m17:19:33.579664 [debug] [MainThread]: Using postgres connection "master"
[0m17:19:33.580649 [debug] [MainThread]: On master: BEGIN
[0m17:19:33.581794 [debug] [MainThread]: SQL status: BEGIN in 0.000 seconds
[0m17:19:33.582638 [debug] [MainThread]: On master: COMMIT
[0m17:19:33.583495 [debug] [MainThread]: Using postgres connection "master"
[0m17:19:33.584384 [debug] [MainThread]: On master: COMMIT
[0m17:19:33.585327 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:19:33.586154 [debug] [MainThread]: On master: Close
[0m17:19:33.591570 [debug] [Thread-1 (]: Began running node model.social_analytics.stg_posts
[0m17:19:33.593082 [info ] [Thread-1 (]: 1 of 4 START sql view model analytics_analytics.stg_posts ...................... [RUN]
[0m17:19:33.594524 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_social_analytics_analytics_analytics, now model.social_analytics.stg_posts)
[0m17:19:33.595520 [debug] [Thread-1 (]: Began compiling node model.social_analytics.stg_posts
[0m17:19:33.604282 [debug] [Thread-1 (]: Writing injected SQL for node "model.social_analytics.stg_posts"
[0m17:19:33.611133 [debug] [Thread-1 (]: Began executing node model.social_analytics.stg_posts
[0m17:19:33.644829 [debug] [Thread-1 (]: Writing runtime sql for node "model.social_analytics.stg_posts"
[0m17:19:33.653718 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.stg_posts"
[0m17:19:33.654745 [debug] [Thread-1 (]: On model.social_analytics.stg_posts: BEGIN
[0m17:19:33.655737 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:19:33.663992 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m17:19:33.665445 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.stg_posts"
[0m17:19:33.666577 [debug] [Thread-1 (]: On model.social_analytics.stg_posts: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.stg_posts"} */

  create view "social_analytics"."analytics_analytics"."stg_posts__dbt_tmp"
    
    
  as (
    

select
    id,
    platform,
    platform_post_id,
    author_name,
    content_text,
    content_url,
    coalesce(like_count, 0) as like_count,
    coalesce(comment_count, 0) as comment_count,
    coalesce(share_count, 0) as share_count,
    posted_at_utc,
    collected_at_utc
from public.posts
  );
[0m17:19:33.673623 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.006 seconds
[0m17:19:33.680515 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.stg_posts"
[0m17:19:33.681725 [debug] [Thread-1 (]: On model.social_analytics.stg_posts: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.stg_posts"} */
alter table "social_analytics"."analytics_analytics"."stg_posts" rename to "stg_posts__dbt_backup"
[0m17:19:33.683288 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.001 seconds
[0m17:19:33.687341 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.stg_posts"
[0m17:19:33.688412 [debug] [Thread-1 (]: On model.social_analytics.stg_posts: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.stg_posts"} */
alter table "social_analytics"."analytics_analytics"."stg_posts__dbt_tmp" rename to "stg_posts"
[0m17:19:33.689697 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:19:33.705581 [debug] [Thread-1 (]: On model.social_analytics.stg_posts: COMMIT
[0m17:19:33.707008 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.stg_posts"
[0m17:19:33.708237 [debug] [Thread-1 (]: On model.social_analytics.stg_posts: COMMIT
[0m17:19:33.711306 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m17:19:33.718463 [debug] [Thread-1 (]: Applying DROP to: "social_analytics"."analytics_analytics"."stg_posts__dbt_backup"
[0m17:19:33.724286 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.stg_posts"
[0m17:19:33.725370 [debug] [Thread-1 (]: On model.social_analytics.stg_posts: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.stg_posts"} */
drop view if exists "social_analytics"."analytics_analytics"."stg_posts__dbt_backup" cascade
[0m17:19:33.729153 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.003 seconds
[0m17:19:33.732490 [debug] [Thread-1 (]: On model.social_analytics.stg_posts: Close
[0m17:19:33.735423 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '41829da2-6e13-414d-b06b-9f26c83b1960', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff94ea30650>]}
[0m17:19:33.736831 [info ] [Thread-1 (]: 1 of 4 OK created sql view model analytics_analytics.stg_posts ................. [[32mCREATE VIEW[0m in 0.14s]
[0m17:19:33.738020 [debug] [Thread-1 (]: Finished running node model.social_analytics.stg_posts
[0m17:19:33.739830 [debug] [Thread-1 (]: Began running node model.social_analytics.fct_daily_metrics
[0m17:19:33.740976 [info ] [Thread-1 (]: 2 of 4 START sql table model analytics_analytics.fct_daily_metrics ............. [RUN]
[0m17:19:33.742033 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.social_analytics.stg_posts, now model.social_analytics.fct_daily_metrics)
[0m17:19:33.742987 [debug] [Thread-1 (]: Began compiling node model.social_analytics.fct_daily_metrics
[0m17:19:33.746889 [debug] [Thread-1 (]: Writing injected SQL for node "model.social_analytics.fct_daily_metrics"
[0m17:19:33.753935 [debug] [Thread-1 (]: Began executing node model.social_analytics.fct_daily_metrics
[0m17:19:33.775889 [debug] [Thread-1 (]: Writing runtime sql for node "model.social_analytics.fct_daily_metrics"
[0m17:19:33.783651 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.fct_daily_metrics"
[0m17:19:33.784701 [debug] [Thread-1 (]: On model.social_analytics.fct_daily_metrics: BEGIN
[0m17:19:33.785650 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:19:33.793839 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m17:19:33.795188 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.fct_daily_metrics"
[0m17:19:33.796437 [debug] [Thread-1 (]: On model.social_analytics.fct_daily_metrics: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.fct_daily_metrics"} */

  
    

  create  table "social_analytics"."analytics_analytics"."fct_daily_metrics__dbt_tmp"
  
  
    as
  
  (
    

select
    platform,
    date_trunc('day', posted_at_utc) as post_date,
    count(*) as total_posts,
    sum(like_count) as total_likes,
    sum(comment_count) as total_comments,
    sum(share_count) as total_shares,
    sum(like_count + comment_count + share_count) as engagement_score
from "social_analytics"."analytics_analytics"."stg_posts"
group by platform, date_trunc('day', posted_at_utc)
  );
  
[0m17:19:33.805259 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.008 seconds
[0m17:19:33.814664 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.fct_daily_metrics"
[0m17:19:33.815842 [debug] [Thread-1 (]: On model.social_analytics.fct_daily_metrics: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.fct_daily_metrics"} */
alter table "social_analytics"."analytics_analytics"."fct_daily_metrics" rename to "fct_daily_metrics__dbt_backup"
[0m17:19:33.817546 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:19:33.884602 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.fct_daily_metrics"
[0m17:19:33.886369 [debug] [Thread-1 (]: On model.social_analytics.fct_daily_metrics: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.fct_daily_metrics"} */
alter table "social_analytics"."analytics_analytics"."fct_daily_metrics__dbt_tmp" rename to "fct_daily_metrics"
[0m17:19:33.888293 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:19:33.890677 [debug] [Thread-1 (]: On model.social_analytics.fct_daily_metrics: COMMIT
[0m17:19:33.891753 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.fct_daily_metrics"
[0m17:19:33.892754 [debug] [Thread-1 (]: On model.social_analytics.fct_daily_metrics: COMMIT
[0m17:19:33.895977 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m17:19:33.899212 [debug] [Thread-1 (]: Applying DROP to: "social_analytics"."analytics_analytics"."fct_daily_metrics__dbt_backup"
[0m17:19:33.903259 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.fct_daily_metrics"
[0m17:19:33.904523 [debug] [Thread-1 (]: On model.social_analytics.fct_daily_metrics: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.fct_daily_metrics"} */
drop table if exists "social_analytics"."analytics_analytics"."fct_daily_metrics__dbt_backup" cascade
[0m17:19:33.908912 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m17:19:33.911455 [debug] [Thread-1 (]: On model.social_analytics.fct_daily_metrics: Close
[0m17:19:33.912759 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '41829da2-6e13-414d-b06b-9f26c83b1960', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff94d1104d0>]}
[0m17:19:33.914592 [info ] [Thread-1 (]: 2 of 4 OK created sql table model analytics_analytics.fct_daily_metrics ........ [[32mSELECT 8[0m in 0.17s]
[0m17:19:33.916246 [debug] [Thread-1 (]: Finished running node model.social_analytics.fct_daily_metrics
[0m17:19:33.917725 [debug] [Thread-1 (]: Began running node model.social_analytics.moving_avg
[0m17:19:33.918984 [info ] [Thread-1 (]: 3 of 4 START sql table model analytics_analytics.moving_avg .................... [RUN]
[0m17:19:33.920118 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.social_analytics.fct_daily_metrics, now model.social_analytics.moving_avg)
[0m17:19:33.921259 [debug] [Thread-1 (]: Began compiling node model.social_analytics.moving_avg
[0m17:19:33.925509 [debug] [Thread-1 (]: Writing injected SQL for node "model.social_analytics.moving_avg"
[0m17:19:33.933031 [debug] [Thread-1 (]: Began executing node model.social_analytics.moving_avg
[0m17:19:33.937929 [debug] [Thread-1 (]: Writing runtime sql for node "model.social_analytics.moving_avg"
[0m17:19:33.945542 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.moving_avg"
[0m17:19:33.946628 [debug] [Thread-1 (]: On model.social_analytics.moving_avg: BEGIN
[0m17:19:33.947604 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:19:33.955060 [debug] [Thread-1 (]: SQL status: BEGIN in 0.007 seconds
[0m17:19:33.956767 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.moving_avg"
[0m17:19:33.958049 [debug] [Thread-1 (]: On model.social_analytics.moving_avg: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.moving_avg"} */

  
    

  create  table "social_analytics"."analytics_analytics"."moving_avg__dbt_tmp"
  
  
    as
  
  (
    


with base as (
    select
        platform,
        date_trunc('day', posted_at_utc) as post_date,
        (like_count + comment_count + share_count) as engagement
    from "social_analytics"."analytics_analytics"."stg_posts"
),

daily as (
    select
        platform,
        post_date,
        sum(engagement) as daily_engagement
    from base
    group by platform, post_date
)

select
    platform,
    post_date,
    daily_engagement,
    avg(daily_engagement) over (
        partition by platform
        order by post_date
        rows between 6 preceding and current row
    ) as engagement_7d_moving_avg
from daily
order by platform, post_date
  );
  
[0m17:19:33.966450 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.007 seconds
[0m17:19:33.970941 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.moving_avg"
[0m17:19:33.972133 [debug] [Thread-1 (]: On model.social_analytics.moving_avg: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.moving_avg"} */
alter table "social_analytics"."analytics_analytics"."moving_avg" rename to "moving_avg__dbt_backup"
[0m17:19:33.973548 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:19:33.977236 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.moving_avg"
[0m17:19:33.978432 [debug] [Thread-1 (]: On model.social_analytics.moving_avg: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.moving_avg"} */
alter table "social_analytics"."analytics_analytics"."moving_avg__dbt_tmp" rename to "moving_avg"
[0m17:19:33.979882 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:19:33.981904 [debug] [Thread-1 (]: On model.social_analytics.moving_avg: COMMIT
[0m17:19:33.982841 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.moving_avg"
[0m17:19:33.984075 [debug] [Thread-1 (]: On model.social_analytics.moving_avg: COMMIT
[0m17:19:33.987457 [debug] [Thread-1 (]: SQL status: COMMIT in 0.002 seconds
[0m17:19:33.990853 [debug] [Thread-1 (]: Applying DROP to: "social_analytics"."analytics_analytics"."moving_avg__dbt_backup"
[0m17:19:33.992494 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.moving_avg"
[0m17:19:33.993712 [debug] [Thread-1 (]: On model.social_analytics.moving_avg: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.moving_avg"} */
drop table if exists "social_analytics"."analytics_analytics"."moving_avg__dbt_backup" cascade
[0m17:19:33.998488 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.004 seconds
[0m17:19:34.001162 [debug] [Thread-1 (]: On model.social_analytics.moving_avg: Close
[0m17:19:34.002618 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '41829da2-6e13-414d-b06b-9f26c83b1960', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff94ead7290>]}
[0m17:19:34.004612 [info ] [Thread-1 (]: 3 of 4 OK created sql table model analytics_analytics.moving_avg ............... [[32mSELECT 8[0m in 0.08s]
[0m17:19:34.006614 [debug] [Thread-1 (]: Finished running node model.social_analytics.moving_avg
[0m17:19:34.008043 [debug] [Thread-1 (]: Began running node model.social_analytics.top_posts
[0m17:19:34.009378 [info ] [Thread-1 (]: 4 of 4 START sql table model analytics_analytics.top_posts ..................... [RUN]
[0m17:19:34.010753 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.social_analytics.moving_avg, now model.social_analytics.top_posts)
[0m17:19:34.012086 [debug] [Thread-1 (]: Began compiling node model.social_analytics.top_posts
[0m17:19:34.016390 [debug] [Thread-1 (]: Writing injected SQL for node "model.social_analytics.top_posts"
[0m17:19:34.026253 [debug] [Thread-1 (]: Began executing node model.social_analytics.top_posts
[0m17:19:34.031366 [debug] [Thread-1 (]: Writing runtime sql for node "model.social_analytics.top_posts"
[0m17:19:34.041193 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.top_posts"
[0m17:19:34.042513 [debug] [Thread-1 (]: On model.social_analytics.top_posts: BEGIN
[0m17:19:34.043703 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:19:34.052234 [debug] [Thread-1 (]: SQL status: BEGIN in 0.008 seconds
[0m17:19:34.054062 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.top_posts"
[0m17:19:34.055376 [debug] [Thread-1 (]: On model.social_analytics.top_posts: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.top_posts"} */

  
    

  create  table "social_analytics"."analytics_analytics"."top_posts__dbt_tmp"
  
  
    as
  
  (
    

with ranked as (
    select
        id,
        platform,
        author_name,
        content_text,
        content_url,
        (like_count + comment_count + share_count) as engagement_score,
        row_number() over (order by (like_count + comment_count + share_count) desc) as overall_rank,
        row_number() over (partition by platform order by (like_count + comment_count + share_count) desc) as platform_rank
    from "social_analytics"."analytics_analytics"."stg_posts"
)
select *
from ranked
where overall_rank <= 5
   or platform_rank <= 3
  );
  
[0m17:19:34.064646 [debug] [Thread-1 (]: SQL status: SELECT 8 in 0.008 seconds
[0m17:19:34.069387 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.top_posts"
[0m17:19:34.070684 [debug] [Thread-1 (]: On model.social_analytics.top_posts: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.top_posts"} */
alter table "social_analytics"."analytics_analytics"."top_posts" rename to "top_posts__dbt_backup"
[0m17:19:34.072210 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:19:34.078579 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.top_posts"
[0m17:19:34.079984 [debug] [Thread-1 (]: On model.social_analytics.top_posts: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.top_posts"} */
alter table "social_analytics"."analytics_analytics"."top_posts__dbt_tmp" rename to "top_posts"
[0m17:19:34.081762 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.000 seconds
[0m17:19:34.084245 [debug] [Thread-1 (]: On model.social_analytics.top_posts: COMMIT
[0m17:19:34.085385 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.top_posts"
[0m17:19:34.086498 [debug] [Thread-1 (]: On model.social_analytics.top_posts: COMMIT
[0m17:19:34.090327 [debug] [Thread-1 (]: SQL status: COMMIT in 0.003 seconds
[0m17:19:34.095270 [debug] [Thread-1 (]: Applying DROP to: "social_analytics"."analytics_analytics"."top_posts__dbt_backup"
[0m17:19:34.097690 [debug] [Thread-1 (]: Using postgres connection "model.social_analytics.top_posts"
[0m17:19:34.098944 [debug] [Thread-1 (]: On model.social_analytics.top_posts: /* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "social_analytics", "target_name": "dev", "node_id": "model.social_analytics.top_posts"} */
drop table if exists "social_analytics"."analytics_analytics"."top_posts__dbt_backup" cascade
[0m17:19:34.103665 [debug] [Thread-1 (]: SQL status: DROP TABLE in 0.003 seconds
[0m17:19:34.106411 [debug] [Thread-1 (]: On model.social_analytics.top_posts: Close
[0m17:19:34.107978 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '41829da2-6e13-414d-b06b-9f26c83b1960', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff9543000d0>]}
[0m17:19:34.109879 [info ] [Thread-1 (]: 4 of 4 OK created sql table model analytics_analytics.top_posts ................ [[32mSELECT 8[0m in 0.10s]
[0m17:19:34.111448 [debug] [Thread-1 (]: Finished running node model.social_analytics.top_posts
[0m17:19:34.113868 [debug] [MainThread]: Using postgres connection "master"
[0m17:19:34.114842 [debug] [MainThread]: On master: BEGIN
[0m17:19:34.115933 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:19:34.123652 [debug] [MainThread]: SQL status: BEGIN in 0.008 seconds
[0m17:19:34.125245 [debug] [MainThread]: On master: COMMIT
[0m17:19:34.126477 [debug] [MainThread]: Using postgres connection "master"
[0m17:19:34.127474 [debug] [MainThread]: On master: COMMIT
[0m17:19:34.128697 [debug] [MainThread]: SQL status: COMMIT in 0.000 seconds
[0m17:19:34.129816 [debug] [MainThread]: On master: Close
[0m17:19:34.131277 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:19:34.132385 [debug] [MainThread]: Connection 'model.social_analytics.top_posts' was properly closed.
[0m17:19:34.133531 [info ] [MainThread]: 
[0m17:19:34.134701 [info ] [MainThread]: Finished running 3 table models, 1 view model in 0 hours 0 minutes and 0.74 seconds (0.74s).
[0m17:19:34.136609 [debug] [MainThread]: Command end result
[0m17:19:34.200153 [debug] [MainThread]: Wrote artifact WritableManifest to dbt_project/target/manifest.json
[0m17:19:34.210034 [debug] [MainThread]: Wrote artifact SemanticManifest to dbt_project/target/semantic_manifest.json
[0m17:19:34.224450 [debug] [MainThread]: Wrote artifact RunExecutionResult to dbt_project/target/run_results.json
[0m17:19:34.225653 [info ] [MainThread]: 
[0m17:19:34.227183 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:19:34.228908 [info ] [MainThread]: 
[0m17:19:34.230668 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=4
[0m17:19:34.233523 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.5511129, "process_in_blocks": "0", "process_kernel_time": 0.790134, "process_mem_max_rss": "124264", "process_out_blocks": "0", "process_user_time": 2.116781}
[0m17:19:34.235237 [debug] [MainThread]: Command `dbt run` succeeded at 17:19:34.235055 after 1.55 seconds
[0m17:19:34.236737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff952b31c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff95214e010>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff94ea31590>]}
[0m17:19:34.237990 [debug] [MainThread]: Flushing usage events
[0m17:19:35.097926 [debug] [MainThread]: An error was encountered while trying to flush usage events
